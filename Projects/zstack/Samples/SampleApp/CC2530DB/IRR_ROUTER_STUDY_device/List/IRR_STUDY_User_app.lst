###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         19/Dec/2014  16:36:38 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\Source\IRR_router\IRR_STUDY_Us #
#                          er_app.c                                           #
#    Command line       =  -f "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\z #
#                          stack\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC #
#                          2530DB\f8wRouter.cfg" (-DCPU32MHZ                  #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8       #
#                          -DMAC_CFG_RX_MAX=5 -DRTR_NWK) -f                   #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC253 #
#                          0DB\f8wConfig.cfg" (-DZIGBEEPRO -DSECURE=1         #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=60            #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=30           #
#                          -DNWK_MAX_BINDING_ENTRIES=10                       #
#                          -DMAX_BINDING_CLUSTER_IDS=4 -DASSERT_RESET         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=8000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=1000)  #
#                          -DREJOIN_POLL_RATE=440 "D:\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\Source #
#                          \IRR_router\IRR_STUDY_User_app.c" -D NV_INIT -D    #
#                          NV_RESTORE -D HOLD_AUTO_START -D MT_TASK -D        #
#                          MT_APP_FUNC -D MT_SYS_FUNC -D MT_ZDO_FUNC -D       #
#                          xMT_ZDO_MGMT -D ISR_KEYINTERRUPT -D xWDT_IN_PM1    #
#                          -D xOSC32K_CRYSTAL_INSTALLED=0 -D xPOWER_PA -D     #
#                          IRR_ROUTER -D M_V332 -D xHAVE_TEST_FUN -lC         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\IRR_ROUTER_STUDY_dev #
#                          ice\List\" -lA "D:\RE_1_2_0_FORMAL_APP(251)-14-12- #
#                          8\Projects\zstack\Samples\SampleApp\CC2530DB\IRR_R #
#                          OUTER_STUDY_device\List\" --diag_suppress          #
#                          Pe001,Pa010 -o "D:\RE_1_2_0_FORMAL_APP(251)-14-12- #
#                          8\Projects\zstack\Samples\SampleApp\CC2530DB\IRR_R #
#                          OUTER_STUDY_device\Obj\" -e --no_cse --no_unroll   #
#                          --no_inline --no_code_motion --no_tbaa --debug     #
#                          --core=plain --dptr=16,1 --data_model=large        #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I "D:\RE_1_2_0_FORMAL_APP(25 #
#                          1)-14-12-8\Projects\zstack\Samples\SampleApp\CC253 #
#                          0DB\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\Source\" #
#                           -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\ #
#                          zstack\Samples\SampleApp\CC2530DB\..\Source\rssi_t #
#                          est\h\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Pr #
#                          ojects\zstack\Samples\SampleApp\CC2530DB\..\Source #
#                          \IRR_router\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-1 #
#                          2-8\Projects\zstack\Samples\SampleApp\CC2530DB\..\ #
#                          ..\..\ZMain\TI2530DB\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\hal\include\" -I "D:\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\hal\target\CC2530EB\" #
#                           -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\ #
#                          zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\C #
#                          omponents\mac\include\" -I                         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\high_level\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\low_level\srf04\" -I                     #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\low_level\srf04\single_chip\" -I         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mt\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8 #
#                          \Projects\zstack\Samples\SampleApp\CC2530DB\..\..\ #
#                          ..\..\..\Components\osal\include\" -I              #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\services\saddr\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\services\sdata\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\af\" -I "D:\RE_1_2_0_FORMAL_APP(251)-1 #
#                          4-12-8\Projects\zstack\Samples\SampleApp\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\nwk\" -I           #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\sapi\" -I "D:\RE_1_2_0_FORMAL_APP(251) #
#                          -14-12-8\Projects\zstack\Samples\SampleApp\CC2530D #
#                          B\..\..\..\..\..\Components\stack\sec\" -I         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\sys\" -I "D:\RE_1_2_0_FORMAL_APP(251)- #
#                          14-12-8\Projects\zstack\Samples\SampleApp\CC2530DB #
#                          \..\..\..\..\..\Components\stack\zdo\" -I          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\zmac\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12 #
#                          -8\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\Components\zmac\f8w\" -On               #
#                          --require_prototypes                               #
#    List file          =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\CC2530DB\IRR_ROUTER_STUDY_devi #
#                          ce\List\IRR_STUDY_User_app.lst                     #
#    Object file        =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\CC2530DB\IRR_ROUTER_STUDY_devi #
#                          ce\Obj\IRR_STUDY_User_app.r51                      #
#                                                                             #
#                                                                             #
###############################################################################

D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstack\Samples\SampleApp\Source\IRR_router\IRR_STUDY_User_app.c
      1          /**************************************************************************************************
      2            Filename:       SampleApp.c
      3            Revised:        $Date: 2007-10-27 17:16:54 -0700 (Sat, 27 Oct 2007) $
      4            Revision:       $Revision: 15793 $
      5          
      6            Description:    Sample Application (no Profile).
      7          
      8          
      9            Copyright 2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41            This application isn't intended to do anything useful, it is
     42            intended to be a simple example of an application's structure.
     43          
     44            This application sends it's messages either as broadcast or
     45            broadcast filtered group messages.  The other (more normal)
     46            message addressing is unicast.  Most of the other sample
     47            applications are written to support the unicast message model.
     48          
     49            Key control:
     50              SW1:  Sends a flash command to all devices in Group 1.
     51              SW2:  Adds/Removes (toggles) this device in and out
     52                    of Group 1.  This will enable and disable the
     53                    reception of the flash command.
     54          *********************************************************************/
     55          
     56          /*********************************************************************
     57           * INCLUDES
     58           */
     59          
     60          
     61          
     62          
     63          #include "OSAL.h"
     64          #include "ZGlobals.h"
     65          #include "AF.h"
     66          #include "aps_groups.h"
     67          #include "ZDApp.h"
     68          #include "device.h"
     69          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     70          #include "MT_UART.h"
     71          #include "mac_rx.h"
     72          
     73          /* HAL */
     74          #include "hal_led.h"
     75          #include "hal_key.h"
     76          #include "OSAL_Nv.h"
     77          
     78          #include "AddrMgr.h"
     79          #include "nwk_util.h"
     80          #include "ZDObject.h"
     81          #include "ZDO_LIB.h"
     82          #include "common_device.h"
     83          #include "IO_config.h"
     84             
     85          
     86          #if defined(IRR_ROUTER)
     87          #include "IRR.h"
     88          #include "m25p16.h"
     89          
     90          #endif
     91             

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     92          uint8 UserApp_TaskID;
   \                     UserApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     93          uint8 RS_LEN=0;
   \                     RS_LEN:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     94          uint8 RS_STR[10];
   \                     RS_STR:
   \   000000                DS 10
   \   00000A                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     95          uint8 SHORT_ADRESS[4];
   \                     SHORT_ADRESS:
   \   000000                DS 4
   \   000004                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     96          uint8 USER_DATA_LEN=0;
   \                     USER_DATA_LEN:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     97          uint8 USER_DATA_TYPE=0;
   \                     USER_DATA_TYPE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     98          uint8 *USER_DATA_STR;
   \                     USER_DATA_STR:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     99          uint8 DEVICE_ID;
   \                     DEVICE_ID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    100          uint8 DEFINED_CONTROL_CHAR;
   \                     DEFINED_CONTROL_CHAR:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    101          uint8 JOIN_ROLE;
   \                     JOIN_ROLE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    102          
    103          #define BINDINGLIST       1

   \                                 In  segment XDATA_I, align 1, keep-with-next
    104          uint16 bindingINClusters1[BINDINGLIST] =
   \                     bindingINClusters1:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for bindingINClusters1>`
   \   000002                REQUIRE __INIT_XDATA_I
    105          {
    106            SAMPLEAPP_ONOFF_CLUSTERID,
    107          };  
    108          

   \                                 In  segment XDATA_ROM_C, align 1
    109          const cId_t SampleApp_ClusterList1[1] =
   \                     SampleApp_ClusterList1:
   \   000000   0100         DW 1
    110          {
    111            SAMPLEAPP_ONOFF_CLUSTERID //周期信息簇ID=1
    112          };
    113          
    114          
    115          

   \                                 In  segment XDATA_I, align 1, keep-with-next
    116           SimpleDescriptionFormat_t SampleApp_SimpleDesc1 =
   \                     SampleApp_SimpleDesc1:
   \   000000                DS 12
   \   00000C                REQUIRE `?<Initializer for SampleApp_SimpleDesc1>`
   \   00000C                REQUIRE __INIT_XDATA_I
    117          {
    118            SAMPLEAPP_ENDPOINT1,              //  int Endpoint;
    119            SAMPLEAPP_PROFID,                //  uint16 AppProfId[2];
    120            SAMPLEAPP_DEVICEID,              //  uint16 AppDeviceId[2];
    121            SAMPLEAPP_DEVICE_VERSION,        //  int   AppDevVer:4;
    122            SAMPLEAPP_FLAGS,                 //  int   AppFlags:4;
    123            1,          //  uint8  AppNumInClusters;
    124            (cId_t *)SampleApp_ClusterList1,  //  uint8 *pAppInClusterList;
    125            1,          //  uint8  AppNumInClusters;
    126            (cId_t *)SampleApp_ClusterList1   //  uint8 *pAppInClusterList;
    127          };
    128          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    129          endPointDesc_t SampleApp_epDesc1;
   \                     SampleApp_epDesc1:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z
    130          
    131          
    132          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    133              	uint8 CmdType;  //命令类型： '1' 学习，'2' 使用
   \                     CmdType:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    134          	uint16 IRCodeIndex;   //
   \                     IRCodeIndex:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    135          
    136          uint8 USER_APP_COMMAND(uint8 *user_app_data,uint8 *str); 
    137          void USER_APP_JOIN_MSG(void);
    138          void SampleApp_ProcessBINDINGMessage(afIncomingMSGPacket_t *pkt);
    139          
    140          void User_APP_Drive_init(void);
    141          void SampleApp_HandleKeys( uint8 shift, uint8 keys );//本用户应用按键函数
    142          void USER_SET_RS_MSG(void);//设置RS数据
    143          
    144          void USER_AFTER_RS_MSG(void);
    145          
    146          void USER_ZDO_JOINING_MSG(void); //ZDO层入网的时候处理函数 就是闪烁灯
    147          uint8 READ_NETKEY(void); //读取入网状态按键的状态传递到应用层
    148          void LED_CHANGE(uint8 Position,uint8 Mode);// 设置LED函数
    149          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    150          void UserApp_Init( uint8 task_id )
   \                     UserApp_Init:
    151          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    152          
    153            UserApp_TaskID = task_id;
   \   000007   EE           MOV     A,R6
   \   000008   90....       MOV     DPTR,#UserApp_TaskID
   \   00000B   F0           MOVX    @DPTR,A
    154          
    155            RegisterForKeys(task_id);
   \   00000C                ; Setup parameters for call to function RegisterForKeys
   \   00000C   EE           MOV     A,R6
   \   00000D   F9           MOV     R1,A
   \   00000E   12....       LCALL   ??RegisterForKeys?relay
   \   000011   E9           MOV     A,R1
    156            
    157            User_APP_Drive_init();
   \   000012                ; Setup parameters for call to function User_APP_Drive_init
   \   000012   12....       LCALL   ??User_APP_Drive_init?relay
    158          
    159          }
   \   000015   7F01         MOV     R7,#0x1
   \   000017   02....       LJMP    ?BANKED_LEAVE_XDATA
    160          
    161          /*********************************************************************
    162           * @fn      SampleApp_ProcessEvent
    163           *
    164           * @brief   Generic Application Task event processor.  This function
    165           *          is called to process all events for the task.  Events
    166           *          include timers, messages and any other user defined events.
    167           *
    168           * @param   task_id  - The OSAL assigned task ID.
    169           * @param   events - events to process.  This is a bit map and can
    170           *                   contain more than one event.
    171           *
    172           * @return  none
    173           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    174          uint16 UserApp_ProcessEvent( uint8 task_id, uint16 events )
   \                     UserApp_ProcessEvent:
    175          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 2,R1
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
   \   000009   EB           MOV     A,R3
   \   00000A   FF           MOV     R7,A
    176            afIncomingMSGPacket_t *MSGpkt;
    177           
    178            if ( events & SYS_EVENT_MSG )
   \   00000B   EE           MOV     A,R6
   \   00000C   5400         ANL     A,#0x0
   \   00000E   F8           MOV     R0,A
   \   00000F   EF           MOV     A,R7
   \   000010   5480         ANL     A,#0x80
   \   000012   F9           MOV     R1,A
   \   000013   E8           MOV     A,R0
   \   000014   49           ORL     A,R1
   \   000015   6061         JZ      ??UserApp_ProcessEvent_0
    179            {
    180              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( UserApp_TaskID );
   \   000017                ; Setup parameters for call to function osal_msg_receive
   \   000017   90....       MOV     DPTR,#UserApp_TaskID
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   F9           MOV     R1,A
   \   00001C   12....       LCALL   ??osal_msg_receive?relay
   \   00001F   8A..         MOV     ?V0 + 4,R2
   \   000021   8B..         MOV     ?V0 + 5,R3
   \   000023   85....       MOV     ?V0 + 0,?V0 + 4
   \   000026   85....       MOV     ?V0 + 1,?V0 + 5
    181              while ( MSGpkt )                                           
   \                     ??UserApp_ProcessEvent_1:
   \   000029   E5..         MOV     A,?V0 + 0
   \   00002B   45..         ORL     A,?V0 + 1
   \   00002D   603F         JZ      ??UserApp_ProcessEvent_2
    182              {                                                                     
    183                switch ( MSGpkt->hdr.event )
   \   00002F   85..82       MOV     DPL,?V0 + 0
   \   000032   85..83       MOV     DPH,?V0 + 1
   \   000035   E0           MOVX    A,@DPTR
   \   000036   64C0         XRL     A,#0xc0
   \   000038   7018         JNZ     ??UserApp_ProcessEvent_3
    184                {
    185                  case KEY_CHANGE:      
    186                    SampleApp_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
   \   00003A                ; Setup parameters for call to function SampleApp_HandleKeys
   \   00003A   85..82       MOV     DPL,?V0 + 0
   \   00003D   85..83       MOV     DPH,?V0 + 1
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   E0           MOVX    A,@DPTR
   \   000044   FA           MOV     R2,A
   \   000045   85..82       MOV     DPL,?V0 + 0
   \   000048   85..83       MOV     DPH,?V0 + 1
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   F9           MOV     R1,A
   \   00004F   12....       LCALL   ??SampleApp_HandleKeys?relay
    187                    break;                                             
    188          
    189                  default:
    190                    break;
    191                }
    192          
    193                // Release the memory
    194                //释放消息占用的内存
    195                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??UserApp_ProcessEvent_3:
   \   000052                ; Setup parameters for call to function osal_msg_deallocate
   \   000052   AA..         MOV     R2,?V0 + 0
   \   000054   AB..         MOV     R3,?V0 + 1
   \   000056   12....       LCALL   ??osal_msg_deallocate?relay
   \   000059   E9           MOV     A,R1
    196          
    197                // Next - if one is available
    198                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( UserApp_TaskID );
   \   00005A                ; Setup parameters for call to function osal_msg_receive
   \   00005A   90....       MOV     DPTR,#UserApp_TaskID
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F9           MOV     R1,A
   \   00005F   12....       LCALL   ??osal_msg_receive?relay
   \   000062   8A..         MOV     ?V0 + 4,R2
   \   000064   8B..         MOV     ?V0 + 5,R3
   \   000066   85....       MOV     ?V0 + 0,?V0 + 4
   \   000069   85....       MOV     ?V0 + 1,?V0 + 5
   \   00006C   80BB         SJMP    ??UserApp_ProcessEvent_1
    199              }//end： while ( MSGpkt )
    200          
    201              return (events ^ SYS_EVENT_MSG);
   \                     ??UserApp_ProcessEvent_2:
   \   00006E   EE           MOV     A,R6
   \   00006F   6400         XRL     A,#0x0
   \   000071   FA           MOV     R2,A
   \   000072   EF           MOV     A,R7
   \   000073   6480         XRL     A,#0x80
   \   000075   FB           MOV     R3,A
   \   000076   802E         SJMP    ??UserApp_ProcessEvent_4
    202            }
    203            
    204            
    205           //用户自行添加事件
    206           //test
    207            if ( events & USER_TEST_EVT )
   \                     ??UserApp_ProcessEvent_0:
   \   000078   EE           MOV     A,R6
   \   000079   A2E0         MOV     C,0xE0 /* A   */.0
   \   00007B   5025         JNC     ??UserApp_ProcessEvent_5
    208            {
    209              HAL_TOGGLE_LED1();
   \   00007D   A290         MOV     C,0x90.0
   \   00007F   5004         JNC     ??UserApp_ProcessEvent_6
   \   000081   C290         CLR     0x90.0
   \   000083   8002         SJMP    ??UserApp_ProcessEvent_7
   \                     ??UserApp_ProcessEvent_6:
   \   000085   D290         SETB    0x90.0
    210                osal_start_timerEx( UserApp_TaskID, USER_TEST_EVT,10000);
   \                     ??UserApp_ProcessEvent_7:
   \   000087                ; Setup parameters for call to function osal_start_timerEx
   \   000087   7C10         MOV     R4,#0x10
   \   000089   7D27         MOV     R5,#0x27
   \   00008B   7A01         MOV     R2,#0x1
   \   00008D   7B00         MOV     R3,#0x0
   \   00008F   90....       MOV     DPTR,#UserApp_TaskID
   \   000092   E0           MOVX    A,@DPTR
   \   000093   F9           MOV     R1,A
   \   000094   12....       LCALL   ??osal_start_timerEx?relay
   \   000097   E9           MOV     A,R1
    211              
    212               return (events ^ USER_TEST_EVT );
   \   000098   EE           MOV     A,R6
   \   000099   6401         XRL     A,#0x1
   \   00009B   FA           MOV     R2,A
   \   00009C   EF           MOV     A,R7
   \   00009D   6400         XRL     A,#0x0
   \   00009F   FB           MOV     R3,A
   \   0000A0   8004         SJMP    ??UserApp_ProcessEvent_4
    213            } 
    214           
    215            return 0;
   \                     ??UserApp_ProcessEvent_5:
   \   0000A2   7A00         MOV     R2,#0x0
   \   0000A4   7B00         MOV     R3,#0x0
   \                     ??UserApp_ProcessEvent_4:
   \   0000A6   7F06         MOV     R7,#0x6
   \   0000A8   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   0000AB                REQUIRE _A_P1
    216          }
    217          
    218          
    219          
    220          // 按键命令传输到USER层，用户自行添加删除

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    221          void SampleApp_HandleKeys( uint8 shift, uint8 keys )
   \                     SampleApp_HandleKeys:
    222          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   \   000008   FF           MOV     R7,A
    223            uint8 startOptions;
                         ^
Warning[Pe177]: variable "startOptions" was declared but never referenced
    224           // uint8 logicalType;
    225            zAddrType_t dstAddr;
                               ^
Warning[Pe177]: variable "dstAddr" was declared but never referenced
    226            
    227            
    228                 //P1.3  
    229             if ( keys &  HAL_KEY_SW_9 )
   \   000009   EF           MOV     A,R7
   \   00000A   A2E6         MOV     C,0xE0 /* A   */.6
   \   00000C   4070         JC      ??SampleApp_HandleKeys_0
    230            { 
    231          
    232                
    233              
    234            }
    235            
    236          
    237            else if ( keys &  HAL_KEY_SW_8 )
   \   00000E   EF           MOV     A,R7
   \   00000F   A2E7         MOV     C,0xE0 /* A   */.7
   \   000011   506B         JNC     ??SampleApp_HandleKeys_0
    238            {   
    239              
    240              
    241              if(key_double_flag==4)
   \   000013   90....       MOV     DPTR,#key_double_flag
   \   000016   E0           MOVX    A,@DPTR
   \   000017   6404         XRL     A,#0x4
   \   000019   7005         JNZ     ??SampleApp_HandleKeys_1
    242              {
    243                   APPLY_TO_JOIN_OF_KEY();
   \   00001B                ; Setup parameters for call to function APPLY_TO_JOIN_OF_KEY
   \   00001B   12....       LCALL   ??APPLY_TO_JOIN_OF_KEY?relay
   \   00001E   8035         SJMP    ??SampleApp_HandleKeys_2
    244              }
    245              
    246             else if( (key_double_flag == 3)&&(P1_7 == 0) )
   \                     ??SampleApp_HandleKeys_1:
   \   000020   90....       MOV     DPTR,#key_double_flag
   \   000023   E0           MOVX    A,@DPTR
   \   000024   6403         XRL     A,#0x3
   \   000026   7011         JNZ     ??SampleApp_HandleKeys_3
   \   000028   A297         MOV     C,0x90.7
   \   00002A   400D         JC      ??SampleApp_HandleKeys_3
    247             {
    248               SampleApp_send_in_binding_req(SAMPLEAPP_ENDPOINT,bindingINClusters1,1);
   \   00002C                ; Setup parameters for call to function SampleApp_send_in_binding_req
   \   00002C   7C01         MOV     R4,#0x1
   \   00002E   7A..         MOV     R2,#bindingINClusters1 & 0xff
   \   000030   7B..         MOV     R3,#(bindingINClusters1 >> 8) & 0xff
   \   000032   7914         MOV     R1,#0x14
   \   000034   12....       LCALL   ??SampleApp_send_in_binding_req?relay
   \   000037   801C         SJMP    ??SampleApp_HandleKeys_2
    249             }
    250             
    251             else if(key_double_flag==6)
   \                     ??SampleApp_HandleKeys_3:
   \   000039   90....       MOV     DPTR,#key_double_flag
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   6406         XRL     A,#0x6
   \   00003F   7007         JNZ     ??SampleApp_HandleKeys_4
    252              {
    253                  SampleApp_PermitJoin(240);
   \   000041                ; Setup parameters for call to function SampleApp_PermitJoin
   \   000041   79F0         MOV     R1,#-0x10
   \   000043   12....       LCALL   ??SampleApp_PermitJoin?relay
   \   000046   800D         SJMP    ??SampleApp_HandleKeys_2
    254              }
    255          
    256              else if(key_double_flag==8)
   \                     ??SampleApp_HandleKeys_4:
   \   000048   90....       MOV     DPTR,#key_double_flag
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   6408         XRL     A,#0x8
   \   00004E   7005         JNZ     ??SampleApp_HandleKeys_2
    257              {
    258                  SampleApp_PermitJoin(0);
   \   000050                ; Setup parameters for call to function SampleApp_PermitJoin
   \   000050   7900         MOV     R1,#0x0
   \   000052   12....       LCALL   ??SampleApp_PermitJoin?relay
    259              }
    260              
    261             
    262          
    263               if(key_hold_flag==1) 
   \                     ??SampleApp_HandleKeys_2:
   \   000055   90....       MOV     DPTR,#key_hold_flag
   \   000058   E0           MOVX    A,@DPTR
   \   000059   6401         XRL     A,#0x1
   \   00005B   7021         JNZ     ??SampleApp_HandleKeys_0
    264              {   
    265                HalLedBlink ( HAL_LED_1, 4, 50, 600 );
   \   00005D                ; Setup parameters for call to function HalLedBlink
   \   00005D   7C58         MOV     R4,#0x58
   \   00005F   7D02         MOV     R5,#0x2
   \   000061   7B32         MOV     R3,#0x32
   \   000063   7A04         MOV     R2,#0x4
   \   000065   7901         MOV     R1,#0x1
   \   000067   12....       LCALL   ??HalLedBlink?relay
    266                RESTORE_TO_FACTORY();
   \   00006A                ; Setup parameters for call to function RESTORE_TO_FACTORY
   \   00006A   12....       LCALL   ??RESTORE_TO_FACTORY?relay
    267               osal_start_timerEx( SampleApp_TaskID,SAMPLEAPP_RESTORE_EVT,5000 );
   \   00006D                ; Setup parameters for call to function osal_start_timerEx
   \   00006D   7C88         MOV     R4,#-0x78
   \   00006F   7D13         MOV     R5,#0x13
   \   000071   7A10         MOV     R2,#0x10
   \   000073   7B00         MOV     R3,#0x0
   \   000075   90....       MOV     DPTR,#SampleApp_TaskID
   \   000078   E0           MOVX    A,@DPTR
   \   000079   F9           MOV     R1,A
   \   00007A   12....       LCALL   ??osal_start_timerEx?relay
   \   00007D   E9           MOV     A,R1
    268               }
    269            
    270            }
    271           
    272          }
   \                     ??SampleApp_HandleKeys_0:
   \   00007E   7F01         MOV     R7,#0x1
   \   000080   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000083                REQUIRE _A_P1
    273          
    274          
    275          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    276          void SampleApp_ProcessBINDINGMessage(afIncomingMSGPacket_t *pkt)
   \                     SampleApp_ProcessBINDINGMessage:
    277          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    278          
    279             if (pkt->clusterId == SAMPLEAPP_ONOFF_CLUSTERID )
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   6401         XRL     A,#0x1
   \   000014   7004         JNZ     ??SampleApp_ProcessBINDINGMessage_0
   \   000016   A3           INC     DPTR
   \   000017   E0           MOVX    A,@DPTR
   \   000018   6400         XRL     A,#0x0
   \                     ??SampleApp_ProcessBINDINGMessage_0:
   \   00001A   7035         JNZ     ??SampleApp_ProcessBINDINGMessage_1
    280            {
    281              if(pkt->cmd.Data[0]==1)
   \   00001C   EE           MOV     A,R6
   \   00001D   2422         ADD     A,#0x22
   \   00001F   F582         MOV     DPL,A
   \   000021   EF           MOV     A,R7
   \   000022   3400         ADDC    A,#0x0
   \   000024   F583         MOV     DPH,A
   \   000026   E0           MOVX    A,@DPTR
   \   000027   F8           MOV     R0,A
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   F583         MOV     DPH,A
   \   00002C   8882         MOV     DPL,R0
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   6401         XRL     A,#0x1
   \   000031   7004         JNZ     ??SampleApp_ProcessBINDINGMessage_2
    282             {
    283               //IO_CTLA_SBIT =1 ; 
    284               HAL_TURN_ON_LED2();
   \   000033   C291         CLR     0x90.1
   \   000035   8017         SJMP    ??SampleApp_ProcessBINDINGMessage_3
    285               
    286             }
    287             else if(pkt->cmd.Data[0]==0)
   \                     ??SampleApp_ProcessBINDINGMessage_2:
   \   000037   EE           MOV     A,R6
   \   000038   2422         ADD     A,#0x22
   \   00003A   F582         MOV     DPL,A
   \   00003C   EF           MOV     A,R7
   \   00003D   3400         ADDC    A,#0x0
   \   00003F   F583         MOV     DPH,A
   \   000041   E0           MOVX    A,@DPTR
   \   000042   F8           MOV     R0,A
   \   000043   A3           INC     DPTR
   \   000044   E0           MOVX    A,@DPTR
   \   000045   F583         MOV     DPH,A
   \   000047   8882         MOV     DPL,R0
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   7002         JNZ     ??SampleApp_ProcessBINDINGMessage_3
    288             {
    289               //IO_CTLA_SBIT =0;
    290               HAL_TURN_OFF_LED2();
   \   00004C   D291         SETB    0x90.1
    291             } 
    292             
    293                else if(pkt->cmd.Data[0]==2)
    294             {
    295               //LED2_SBIT = IO_CTLA_SBIT;
    296               //IO_CTLA_SBIT =!IO_CTLA_SBIT;
    297             }  
    298             
    299              SampleApp_SendInMessage();
   \                     ??SampleApp_ProcessBINDINGMessage_3:
   \   00004E                ; Setup parameters for call to function SampleApp_SendInMessage
   \   00004E   12....       LCALL   ??SampleApp_SendInMessage?relay
    300            }
    301            
    302          }
   \                     ??SampleApp_ProcessBINDINGMessage_1:
   \   000051   7F01         MOV     R7,#0x1
   \   000053   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000056                REQUIRE _A_P1
    303          
    304          
    305          // 入网后添加函数

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    306          void USER_APP_JOIN_MSG(void)
   \                     USER_APP_JOIN_MSG:
    307          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    308            HalLedBlink ( HAL_LED_1, 1, 99, 2500 );//用BLINK模拟灯亮两秒后熄灭  
   \   000005                ; Setup parameters for call to function HalLedBlink
   \   000005   7CC4         MOV     R4,#-0x3c
   \   000007   7D09         MOV     R5,#0x9
   \   000009   7B63         MOV     R3,#0x63
   \   00000B   7A01         MOV     R2,#0x1
   \   00000D   7901         MOV     R1,#0x1
   \   00000F   12....       LCALL   ??HalLedBlink?relay
    309            
    310              uint8 *Sample_Cmd_shorAddr;
    311            Sample_Cmd_shorAddr=SampleApp_GetShortAddr();
   \   000012                ; Setup parameters for call to function SampleApp_GetShortAddr
   \   000012   12....       LCALL   ??SampleApp_GetShortAddr?relay
   \   000015   8A..         MOV     ?V0 + 0,R2
   \   000017   8B..         MOV     ?V0 + 1,R3
   \   000019   AE..         MOV     R6,?V0 + 0
   \   00001B   AF..         MOV     R7,?V0 + 1
    312            SHORT_ADRESS[0]=*Sample_Cmd_shorAddr++;
   \   00001D   8E82         MOV     DPL,R6
   \   00001F   8F83         MOV     DPH,R7
   \   000021   E0           MOVX    A,@DPTR
   \   000022   90....       MOV     DPTR,#SHORT_ADRESS
   \   000025   F0           MOVX    @DPTR,A
   \   000026   8E82         MOV     DPL,R6
   \   000028   8F83         MOV     DPH,R7
   \   00002A   A3           INC     DPTR
   \   00002B   AE82         MOV     R6,DPL
   \   00002D   AF83         MOV     R7,DPH
    313            SHORT_ADRESS[1]=*Sample_Cmd_shorAddr++;
   \   00002F   8E82         MOV     DPL,R6
   \   000031   8F83         MOV     DPH,R7
   \   000033   E0           MOVX    A,@DPTR
   \   000034   90....       MOV     DPTR,#SHORT_ADRESS + 1
   \   000037   F0           MOVX    @DPTR,A
   \   000038   8E82         MOV     DPL,R6
   \   00003A   8F83         MOV     DPH,R7
   \   00003C   A3           INC     DPTR
   \   00003D   AE82         MOV     R6,DPL
   \   00003F   AF83         MOV     R7,DPH
    314            SHORT_ADRESS[2]=*Sample_Cmd_shorAddr++;
   \   000041   8E82         MOV     DPL,R6
   \   000043   8F83         MOV     DPH,R7
   \   000045   E0           MOVX    A,@DPTR
   \   000046   90....       MOV     DPTR,#SHORT_ADRESS + 2
   \   000049   F0           MOVX    @DPTR,A
   \   00004A   8E82         MOV     DPL,R6
   \   00004C   8F83         MOV     DPH,R7
   \   00004E   A3           INC     DPTR
   \   00004F   AE82         MOV     R6,DPL
   \   000051   AF83         MOV     R7,DPH
    315            SHORT_ADRESS[3]=*Sample_Cmd_shorAddr;
   \   000053   8E82         MOV     DPL,R6
   \   000055   8F83         MOV     DPH,R7
   \   000057   E0           MOVX    A,@DPTR
   \   000058   90....       MOV     DPTR,#SHORT_ADRESS + 3
   \   00005B   F0           MOVX    @DPTR,A
    316            osal_mem_free( shortddr_mem );
   \   00005C                ; Setup parameters for call to function osal_mem_free
   \   00005C   90....       MOV     DPTR,#shortddr_mem
   \   00005F   E0           MOVX    A,@DPTR
   \   000060   FA           MOV     R2,A
   \   000061   A3           INC     DPTR
   \   000062   E0           MOVX    A,@DPTR
   \   000063   FB           MOV     R3,A
   \   000064   12....       LCALL   ??osal_mem_free?relay
    317            // USER自行添加入网后的操作代码
    318           
    319          }
   \   000067   7F02         MOV     R7,#0x2
   \   000069   02....       LJMP    ?BANKED_LEAVE_XDATA
    320          
    321          
    322          // 收到命令后添加函数
    323          // user_app_data 上位机发过来的有效数据 字母后面开始
    324          //user_rf_data 需要填入的返回数据数组

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    325          uint8 USER_APP_COMMAND(uint8 *user_app_data,uint8 *str)
   \                     USER_APP_COMMAND:
    326          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   8C..         MOV     ?V0 + 0,R4
   \   00000B   8D..         MOV     ?V0 + 1,R5
    327            uint8 active_len=0;
   \   00000D   75..00       MOV     ?V0 + 2,#0x0
    328            
    329              str[0] = '/';
   \   000010   85..82       MOV     DPL,?V0 + 0
   \   000013   85..83       MOV     DPH,?V0 + 1
   \   000016   742F         MOV     A,#0x2f
   \   000018   F0           MOVX    @DPTR,A
    330          
    331             CmdType = user_app_data[0];//窗帘设备命令类型 学习 使用
   \   000019   8E82         MOV     DPL,R6
   \   00001B   8F83         MOV     DPH,R7
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   90....       MOV     DPTR,#CmdType
   \   000021   F0           MOVX    @DPTR,A
    332             IRCodeIndex = (user_app_data[1]- '0')*100 +
    333                           (user_app_data[2]- '0')*10 +
    334                           (user_app_data[3]- '0');      //编码序号
   \   000022   8E82         MOV     DPL,R6
   \   000024   8F83         MOV     DPH,R7
   \   000026   A3           INC     DPTR
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F8           MOV     R0,A
   \   000029   7900         MOV     R1,#0x0
   \   00002B   E8           MOV     A,R0
   \   00002C   75F064       MOV     B,#0x64
   \   00002F   A4           MUL     AB
   \   000030   C8           XCH     A,R0
   \   000031   AAF0         MOV     R2,B
   \   000033   75F000       MOV     B,#0x0
   \   000036   A4           MUL     AB
   \   000037   2A           ADD     A,R2
   \   000038   FA           MOV     R2,A
   \   000039   75F064       MOV     B,#0x64
   \   00003C   E9           MOV     A,R1
   \   00003D   A4           MUL     AB
   \   00003E   2A           ADD     A,R2
   \   00003F   F9           MOV     R1,A
   \   000040   8E82         MOV     DPL,R6
   \   000042   8F83         MOV     DPH,R7
   \   000044   A3           INC     DPTR
   \   000045   A3           INC     DPTR
   \   000046   E0           MOVX    A,@DPTR
   \   000047   FA           MOV     R2,A
   \   000048   7B00         MOV     R3,#0x0
   \   00004A   EA           MOV     A,R2
   \   00004B   75F00A       MOV     B,#0xa
   \   00004E   A4           MUL     AB
   \   00004F   CA           XCH     A,R2
   \   000050   ACF0         MOV     R4,B
   \   000052   75F000       MOV     B,#0x0
   \   000055   A4           MUL     AB
   \   000056   2C           ADD     A,R4
   \   000057   FC           MOV     R4,A
   \   000058   75F00A       MOV     B,#0xa
   \   00005B   EB           MOV     A,R3
   \   00005C   A4           MUL     AB
   \   00005D   2C           ADD     A,R4
   \   00005E   FB           MOV     R3,A
   \   00005F   E8           MOV     A,R0
   \   000060   2A           ADD     A,R2
   \   000061   F8           MOV     R0,A
   \   000062   E9           MOV     A,R1
   \   000063   3B           ADDC    A,R3
   \   000064   F9           MOV     R1,A
   \   000065   8E82         MOV     DPL,R6
   \   000067   8F83         MOV     DPH,R7
   \   000069   A3           INC     DPTR
   \   00006A   A3           INC     DPTR
   \   00006B   A3           INC     DPTR
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   FA           MOV     R2,A
   \   00006E   7B00         MOV     R3,#0x0
   \   000070   E8           MOV     A,R0
   \   000071   2A           ADD     A,R2
   \   000072   F8           MOV     R0,A
   \   000073   E9           MOV     A,R1
   \   000074   3B           ADDC    A,R3
   \   000075   F9           MOV     R1,A
   \   000076   E8           MOV     A,R0
   \   000077   2430         ADD     A,#0x30
   \   000079   F8           MOV     R0,A
   \   00007A   E9           MOV     A,R1
   \   00007B   34EB         ADDC    A,#-0x15
   \   00007D   F9           MOV     R1,A
   \   00007E   90....       MOV     DPTR,#IRCodeIndex
   \   000081   E8           MOV     A,R0
   \   000082   F0           MOVX    @DPTR,A
   \   000083   A3           INC     DPTR
   \   000084   E9           MOV     A,R1
   \   000085   F0           MOVX    @DPTR,A
    335          
    336          
    337             if('1' == CmdType)		//'1' 表示学习
   \   000086   90....       MOV     DPTR,#CmdType
   \   000089   E0           MOVX    A,@DPTR
   \   00008A   6431         XRL     A,#0x31
   \   00008C   700D         JNZ     ??USER_APP_COMMAND_0
    338             {
    339               irCodeRx(IRCodeIndex);
   \   00008E                ; Setup parameters for call to function irCodeRx
   \   00008E   90....       MOV     DPTR,#IRCodeIndex
   \   000091   E0           MOVX    A,@DPTR
   \   000092   FA           MOV     R2,A
   \   000093   A3           INC     DPTR
   \   000094   E0           MOVX    A,@DPTR
   \   000095   FB           MOV     R3,A
   \   000096   12....       LCALL   ??irCodeRx?relay
   \   000099   8013         SJMP    ??USER_APP_COMMAND_1
    340               //changePollRate();
    341          
    342             }
    343             else if('2' == CmdType)	//'2' 表示使用
   \                     ??USER_APP_COMMAND_0:
   \   00009B   90....       MOV     DPTR,#CmdType
   \   00009E   E0           MOVX    A,@DPTR
   \   00009F   6432         XRL     A,#0x32
   \   0000A1   700B         JNZ     ??USER_APP_COMMAND_1
    344             {   
    345               irCodeTx(IRCodeIndex);
   \   0000A3                ; Setup parameters for call to function irCodeTx
   \   0000A3   90....       MOV     DPTR,#IRCodeIndex
   \   0000A6   E0           MOVX    A,@DPTR
   \   0000A7   FA           MOV     R2,A
   \   0000A8   A3           INC     DPTR
   \   0000A9   E0           MOVX    A,@DPTR
   \   0000AA   FB           MOV     R3,A
   \   0000AB   12....       LCALL   ??irCodeTx?relay
    346               //changePollRate();
    347               //active_len=11;
    348               //return active_len;
    349             }
    350             str[1] = CmdType - '0';//数据回填
   \                     ??USER_APP_COMMAND_1:
   \   0000AE   90....       MOV     DPTR,#CmdType
   \   0000B1   E0           MOVX    A,@DPTR
   \   0000B2   24D0         ADD     A,#-0x30
   \   0000B4   85..82       MOV     DPL,?V0 + 0
   \   0000B7   85..83       MOV     DPH,?V0 + 1
   \   0000BA   A3           INC     DPTR
   \   0000BB   F0           MOVX    @DPTR,A
    351             str[3] = IRCodeIndex;//数据回填
   \   0000BC   90....       MOV     DPTR,#IRCodeIndex
   \   0000BF   E0           MOVX    A,@DPTR
   \   0000C0   F8           MOV     R0,A
   \   0000C1   A3           INC     DPTR
   \   0000C2   E0           MOVX    A,@DPTR
   \   0000C3   F9           MOV     R1,A
   \   0000C4   E8           MOV     A,R0
   \   0000C5   85..82       MOV     DPL,?V0 + 0
   \   0000C8   85..83       MOV     DPH,?V0 + 1
   \   0000CB   A3           INC     DPTR
   \   0000CC   A3           INC     DPTR
   \   0000CD   A3           INC     DPTR
   \   0000CE   F0           MOVX    @DPTR,A
    352             str[2] = IRCodeIndex >> 8;
   \   0000CF   90....       MOV     DPTR,#IRCodeIndex
   \   0000D2   E0           MOVX    A,@DPTR
   \   0000D3   F8           MOV     R0,A
   \   0000D4   A3           INC     DPTR
   \   0000D5   E0           MOVX    A,@DPTR
   \   0000D6   F9           MOV     R1,A
   \   0000D7   E4           CLR     A
   \   0000D8   E9           MOV     A,R1
   \   0000D9   F8           MOV     R0,A
   \   0000DA   85..82       MOV     DPL,?V0 + 0
   \   0000DD   85..83       MOV     DPH,?V0 + 1
   \   0000E0   A3           INC     DPTR
   \   0000E1   A3           INC     DPTR
   \   0000E2   F0           MOVX    @DPTR,A
    353             active_len=13;
   \   0000E3   75..0D       MOV     ?V0 + 2,#0xd
    354             return active_len;
   \   0000E6   A9..         MOV     R1,?V0 + 2
   \   0000E8   7F03         MOV     R7,#0x3
   \   0000EA   02....       LJMP    ?BANKED_LEAVE_XDATA
    355          
    356          }
    357          
    358          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    359          void USER_SET_RS_MSG(void)//用户自行设置RS数据
   \                     USER_SET_RS_MSG:
    360          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    361              DEVICE_ID=22;
   \   000004   90....       MOV     DPTR,#DEVICE_ID
   \   000007   7416         MOV     A,#0x16
   \   000009   F0           MOVX    @DPTR,A
    362              DEFINED_CONTROL_CHAR='T';
   \   00000A   90....       MOV     DPTR,#DEFINED_CONTROL_CHAR
   \   00000D   7454         MOV     A,#0x54
   \   00000F   F0           MOVX    @DPTR,A
    363              JOIN_ROLE=Send_Router;
   \   000010   90....       MOV     DPTR,#JOIN_ROLE
   \   000013   7400         MOV     A,#0x0
   \   000015   F0           MOVX    @DPTR,A
    364              RS_LEN = 1;
   \   000016   90....       MOV     DPTR,#RS_LEN
   \   000019   7401         MOV     A,#0x1
   \   00001B   F0           MOVX    @DPTR,A
    365              RS_STR[0]=0;
   \   00001C   90....       MOV     DPTR,#RS_STR
   \   00001F   7400         MOV     A,#0x0
   \   000021   F0           MOVX    @DPTR,A
    366          }
   \   000022   D083         POP     DPH
   \   000024   D082         POP     DPL
   \   000026   02....       LJMP    ?BRET
    367          
    368          
    369          /*
    370           用户自行规划主动上报数据的格式。
    371          */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    372          void SampleApp_SendInMessage(void)
   \                     SampleApp_SendInMessage:
    373          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
    374           
    375            uint8 *send_str;
    376            uint8 send_count=0;
   \   000005   75..00       MOV     ?V0 + 2,#0x0
    377            send_count = 10+1;
   \   000008   75..0B       MOV     ?V0 + 2,#0xb
    378            send_str = osal_mem_alloc(send_count);
   \   00000B                ; Setup parameters for call to function osal_mem_alloc
   \   00000B   85....       MOV     ?V0 + 0,?V0 + 2
   \   00000E   75..00       MOV     ?V0 + 1,#0x0
   \   000011   AA..         MOV     R2,?V0 + 0
   \   000013   AB..         MOV     R3,?V0 + 1
   \   000015   12....       LCALL   ??osal_mem_alloc?relay
   \   000018   8A..         MOV     ?V0 + 0,R2
   \   00001A   8B..         MOV     ?V0 + 1,R3
   \   00001C   AE..         MOV     R6,?V0 + 0
   \   00001E   AF..         MOV     R7,?V0 + 1
    379            
    380            USER_SEND_ADD_STR(send_str);  //\添加固定帧头
   \   000020                ; Setup parameters for call to function USER_SEND_ADD_STR
   \   000020   EE           MOV     A,R6
   \   000021   FA           MOV     R2,A
   \   000022   EF           MOV     A,R7
   \   000023   FB           MOV     R3,A
   \   000024   12....       LCALL   ??USER_SEND_ADD_STR?relay
    381          
    382            send_str[9]='S';
   \   000027   8E82         MOV     DPL,R6
   \   000029   8F83         MOV     DPH,R7
   \   00002B   A3           INC     DPTR
   \   00002C   A3           INC     DPTR
   \   00002D   A3           INC     DPTR
   \   00002E   A3           INC     DPTR
   \   00002F   A3           INC     DPTR
   \   000030   A3           INC     DPTR
   \   000031   A3           INC     DPTR
   \   000032   A3           INC     DPTR
   \   000033   A3           INC     DPTR
   \   000034   7453         MOV     A,#0x53
   \   000036   F0           MOVX    @DPTR,A
    383            send_str[10]=0;   
   \   000037   8E82         MOV     DPL,R6
   \   000039   8F83         MOV     DPH,R7
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   A3           INC     DPTR
   \   000045   7400         MOV     A,#0x0
   \   000047   F0           MOVX    @DPTR,A
    384          
    385            USER_APP_SEND_IN(send_count,send_str);//发送出数据
   \   000048                ; Setup parameters for call to function USER_APP_SEND_IN
   \   000048   EE           MOV     A,R6
   \   000049   FA           MOV     R2,A
   \   00004A   EF           MOV     A,R7
   \   00004B   FB           MOV     R3,A
   \   00004C   A9..         MOV     R1,?V0 + 2
   \   00004E   12....       LCALL   ??USER_APP_SEND_IN?relay
    386            
    387            osal_mem_free( send_str );
   \   000051                ; Setup parameters for call to function osal_mem_free
   \   000051   EE           MOV     A,R6
   \   000052   FA           MOV     R2,A
   \   000053   EF           MOV     A,R7
   \   000054   FB           MOV     R3,A
   \   000055   12....       LCALL   ??osal_mem_free?relay
    388          }
   \   000058   7F03         MOV     R7,#0x3
   \   00005A   02....       LJMP    ?BANKED_LEAVE_XDATA
    389          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    390          void User_APP_Drive_init(void)
   \                     User_APP_Drive_init:
    391          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    392          // USER自行添加应用初始化的代码，如初始化外设等
    393            // test app evt
    394            HAL_IO_CONFIG_INIT();
   \   000004   43FE01       ORL     0xfe,#0x1
   \   000007   43FE02       ORL     0xfe,#0x2
   \   00000A   D290         SETB    0x90.0
   \   00000C   D291         SETB    0x90.1
    395              // osal_start_timerEx( UserApp_TaskID, USER_TEST_EVT,10000);
    396           
    397          #if defined (M_V332)  
    398          #else
    399            PERCFG |= 0x20;  
    400          #endif  
    401            irrInit();
   \   00000E                ; Setup parameters for call to function irrInit
   \   00000E   12....       LCALL   ??irrInit?relay
    402          
    403          }
   \   000011   D083         POP     DPH
   \   000013   D082         POP     DPL
   \   000015   02....       LJMP    ?BRET
   \   000018                REQUIRE P1DIR
   \   000018                REQUIRE _A_P1
    404          
    405          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    406          uint8 READ_NETKEY() //读取入网状态按键的状态传递到应用层
   \                     READ_NETKEY:
    407          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    408          
    409            return HAL_PUSH_BUTTON3();
   \   000000   A292         MOV     C,0x90.2
   \   000002   E4           CLR     A
   \   000003   33           RLC     A
   \   000004   F9           MOV     R1,A
   \   000005   02....       LJMP    ?BRET
   \   000008                REQUIRE _A_P1
    410          }
    411          
    412          
    413          
    414          /*
    415          mode 0 关
    416          1 开
    417          2 切换
    418          */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    419          void LED_CHANGE(uint8 Position,uint8 Mode)// 设置LED函数
   \                     LED_CHANGE:
    420          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    421           switch (Position )
   \   000000   E9           MOV     A,R1
   \   000001   14           DEC     A
   \   000002   6018         JZ      ??LED_CHANGE_0
   \   000004   14           DEC     A
   \   000005   603F         JZ      ??LED_CHANGE_1
   \   000007   24FE         ADD     A,#-0x2
   \   000009   6064         JZ      ??LED_CHANGE_2
   \   00000B   24FC         ADD     A,#-0x4
   \   00000D   7003         JNZ     $+5
   \   00000F   02....       LJMP    ??LED_CHANGE_3 & 0xFFFF
   \   000012   24F8         ADD     A,#-0x8
   \   000014   7003         JNZ     $+5
   \   000016   02....       LJMP    ??LED_CHANGE_4 & 0xFFFF
   \   000019   02....       LJMP    ??LED_CHANGE_5 & 0xFFFF
    422              {
    423                case HAL_LED_1:      
    424                  {
    425                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_0:
   \   00001C   EA           MOV     A,R2
   \   00001D   6005         JZ      ??LED_CHANGE_6
   \   00001F   7401         MOV     A,#0x1
   \   000021   6A           XRL     A,R2
   \   000022   7010         JNZ     ??LED_CHANGE_7
    426                   {
    427                    LED1_SBIT = LED1_POLARITY(Mode);
   \                     ??LED_CHANGE_6:
   \   000024   EA           MOV     A,R2
   \   000025   7004         JNZ     ??LED_CHANGE_8
   \   000027   7801         MOV     R0,#0x1
   \   000029   8002         SJMP    ??LED_CHANGE_9
   \                     ??LED_CHANGE_8:
   \   00002B   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_9:
   \   00002D   E8           MOV     A,R0
   \   00002E   A2E0         MOV     C,0xE0 /* A   */.0
   \   000030   9290         MOV     0x90.0,C
   \   000032   800F         SJMP    ??LED_CHANGE_10
    428                   }
    429                   else if(Mode==2)
   \                     ??LED_CHANGE_7:
   \   000034   7402         MOV     A,#0x2
   \   000036   6A           XRL     A,R2
   \   000037   700A         JNZ     ??LED_CHANGE_10
    430                   {
    431                    if (LED1_SBIT) 
   \   000039   A290         MOV     C,0x90.0
   \   00003B   5004         JNC     ??LED_CHANGE_11
    432                    { 
    433                      LED1_SBIT = 0; 
   \   00003D   C290         CLR     0x90.0
   \   00003F   8002         SJMP    ??LED_CHANGE_10
    434                    } 
    435                    else 
    436                    { 
    437                      LED1_SBIT = 1;
   \                     ??LED_CHANGE_11:
   \   000041   D290         SETB    0x90.0
    438                    } 
    439                   }
    440                  }   
    441                  break;     
   \                     ??LED_CHANGE_10:
   \   000043   02....       LJMP    ??LED_CHANGE_5 & 0xFFFF
    442                  
    443                  case HAL_LED_2:      
    444                  {
    445                   if(Mode==0||Mode==1)
   \                     ??LED_CHANGE_1:
   \   000046   EA           MOV     A,R2
   \   000047   6005         JZ      ??LED_CHANGE_12
   \   000049   7401         MOV     A,#0x1
   \   00004B   6A           XRL     A,R2
   \   00004C   7010         JNZ     ??LED_CHANGE_13
    446                   {
    447                    LED2_SBIT = LED2_POLARITY(Mode);
   \                     ??LED_CHANGE_12:
   \   00004E   EA           MOV     A,R2
   \   00004F   7004         JNZ     ??LED_CHANGE_14
   \   000051   7801         MOV     R0,#0x1
   \   000053   8002         SJMP    ??LED_CHANGE_15
   \                     ??LED_CHANGE_14:
   \   000055   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_15:
   \   000057   E8           MOV     A,R0
   \   000058   A2E0         MOV     C,0xE0 /* A   */.0
   \   00005A   9291         MOV     0x90.1,C
   \   00005C   800F         SJMP    ??LED_CHANGE_16
    448                   }
    449                   else if(Mode==2)
   \                     ??LED_CHANGE_13:
   \   00005E   7402         MOV     A,#0x2
   \   000060   6A           XRL     A,R2
   \   000061   700A         JNZ     ??LED_CHANGE_16
    450                   {
    451                    if (LED1_SBIT) 
   \   000063   A290         MOV     C,0x90.0
   \   000065   5004         JNC     ??LED_CHANGE_17
    452                    { 
    453                      LED2_SBIT = 0; 
   \   000067   C291         CLR     0x90.1
   \   000069   807D         SJMP    ??LED_CHANGE_5
    454                    } 
    455                    else 
    456                    { 
    457                      LED2_SBIT = 1;
   \                     ??LED_CHANGE_17:
   \   00006B   D291         SETB    0x90.1
    458                    } 
    459                   }
    460                  }   
    461                  break;     
   \                     ??LED_CHANGE_16:
   \   00006D   8079         SJMP    ??LED_CHANGE_5
    462                  
    463                  case HAL_LED_3:      
    464                  {
    465                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_2:
   \   00006F   EA           MOV     A,R2
   \   000070   6005         JZ      ??LED_CHANGE_18
   \   000072   7401         MOV     A,#0x1
   \   000074   6A           XRL     A,R2
   \   000075   7010         JNZ     ??LED_CHANGE_19
    466                   {
    467                    LED3_SBIT = LED3_POLARITY(Mode);
   \                     ??LED_CHANGE_18:
   \   000077   EA           MOV     A,R2
   \   000078   6004         JZ      ??LED_CHANGE_20
   \   00007A   7801         MOV     R0,#0x1
   \   00007C   8002         SJMP    ??LED_CHANGE_21
   \                     ??LED_CHANGE_20:
   \   00007E   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_21:
   \   000080   E8           MOV     A,R0
   \   000081   A2E0         MOV     C,0xE0 /* A   */.0
   \   000083   9297         MOV     0x90.7,C
   \   000085   8061         SJMP    ??LED_CHANGE_5
    468                   }
    469                   else if(Mode==2)
   \                     ??LED_CHANGE_19:
   \   000087   7402         MOV     A,#0x2
   \   000089   6A           XRL     A,R2
   \   00008A   705C         JNZ     ??LED_CHANGE_5
    470                   {
    471                    if (LED3_SBIT) 
   \   00008C   A297         MOV     C,0x90.7
   \   00008E   5004         JNC     ??LED_CHANGE_22
    472                    { 
    473                      LED3_SBIT = 0; 
   \   000090   C297         CLR     0x90.7
   \   000092   8054         SJMP    ??LED_CHANGE_5
    474                    } 
    475                    else 
    476                    { 
    477                      LED3_SBIT = 1;
   \                     ??LED_CHANGE_22:
   \   000094   D297         SETB    0x90.7
    478                    } 
    479                   }
    480                  }   
    481                  break;  
   \   000096   8050         SJMP    ??LED_CHANGE_5
    482                  
    483                    case HAL_LED_4:      
    484                  {
    485                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_3:
   \   000098   EA           MOV     A,R2
   \   000099   6005         JZ      ??LED_CHANGE_23
   \   00009B   7401         MOV     A,#0x1
   \   00009D   6A           XRL     A,R2
   \   00009E   7010         JNZ     ??LED_CHANGE_24
    486                   {
    487                    LED4_SBIT = LED4_POLARITY(Mode);
   \                     ??LED_CHANGE_23:
   \   0000A0   EA           MOV     A,R2
   \   0000A1   6004         JZ      ??LED_CHANGE_25
   \   0000A3   7801         MOV     R0,#0x1
   \   0000A5   8002         SJMP    ??LED_CHANGE_26
   \                     ??LED_CHANGE_25:
   \   0000A7   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_26:
   \   0000A9   E8           MOV     A,R0
   \   0000AA   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000AC   9297         MOV     0x90.7,C
   \   0000AE   8038         SJMP    ??LED_CHANGE_5
    488                   }
    489                   else if(Mode==2)
   \                     ??LED_CHANGE_24:
   \   0000B0   7402         MOV     A,#0x2
   \   0000B2   6A           XRL     A,R2
   \   0000B3   7033         JNZ     ??LED_CHANGE_5
    490                   {
    491                    if (LED4_SBIT) 
   \   0000B5   A297         MOV     C,0x90.7
   \   0000B7   5004         JNC     ??LED_CHANGE_27
    492                    { 
    493                      LED4_SBIT = 0; 
   \   0000B9   C297         CLR     0x90.7
   \   0000BB   802B         SJMP    ??LED_CHANGE_5
    494                    } 
    495                    else 
    496                    { 
    497                      LED4_SBIT = 1;
   \                     ??LED_CHANGE_27:
   \   0000BD   D297         SETB    0x90.7
    498                    } 
    499                   }
    500                  }   
    501                  break;
   \   0000BF   8027         SJMP    ??LED_CHANGE_5
    502                  
    503                    case HAL_LED_5:      
    504                  {
    505                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_4:
   \   0000C1   EA           MOV     A,R2
   \   0000C2   6005         JZ      ??LED_CHANGE_28
   \   0000C4   7401         MOV     A,#0x1
   \   0000C6   6A           XRL     A,R2
   \   0000C7   7010         JNZ     ??LED_CHANGE_29
    506                   {
    507                    LED5_SBIT = LED5_POLARITY(Mode);
   \                     ??LED_CHANGE_28:
   \   0000C9   EA           MOV     A,R2
   \   0000CA   6004         JZ      ??LED_CHANGE_30
   \   0000CC   7801         MOV     R0,#0x1
   \   0000CE   8002         SJMP    ??LED_CHANGE_31
   \                     ??LED_CHANGE_30:
   \   0000D0   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_31:
   \   0000D2   E8           MOV     A,R0
   \   0000D3   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000D5   9297         MOV     0x90.7,C
   \   0000D7   800F         SJMP    ??LED_CHANGE_5
    508                   }
    509                   else if(Mode==2)
   \                     ??LED_CHANGE_29:
   \   0000D9   7402         MOV     A,#0x2
   \   0000DB   6A           XRL     A,R2
   \   0000DC   700A         JNZ     ??LED_CHANGE_5
    510                   {
    511                    if (LED5_SBIT) 
   \   0000DE   A297         MOV     C,0x90.7
   \   0000E0   5004         JNC     ??LED_CHANGE_32
    512                    { 
    513                      LED5_SBIT = 0; 
   \   0000E2   C297         CLR     0x90.7
   \   0000E4   8002         SJMP    ??LED_CHANGE_5
    514                    } 
    515                    else 
    516                    { 
    517                      LED5_SBIT = 1;
   \                     ??LED_CHANGE_32:
   \   0000E6   D297         SETB    0x90.7
    518                    } 
    519                   }
    520                  }   
    521                  break;
    522          
    523              default:
    524                break;
    525              }
    526          }
   \                     ??LED_CHANGE_5:
   \   0000E8   02....       LJMP    ?BRET
   \   0000EB                REQUIRE _A_P1
    527          
    528          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    529          void USER_ZDO_JOINING_MSG(void)
   \                     USER_ZDO_JOINING_MSG:
    530          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    531           HalLedBlink ( HAL_LED_1, 1, 30, 500 );
   \   000004                ; Setup parameters for call to function HalLedBlink
   \   000004   7CF4         MOV     R4,#-0xc
   \   000006   7D01         MOV     R5,#0x1
   \   000008   7B1E         MOV     R3,#0x1e
   \   00000A   7A01         MOV     R2,#0x1
   \   00000C   7901         MOV     R1,#0x1
   \   00000E   12....       LCALL   ??HalLedBlink?relay
    532          }
   \   000011   D083         POP     DPH
   \   000013   D082         POP     DPL
   \   000015   02....       LJMP    ?BRET
    533          //RS后面是否要处理相关事件或者应用，在此进行处理

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    534          void USER_AFTER_RS_MSG(void)
   \                     USER_AFTER_RS_MSG:
    535          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    536          
    537          
    538          }
   \   000000   02....       LJMP    ?BRET

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for bindingINClusters1>`:
   \   000000   0100         DW 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for SampleApp_SimpleDesc1>`:
   \   000000   15           DB 21
   \   000001   080F         DW 3848
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   01           DB 1
   \   000007   ....         DW SampleApp_ClusterList1
   \   000009   01           DB 1
   \   00000A   ....         DW SampleApp_ClusterList1

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??UserApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    UserApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??UserApp_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    UserApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_HandleKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_HandleKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_ProcessBINDINGMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_ProcessBINDINGMessage

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_APP_JOIN_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_APP_JOIN_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_APP_COMMAND?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_APP_COMMAND

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_SET_RS_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_SET_RS_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_SendInMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_SendInMessage

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??User_APP_Drive_init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    User_APP_Drive_init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??READ_NETKEY?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    READ_NETKEY

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??LED_CHANGE?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    LED_CHANGE

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_ZDO_JOINING_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_ZDO_JOINING_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_AFTER_RS_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_AFTER_RS_MSG

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     LED_CHANGE                         0      0      0
     READ_NETKEY                        0      0      0
     SampleApp_HandleKeys               0      0     23
       -> APPLY_TO_JOIN_OF_KEY          0      0     18
       -> SampleApp_send_in_binding_req
                                        0      0     18
       -> SampleApp_PermitJoin          0      0     18
       -> SampleApp_PermitJoin          0      0     18
       -> HalLedBlink                   0      0     18
       -> RESTORE_TO_FACTORY            0      0     18
       -> osal_start_timerEx            0      0     18
     SampleApp_ProcessBINDINGMessage
                                        0      0      9
       -> SampleApp_SendInMessage       0      0     18
     SampleApp_SendInMessage            0      0     20
       -> osal_mem_alloc                0      0     22
       -> USER_SEND_ADD_STR             0      0     22
       -> USER_APP_SEND_IN              0      0     22
       -> osal_mem_free                 0      0     22
     USER_AFTER_RS_MSG                  0      0      0
     USER_APP_COMMAND                   1      0     11
       -> irCodeRx                      0      0     22
       -> irCodeTx                      0      0     22
     USER_APP_JOIN_MSG                  0      0     10
       -> HalLedBlink                   0      0     20
       -> SampleApp_GetShortAddr        0      0     20
       -> osal_mem_free                 0      0     20
     USER_SET_RS_MSG                    2      0      0
     USER_ZDO_JOINING_MSG               2      0      0
       -> HalLedBlink                   4      0      0
     UserApp_Init                       0      0      9
       -> RegisterForKeys               0      0     18
       -> User_APP_Drive_init           0      0     18
     UserApp_ProcessEvent               0      0     14
       -> osal_msg_receive              0      0     28
       -> SampleApp_HandleKeys          0      0     28
       -> osal_msg_deallocate           0      0     28
       -> osal_msg_receive              0      0     28
       -> osal_start_timerEx            0      0     28
     User_APP_Drive_init                2      0      9
       -> irrInit                       4      0      0


   Segment part sizes:

     Function/Label                           Bytes
     --------------                           -----
     _A_P1                                       1
     P1DIR                                       1
     UserApp_TaskID                              1
     RS_LEN                                      1
     RS_STR                                     10
     SHORT_ADRESS                                4
     USER_DATA_LEN                               1
     USER_DATA_TYPE                              1
     USER_DATA_STR                               2
     DEVICE_ID                                   1
     DEFINED_CONTROL_CHAR                        1
     JOIN_ROLE                                   1
     bindingINClusters1                          2
     SampleApp_ClusterList1                      2
     SampleApp_SimpleDesc1                      12
     SampleApp_epDesc1                           6
     CmdType                                     1
     IRCodeIndex                                 2
     UserApp_Init                               26
     UserApp_ProcessEvent                      171
     SampleApp_HandleKeys                      131
     SampleApp_ProcessBINDINGMessage
                                                86
     USER_APP_JOIN_MSG                         108
     USER_APP_COMMAND                          237
     USER_SET_RS_MSG                            41
     SampleApp_SendInMessage                    93
     User_APP_Drive_init                        24
     READ_NETKEY                                 8
     LED_CHANGE                                235
     USER_ZDO_JOINING_MSG                       24
     USER_AFTER_RS_MSG                           3
     ?<Initializer for bindingINClusters1>       2
     ?<Initializer for SampleApp_SimpleDesc1>   12
     ??UserApp_Init?relay                        6
     ??UserApp_ProcessEvent?relay                6
     ??SampleApp_HandleKeys?relay                6
     ??SampleApp_ProcessBINDINGMessage?relay     6
     ??USER_APP_JOIN_MSG?relay                   6
     ??USER_APP_COMMAND?relay                    6
     ??USER_SET_RS_MSG?relay                     6
     ??SampleApp_SendInMessage?relay             6
     ??User_APP_Drive_init?relay                 6
     ??READ_NETKEY?relay                         6
     ??LED_CHANGE?relay                          6
     ??USER_ZDO_JOINING_MSG?relay                6
     ??USER_AFTER_RS_MSG?relay                   6

 
 1 187 bytes in segment BANKED_CODE
    78 bytes in segment BANK_RELAYS
     2 bytes in segment SFR_AN
    14 bytes in segment XDATA_I
    14 bytes in segment XDATA_ID
     2 bytes in segment XDATA_ROM_C
    32 bytes in segment XDATA_Z
 
 1 279 bytes of CODE  memory
     2 bytes of CONST memory
     0 bytes of DATA  memory (+ 2 bytes shared)
    46 bytes of XDATA memory

Errors: none
Warnings: 2
