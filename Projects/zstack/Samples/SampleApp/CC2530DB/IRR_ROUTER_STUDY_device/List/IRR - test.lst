###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         10/Dec/2014  17:46:59 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\Source\rssi_test\c\IRR -       #
#                          test.c                                             #
#    Command line       =  -f "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\z #
#                          stack\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC #
#                          2530DB\f8wRouter.cfg" (-DCPU32MHZ                  #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8       #
#                          -DMAC_CFG_RX_MAX=5 -DRTR_NWK) -f                   #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC253 #
#                          0DB\f8wConfig.cfg" (-DZIGBEEPRO -DSECURE=1         #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=60            #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=30           #
#                          -DNWK_MAX_BINDING_ENTRIES=8                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 -DASSERT_RESET         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=8000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=1000)  #
#                          -DREJOIN_POLL_RATE=440 "D:\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\Source #
#                          \rssi_test\c\IRR - test.c" -D NV_INIT -D           #
#                          NV_RESTORE -D HOLD_AUTO_START -D MT_TASK -D        #
#                          MT_APP_FUNC -D MT_SYS_FUNC -D MT_ZDO_FUNC -D       #
#                          MT_ZDO_MGMT -D ISR_KEYINTERRUPT -D xWDT_IN_PM1 -D  #
#                          xOSC32K_CRYSTAL_INSTALLED=0 -D xLARGER_NETWORK -D  #
#                          xPOWER_PA -D IRR_ROUTER -D HAVE_TEST_FUN -lC       #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\IRR_ROUTER_STUDY_dev #
#                          ice\List\" -lA "D:\RE_1_2_0_FORMAL_APP(251)-14-12- #
#                          8\Projects\zstack\Samples\SampleApp\CC2530DB\IRR_R #
#                          OUTER_STUDY_device\List\" --diag_suppress          #
#                          Pe001,Pa010 -o "D:\RE_1_2_0_FORMAL_APP(251)-14-12- #
#                          8\Projects\zstack\Samples\SampleApp\CC2530DB\IRR_R #
#                          OUTER_STUDY_device\Obj\" -e --no_cse --no_unroll   #
#                          --no_inline --no_code_motion --no_tbaa --debug     #
#                          --core=plain --dptr=16,1 --data_model=large        #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I "D:\RE_1_2_0_FORMAL_APP(25 #
#                          1)-14-12-8\Projects\zstack\Samples\SampleApp\CC253 #
#                          0DB\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\Source\" #
#                           -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\ #
#                          zstack\Samples\SampleApp\CC2530DB\..\Source\rssi_t #
#                          est\h\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Pr #
#                          ojects\zstack\Samples\SampleApp\CC2530DB\..\Source #
#                          \IRR_router\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-1 #
#                          2-8\Projects\zstack\Samples\SampleApp\CC2530DB\..\ #
#                          ..\..\ZMain\TI2530DB\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\hal\include\" -I "D:\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\hal\target\CC2530EB\" #
#                           -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\ #
#                          zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\C #
#                          omponents\mac\include\" -I                         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\high_level\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\low_level\srf04\" -I                     #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\low_level\srf04\single_chip\" -I         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mt\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8 #
#                          \Projects\zstack\Samples\SampleApp\CC2530DB\..\..\ #
#                          ..\..\..\Components\osal\include\" -I              #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\services\saddr\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\services\sdata\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\af\" -I "D:\RE_1_2_0_FORMAL_APP(251)-1 #
#                          4-12-8\Projects\zstack\Samples\SampleApp\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\nwk\" -I           #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\sapi\" -I "D:\RE_1_2_0_FORMAL_APP(251) #
#                          -14-12-8\Projects\zstack\Samples\SampleApp\CC2530D #
#                          B\..\..\..\..\..\Components\stack\sec\" -I         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\sys\" -I "D:\RE_1_2_0_FORMAL_APP(251)- #
#                          14-12-8\Projects\zstack\Samples\SampleApp\CC2530DB #
#                          \..\..\..\..\..\Components\stack\zdo\" -I          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\zmac\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12 #
#                          -8\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\Components\zmac\f8w\" -On               #
#                          --require_prototypes                               #
#    List file          =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\CC2530DB\IRR_ROUTER_STUDY_devi #
#                          ce\List\IRR - test.lst                             #
#    Object file        =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\CC2530DB\IRR_ROUTER_STUDY_devi #
#                          ce\Obj\IRR - test.r51                              #
#                                                                             #
#                                                                             #
###############################################################################

D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstack\Samples\SampleApp\Source\rssi_test\c\IRR - test.c
      1          /*******************************************************************************
      2          *
      3          *功能描述：TIMER3中断200次LED闪烁一次
      4          *
      5          *作者：Rfstorm studio QQ群：51109148
      6          *
      7          *时间：2010-12-7
      8          *
      9          ********************************************************************************/
     10          
     11          //#include "T3config.h"
     12          //#include "T4config.h"
     13          #include "hal_mcu.h"

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xcb
   \   unsigned char volatile __sfr T3CTL
   \                     T3CTL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xcc
   \   unsigned char volatile __sfr T3CCTL0
   \                     T3CCTL0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xce
   \   unsigned char volatile __sfr T3CCTL1
   \                     T3CCTL1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xeb
   \   unsigned char volatile __sfr T4CTL
   \                     T4CTL:
   \   000000                DS 1
     14          #include "hal_board_cfg.h"
     15          #include "ZComDef.h"
     16          #include "OSAL_Nv.h"
     17          #include "hal_led.h"
     18          
     19          #include "irr.h"
     20          #include "m25p16.h"
     21          
     22          
     23          #define uint unsigned int
     24          #define uchar unsigned char
     25          
     26          extern void  Delay_1u_test(uint32 microSecs);
     27          
     28          extern unsigned char m25p16_ID[4];	
     29          
     30          extern uint8 IR_REC_OK;	
     31          
     32          //void Initial(void);
     33          
     34          /*****************************************
     35          //定义全局变量
     36          *****************************************/
     37          //uchar counter = 0;
     38          //uint16 pluseWide[127];
     39          //uint16 pluseWide[127];
     40          //uint16 rEdgeTimeSlot[100];  //上升沿时间间隔
     41          //uint16 fEdgeTimeSlot[100];   //下降沿时间间隔
     42          
     43          //uint16 EdgeTimeSlot;   
     44          //uint16 EdgeTimeSlot_LR[500];   //边沿时间间隔= EdgeTimeSlot_LRsl * us10Cnt + EdgeTimeSlot_HRsl
     45          //uint16 EdgeTimeSlot_LRsl = 0;   //边沿时间间隔 低分辨率  10us
     46          
     47          //uint8  EdgeTimeSlot_HR[500];   //边沿时间间隔 高分辨率  0.125us
     48          //uint8  EdgeTimeSlot_HRsl = 0;   //边沿时间间隔 高分辨率  0.125us
     49          
     50          /*
     51          volatile uint16 ledBlinkCnt = 0;        //
     52          
     53          volatile uint16 us10Cnt = 0;        //t4 计时器时隙
     54          volatile uint16  edgeCnt = 0;       //边沿计数
     55          volatile uint16  edgeCnt_temp = 0;  //边沿计数
     56          
     57          uint16  edgeNum = 0;
     58          uint8 singleEdgeEndFlag = 0;
     59          
     60          uint8  m0 = 0;
     61          uint8  NV_ACType = '0'; //保存在NV中的空调类别初始化时为'0','1'是A类，'2'是B类
     62          uint8  NV_CTType = '0'; //保存在NV中的空调类别初始化时为'0',
     63          
     64          //uint8  edgeCntPre = 255;       //边沿计数
     65          uint8  callIrRxFunFlag = 0; //调用红外编码接收函数标志
     66          uint8  callIrTxFunFlag = 0; //调用红外编码发送函数标志
     67          //uint8 i;
     68          volatile uint8 irCodeTxFlag = 0;
     69          volatile uint8 irCodeRxFlag = 0;
     70          */
     71          
     72          void irCodeRx4Test(void);
     73          void irCodeTx4Test(void);
     74          void flashTest(void);
     75          //void keyCheck();
     76          //void irCodeRx();
     77          //void irCodeTx();
     78          /****************************
     79          //初始化程序
     80          *************************/
     81          /*void delay(uint16 i)
     82          {
     83           uint16 x,y;
     84          for(x = 0;x < i;x++)
     85            for(y = 0; y<0xffff;y++);
     86            
     87          }
     88          */
     89          
     90          
     91          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     92          void irCodeRx4Test(void)
   \                     irCodeRx4Test:
     93          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
     94            uint8 i;
     95                  uint16 ledBlink100msCnt = 0;
   \   000005   7E00         MOV     R6,#0x0
   \   000007   7F00         MOV     R7,#0x0
     96          	uint8  ms100Cnt=0;//学习超时计时用
   \   000009   75..00       MOV     ?V0 + 1,#0x0
     97          	
     98          	P1_5 = 1;//open the power for receive pin 
   \   00000C   D295         SETB    0x90.5
     99          	Delay_1u_test(65000);//学习时避开接收管上电瞬间引脚电平翻转的影响
   \   00000E                ; Setup parameters for call to function Delay_1u_test
   \   00000E   90....       MOV     DPTR,#__Constant_fde8
   \   000011   12....       LCALL   ?XLOAD_R2345
   \   000014   12....       LCALL   ??Delay_1u_test?relay
    100          	
    101                  for(i= 0 ;i<10;i++)
   \   000017   75..00       MOV     ?V0 + 0,#0x0
   \                     ??irCodeRx4Test_0:
   \   00001A   E5..         MOV     A,?V0 + 0
   \   00001C   C3           CLR     C
   \   00001D   940A         SUBB    A,#0xa
   \   00001F   5030         JNC     ??irCodeRx4Test_1
    102                  {
    103                    EdgeTimeSlot_LR[i] = 0;
   \   000021   E5..         MOV     A,?V0 + 0
   \   000023   A8..         MOV     R0,?V0 + 0
   \   000025   7900         MOV     R1,#0x0
   \   000027   E8           MOV     A,R0
   \   000028   75F002       MOV     B,#0x2
   \   00002B   A4           MUL     AB
   \   00002C   C8           XCH     A,R0
   \   00002D   AAF0         MOV     R2,B
   \   00002F   75F000       MOV     B,#0x0
   \   000032   A4           MUL     AB
   \   000033   2A           ADD     A,R2
   \   000034   FA           MOV     R2,A
   \   000035   75F002       MOV     B,#0x2
   \   000038   E9           MOV     A,R1
   \   000039   A4           MUL     AB
   \   00003A   2A           ADD     A,R2
   \   00003B   F9           MOV     R1,A
   \   00003C   74..         MOV     A,#EdgeTimeSlot_LR & 0xff
   \   00003E   28           ADD     A,R0
   \   00003F   F582         MOV     DPL,A
   \   000041   74..         MOV     A,#(EdgeTimeSlot_LR >> 8) & 0xff
   \   000043   39           ADDC    A,R1
   \   000044   F583         MOV     DPH,A
   \   000046   7400         MOV     A,#0x0
   \   000048   F0           MOVX    @DPTR,A
   \   000049   A3           INC     DPTR
   \   00004A   7400         MOV     A,#0x0
   \   00004C   F0           MOVX    @DPTR,A
    104                  }
   \   00004D   05..         INC     ?V0 + 0
   \   00004F   80C9         SJMP    ??irCodeRx4Test_0
    105            
    106          	irCodeRxFlag = 1;
   \                     ??irCodeRx4Test_1:
   \   000051   90....       MOV     DPTR,#irCodeRxFlag
   \   000054   7401         MOV     A,#0x1
   \   000056   F0           MOVX    @DPTR,A
    107          	edgeCnt = 0;
   \   000057   90....       MOV     DPTR,#edgeCnt
   \   00005A   7400         MOV     A,#0x0
   \   00005C   F0           MOVX    @DPTR,A
   \   00005D   A3           INC     DPTR
   \   00005E   7400         MOV     A,#0x0
   \   000060   F0           MOVX    @DPTR,A
    108              T3CCTL1 = 0x43;     //T3 cha1 config as capture mode;both edges 
   \   000061   75CE43       MOV     0xce,#0x43
    109              TIMER3_START(1);       //启动T3,
   \   000064   43CB10       ORL     0xcb,#0x10
    110              TIMER34_START(4,1);    //启动T4,
   \   000067   43EB10       ORL     0xeb,#0x10
    111              while(1)
    112          	{
    113          		if(!edgeCnt)
   \                     ??irCodeRx4Test_2:
   \   00006A   90....       MOV     DPTR,#edgeCnt
   \   00006D   E0           MOVX    A,@DPTR
   \   00006E   F8           MOV     R0,A
   \   00006F   A3           INC     DPTR
   \   000070   E0           MOVX    A,@DPTR
   \   000071   F9           MOV     R1,A
   \   000072   E8           MOV     A,R0
   \   000073   49           ORL     A,R1
   \   000074   705B         JNZ     ??irCodeRx4Test_3
    114          		{
    115          			//无边沿，即没编码。作10s等待处理
    116          			if(10000 == us10Cnt) //100ms
   \   000076   90....       MOV     DPTR,#us10Cnt
   \   000079   E0           MOVX    A,@DPTR
   \   00007A   6410         XRL     A,#0x10
   \   00007C   7004         JNZ     ??irCodeRx4Test_4
   \   00007E   A3           INC     DPTR
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   6427         XRL     A,#0x27
   \                     ??irCodeRx4Test_4:
   \   000082   7014         JNZ     ??irCodeRx4Test_5
    117          			{
    118          				ms100Cnt++;
   \   000084   05..         INC     ?V0 + 1
    119          				us10Cnt = 0;
   \   000086   90....       MOV     DPTR,#us10Cnt
   \   000089   7400         MOV     A,#0x0
   \   00008B   F0           MOVX    @DPTR,A
   \   00008C   A3           INC     DPTR
   \   00008D   7400         MOV     A,#0x0
   \   00008F   F0           MOVX    @DPTR,A
    120                                          ledBlink100msCnt++;
   \   000090   EE           MOV     A,R6
   \   000091   2401         ADD     A,#0x1
   \   000093   FE           MOV     R6,A
   \   000094   EF           MOV     A,R7
   \   000095   3400         ADDC    A,#0x0
   \   000097   FF           MOV     R7,A
    121          			}
    122                                  
    123          			if(100 == ms100Cnt)//10s
   \                     ??irCodeRx4Test_5:
   \   000098   7464         MOV     A,#0x64
   \   00009A   65..         XRL     A,?V0 + 1
   \   00009C   7019         JNZ     ??irCodeRx4Test_6
    124          			{
    125          				TIMER34_START(4,0);    //关闭T4,
   \   00009E   53EBEF       ANL     0xeb,#0xef
    126          				TIMER3_START(0);       //关闭T3,
   \   0000A1   53CBEF       ANL     0xcb,#0xef
    127          				//T3CCTL0 = 0;     	 
    128          				T3CCTL1 = 0;
   \   0000A4   75CE00       MOV     0xce,#0x0
    129          				irCodeRxFlag = 0;
   \   0000A7   90....       MOV     DPTR,#irCodeRxFlag
   \   0000AA   7400         MOV     A,#0x0
   \   0000AC   F0           MOVX    @DPTR,A
    130          				ms100Cnt = 0;
   \   0000AD   75..00       MOV     ?V0 + 1,#0x0
    131          				P1_5 = 0;//close  the power for low power model
   \   0000B0   C295         CLR     0x90.5
    132          				//m25p16_deepPowerDown();
    133          				//powerDown();
    134                                          P1_1 = 1;//off led
   \   0000B2   D291         SETB    0x90.1
    135                                          
    136          				return;
   \   0000B4   02....       LJMP    ??irCodeRx4Test_7 & 0xFFFF
    137          			}
    138                                  if(ledBlink100msCnt == 5)//500ms
   \                     ??irCodeRx4Test_6:
   \   0000B7   7405         MOV     A,#0x5
   \   0000B9   6E           XRL     A,R6
   \   0000BA   7003         JNZ     ??irCodeRx4Test_8
   \   0000BC   7400         MOV     A,#0x0
   \   0000BE   6F           XRL     A,R7
   \                     ??irCodeRx4Test_8:
   \   0000BF   70A9         JNZ     ??irCodeRx4Test_2
    139                                  {
    140                                    P1_1 = ~P1_1;
   \   0000C1   D2F0         SETB    B.0
   \   0000C3   A291         MOV     C,0x90.1
   \   0000C5   30F001       JNB     B.0,??irCodeRx4Test_9
   \   0000C8   B3           CPL     C
   \                     ??irCodeRx4Test_9:
   \   0000C9   9291         MOV     0x90.1,C
    141                                    ledBlink100msCnt = 0;
   \   0000CB   7E00         MOV     R6,#0x0
   \   0000CD   7F00         MOV     R7,#0x0
   \   0000CF   8099         SJMP    ??irCodeRx4Test_2
    142                                  }
    143          		}
    144          		else
    145          		{
    146                                  P1_1 = 0;//on led
   \                     ??irCodeRx4Test_3:
   \   0000D1   C291         CLR     0x90.1
    147          			//已经捕捉到边沿
    148          			if(60000 < us10Cnt) //600ms 收不到数据，或者无新数据，学习结束
   \   0000D3   90....       MOV     DPTR,#us10Cnt
   \   0000D6   C3           CLR     C
   \   0000D7   E0           MOVX    A,@DPTR
   \   0000D8   9461         SUBB    A,#0x61
   \   0000DA   A3           INC     DPTR
   \   0000DB   E0           MOVX    A,@DPTR
   \   0000DC   94EA         SUBB    A,#-0x16
   \   0000DE   5003         JNC     $+5
   \   0000E0   02....       LJMP    ??irCodeRx4Test_10 & 0xFFFF
    149          			{
    150          				TIMER34_START(4,0);    //关闭T4,
   \   0000E3   53EBEF       ANL     0xeb,#0xef
    151          				TIMER3_START(0);       //关闭T3,
   \   0000E6   53CBEF       ANL     0xcb,#0xef
    152          				//T3CCTL0 = 0;     	 
    153          				T3CCTL1 = 0;
   \   0000E9   75CE00       MOV     0xce,#0x0
    154          				us10Cnt = 0;
   \   0000EC   90....       MOV     DPTR,#us10Cnt
   \   0000EF   7400         MOV     A,#0x0
   \   0000F1   F0           MOVX    @DPTR,A
   \   0000F2   A3           INC     DPTR
   \   0000F3   7400         MOV     A,#0x0
   \   0000F5   F0           MOVX    @DPTR,A
    155          				edgeNum = edgeCnt;
   \   0000F6   90....       MOV     DPTR,#edgeCnt
   \   0000F9   E0           MOVX    A,@DPTR
   \   0000FA   F8           MOV     R0,A
   \   0000FB   A3           INC     DPTR
   \   0000FC   E0           MOVX    A,@DPTR
   \   0000FD   F9           MOV     R1,A
   \   0000FE   90....       MOV     DPTR,#edgeNum
   \   000101   E8           MOV     A,R0
   \   000102   F0           MOVX    @DPTR,A
   \   000103   A3           INC     DPTR
   \   000104   E9           MOV     A,R1
   \   000105   F0           MOVX    @DPTR,A
    156          				edgeCnt_temp = 0;
   \   000106   90....       MOV     DPTR,#edgeCnt_temp
   \   000109   7400         MOV     A,#0x0
   \   00010B   F0           MOVX    @DPTR,A
   \   00010C   A3           INC     DPTR
   \   00010D   7400         MOV     A,#0x0
   \   00010F   F0           MOVX    @DPTR,A
    157          				edgeCnt = 0;
   \   000110   90....       MOV     DPTR,#edgeCnt
   \   000113   7400         MOV     A,#0x0
   \   000115   F0           MOVX    @DPTR,A
   \   000116   A3           INC     DPTR
   \   000117   7400         MOV     A,#0x0
   \   000119   F0           MOVX    @DPTR,A
    158          
    159                                                                      
    160                                          for(i= 1 ;i<10;i++)
   \   00011A   75..01       MOV     ?V0 + 0,#0x1
   \                     ??irCodeRx4Test_11:
   \   00011D   E5..         MOV     A,?V0 + 0
   \   00011F   C3           CLR     C
   \   000120   940A         SUBB    A,#0xa
   \   000122   5070         JNC     ??irCodeRx4Test_12
    161                                          {
    162                                            if((180< EdgeTimeSlot_LR[i]) && (EdgeTimeSlot_LR[i]<220))
   \   000124   E5..         MOV     A,?V0 + 0
   \   000126   A8..         MOV     R0,?V0 + 0
   \   000128   7900         MOV     R1,#0x0
   \   00012A   E8           MOV     A,R0
   \   00012B   75F002       MOV     B,#0x2
   \   00012E   A4           MUL     AB
   \   00012F   C8           XCH     A,R0
   \   000130   AAF0         MOV     R2,B
   \   000132   75F000       MOV     B,#0x0
   \   000135   A4           MUL     AB
   \   000136   2A           ADD     A,R2
   \   000137   FA           MOV     R2,A
   \   000138   75F002       MOV     B,#0x2
   \   00013B   E9           MOV     A,R1
   \   00013C   A4           MUL     AB
   \   00013D   2A           ADD     A,R2
   \   00013E   F9           MOV     R1,A
   \   00013F   74..         MOV     A,#EdgeTimeSlot_LR & 0xff
   \   000141   28           ADD     A,R0
   \   000142   F582         MOV     DPL,A
   \   000144   74..         MOV     A,#(EdgeTimeSlot_LR >> 8) & 0xff
   \   000146   39           ADDC    A,R1
   \   000147   F583         MOV     DPH,A
   \   000149   C3           CLR     C
   \   00014A   E0           MOVX    A,@DPTR
   \   00014B   94B5         SUBB    A,#-0x4b
   \   00014D   A3           INC     DPTR
   \   00014E   E0           MOVX    A,@DPTR
   \   00014F   9400         SUBB    A,#0x0
   \   000151   4039         JC      ??irCodeRx4Test_13
   \   000153   E5..         MOV     A,?V0 + 0
   \   000155   A8..         MOV     R0,?V0 + 0
   \   000157   7900         MOV     R1,#0x0
   \   000159   E8           MOV     A,R0
   \   00015A   75F002       MOV     B,#0x2
   \   00015D   A4           MUL     AB
   \   00015E   C8           XCH     A,R0
   \   00015F   AAF0         MOV     R2,B
   \   000161   75F000       MOV     B,#0x0
   \   000164   A4           MUL     AB
   \   000165   2A           ADD     A,R2
   \   000166   FA           MOV     R2,A
   \   000167   75F002       MOV     B,#0x2
   \   00016A   E9           MOV     A,R1
   \   00016B   A4           MUL     AB
   \   00016C   2A           ADD     A,R2
   \   00016D   F9           MOV     R1,A
   \   00016E   74..         MOV     A,#EdgeTimeSlot_LR & 0xff
   \   000170   28           ADD     A,R0
   \   000171   F582         MOV     DPL,A
   \   000173   74..         MOV     A,#(EdgeTimeSlot_LR >> 8) & 0xff
   \   000175   39           ADDC    A,R1
   \   000176   F583         MOV     DPH,A
   \   000178   C3           CLR     C
   \   000179   E0           MOVX    A,@DPTR
   \   00017A   94DC         SUBB    A,#-0x24
   \   00017C   A3           INC     DPTR
   \   00017D   E0           MOVX    A,@DPTR
   \   00017E   9400         SUBB    A,#0x0
   \   000180   500A         JNC     ??irCodeRx4Test_13
    163                                            {
    164                                              IR_REC_OK = 1;
   \   000182   90....       MOV     DPTR,#IR_REC_OK
   \   000185   7401         MOV     A,#0x1
   \   000187   F0           MOVX    @DPTR,A
    165                                            }
   \   000188   05..         INC     ?V0 + 0
   \   00018A   8091         SJMP    ??irCodeRx4Test_11
    166                                            else
    167                                            {
    168                                              //ir fail
    169                                              //P1_1 = 0;//off led	
    170                                              IR_REC_OK = 0;
   \                     ??irCodeRx4Test_13:
   \   00018C   90....       MOV     DPTR,#IR_REC_OK
   \   00018F   7400         MOV     A,#0x0
   \   000191   F0           MOVX    @DPTR,A
    171                                              return;
   \   000192   806A         SJMP    ??irCodeRx4Test_7
    172          
    173                                              //while(1);
    174                                            }
    175                                          
    176                                          }
    177                              
    178                                          
    179          				irCodeRxFlag = 0;
   \                     ??irCodeRx4Test_12:
   \   000194   90....       MOV     DPTR,#irCodeRxFlag
   \   000197   7400         MOV     A,#0x0
   \   000199   F0           MOVX    @DPTR,A
    180          				P1_5 = 0;//close  the power for low power model
   \   00019A   C295         CLR     0x90.5
    181                                          //HalLedBlink ( HAL_LED_2, 3, 50, 200 );//用BLINK模拟灯亮两秒后熄灭
    182                                          P1_1 = 1;//off led			
   \   00019C   D291         SETB    0x90.1
    183                                          return;
   \   00019E   805E         SJMP    ??irCodeRx4Test_7
    184          			}
    185          			else
    186          			{
    187          				//保存编码中边沿间隔的时间值至NV
    188          				if(edgeCnt_temp != edgeCnt)
                 				^
Warning[Pa082]: undefined behavior: the order of volatile accesses is
          undefined in this statement
   \                     ??irCodeRx4Test_10:
   \   0001A0   90....       MOV     DPTR,#edgeCnt_temp
   \   0001A3   E0           MOVX    A,@DPTR
   \   0001A4   F8           MOV     R0,A
   \   0001A5   A3           INC     DPTR
   \   0001A6   E0           MOVX    A,@DPTR
   \   0001A7   F9           MOV     R1,A
   \   0001A8   90....       MOV     DPTR,#edgeCnt
   \   0001AB   E0           MOVX    A,@DPTR
   \   0001AC   68           XRL     A,R0
   \   0001AD   7003         JNZ     ??irCodeRx4Test_14
   \   0001AF   A3           INC     DPTR
   \   0001B0   E0           MOVX    A,@DPTR
   \   0001B1   69           XRL     A,R1
   \                     ??irCodeRx4Test_14:
   \   0001B2   7003         JNZ     $+5
   \   0001B4   02....       LJMP    ??irCodeRx4Test_2 & 0xFFFF
    189          				{
    190          					//保存 EdgeTimeSlot 和 EdgeTimeSlot_L 至NV
    191          					EdgeTimeSlot_LR[edgeCnt_temp] = EdgeTimeSlot_LRsl;
   \   0001B7   90....       MOV     DPTR,#EdgeTimeSlot_LRsl
   \   0001BA   E0           MOVX    A,@DPTR
   \   0001BB   FA           MOV     R2,A
   \   0001BC   A3           INC     DPTR
   \   0001BD   E0           MOVX    A,@DPTR
   \   0001BE   FB           MOV     R3,A
   \   0001BF   90....       MOV     DPTR,#edgeCnt_temp
   \   0001C2   E0           MOVX    A,@DPTR
   \   0001C3   F8           MOV     R0,A
   \   0001C4   A3           INC     DPTR
   \   0001C5   E0           MOVX    A,@DPTR
   \   0001C6   F9           MOV     R1,A
   \   0001C7   E8           MOV     A,R0
   \   0001C8   75F002       MOV     B,#0x2
   \   0001CB   A4           MUL     AB
   \   0001CC   C8           XCH     A,R0
   \   0001CD   ACF0         MOV     R4,B
   \   0001CF   75F000       MOV     B,#0x0
   \   0001D2   A4           MUL     AB
   \   0001D3   2C           ADD     A,R4
   \   0001D4   FC           MOV     R4,A
   \   0001D5   75F002       MOV     B,#0x2
   \   0001D8   E9           MOV     A,R1
   \   0001D9   A4           MUL     AB
   \   0001DA   2C           ADD     A,R4
   \   0001DB   F9           MOV     R1,A
   \   0001DC   74..         MOV     A,#EdgeTimeSlot_LR & 0xff
   \   0001DE   28           ADD     A,R0
   \   0001DF   F582         MOV     DPL,A
   \   0001E1   74..         MOV     A,#(EdgeTimeSlot_LR >> 8) & 0xff
   \   0001E3   39           ADDC    A,R1
   \   0001E4   F583         MOV     DPH,A
   \   0001E6   EA           MOV     A,R2
   \   0001E7   F0           MOVX    @DPTR,A
   \   0001E8   A3           INC     DPTR
   \   0001E9   EB           MOV     A,R3
   \   0001EA   F0           MOVX    @DPTR,A
    192          					edgeCnt_temp = edgeCnt;
   \   0001EB   90....       MOV     DPTR,#edgeCnt
   \   0001EE   E0           MOVX    A,@DPTR
   \   0001EF   F8           MOV     R0,A
   \   0001F0   A3           INC     DPTR
   \   0001F1   E0           MOVX    A,@DPTR
   \   0001F2   F9           MOV     R1,A
   \   0001F3   90....       MOV     DPTR,#edgeCnt_temp
   \   0001F6   E8           MOV     A,R0
   \   0001F7   F0           MOVX    @DPTR,A
   \   0001F8   A3           INC     DPTR
   \   0001F9   E9           MOV     A,R1
   \   0001FA   F0           MOVX    @DPTR,A
   \   0001FB   02....       LJMP    ??irCodeRx4Test_2 & 0xFFFF
    193          					
    194          				}
    195          			}
    196          		}
    197          	}
   \                     ??irCodeRx4Test_7:
   \   0001FE   7F02         MOV     R7,#0x2
   \   000200   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000203                REQUIRE _A_P1
   \   000203                REQUIRE T3CCTL1
   \   000203                REQUIRE T3CTL
   \   000203                REQUIRE T4CTL
    198          }
    199          
    200          //把数据发回去

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    201          void irCodeTx4Test(void)
   \                     irCodeTx4Test:
    202          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    203              uint16 i;
    204          
    205              for(i= 0 ;i<10;i++)
   \   000004   7800         MOV     R0,#0x0
   \   000006   7900         MOV     R1,#0x0
   \                     ??irCodeTx4Test_0:
   \   000008   C3           CLR     C
   \   000009   E8           MOV     A,R0
   \   00000A   940A         SUBB    A,#0xa
   \   00000C   E9           MOV     A,R1
   \   00000D   9400         SUBB    A,#0x0
   \   00000F   5041         JNC     ??irCodeTx4Test_1
    206              {
    207                EdgeTimeSlot_LR[i] = 200;
   \   000011   E8           MOV     A,R0
   \   000012   FA           MOV     R2,A
   \   000013   E9           MOV     A,R1
   \   000014   FB           MOV     R3,A
   \   000015   EA           MOV     A,R2
   \   000016   75F002       MOV     B,#0x2
   \   000019   A4           MUL     AB
   \   00001A   CA           XCH     A,R2
   \   00001B   ACF0         MOV     R4,B
   \   00001D   75F000       MOV     B,#0x0
   \   000020   A4           MUL     AB
   \   000021   2C           ADD     A,R4
   \   000022   FC           MOV     R4,A
   \   000023   75F002       MOV     B,#0x2
   \   000026   EB           MOV     A,R3
   \   000027   A4           MUL     AB
   \   000028   2C           ADD     A,R4
   \   000029   FB           MOV     R3,A
   \   00002A   74..         MOV     A,#EdgeTimeSlot_LR & 0xff
   \   00002C   2A           ADD     A,R2
   \   00002D   F582         MOV     DPL,A
   \   00002F   74..         MOV     A,#(EdgeTimeSlot_LR >> 8) & 0xff
   \   000031   3B           ADDC    A,R3
   \   000032   F583         MOV     DPH,A
   \   000034   74C8         MOV     A,#-0x38
   \   000036   F0           MOVX    @DPTR,A
   \   000037   A3           INC     DPTR
   \   000038   7400         MOV     A,#0x0
   \   00003A   F0           MOVX    @DPTR,A
    208                EdgeTimeSlot_HR[i] = 5;
   \   00003B   74..         MOV     A,#EdgeTimeSlot_HR & 0xff
   \   00003D   28           ADD     A,R0
   \   00003E   F582         MOV     DPL,A
   \   000040   74..         MOV     A,#(EdgeTimeSlot_HR >> 8) & 0xff
   \   000042   39           ADDC    A,R1
   \   000043   F583         MOV     DPH,A
   \   000045   7405         MOV     A,#0x5
   \   000047   F0           MOVX    @DPTR,A
    209              }
   \   000048   E8           MOV     A,R0
   \   000049   2401         ADD     A,#0x1
   \   00004B   F8           MOV     R0,A
   \   00004C   E9           MOV     A,R1
   \   00004D   3400         ADDC    A,#0x0
   \   00004F   F9           MOV     R1,A
   \   000050   80B6         SJMP    ??irCodeTx4Test_0
    210              edgeNum = 10;
   \                     ??irCodeTx4Test_1:
   \   000052   90....       MOV     DPTR,#edgeNum
   \   000055   740A         MOV     A,#0xa
   \   000057   F0           MOVX    @DPTR,A
   \   000058   A3           INC     DPTR
   \   000059   7400         MOV     A,#0x0
   \   00005B   F0           MOVX    @DPTR,A
    211              T3CCTL0 = 0x04;     //0x14--比较输出，0->104 时翻转比较输出引脚 产生38K载波
   \   00005C   75CC04       MOV     0xcc,#0x4
    212          						//0x04 比较输出引脚 输出高电平
    213              TIMER3_START(1);       //启动T3,
   \   00005F   43CB10       ORL     0xcb,#0x10
    214              TIMER34_START(4,1);    //启动T4,
   \   000062   43EB10       ORL     0xeb,#0x10
    215          	for(edgeCnt = 0; edgeCnt < edgeNum; edgeCnt++)
   \   000065   90....       MOV     DPTR,#edgeCnt
   \   000068   7400         MOV     A,#0x0
   \   00006A   F0           MOVX    @DPTR,A
   \   00006B   A3           INC     DPTR
   \   00006C   7400         MOV     A,#0x0
   \   00006E   F0           MOVX    @DPTR,A
   \                     ??irCodeTx4Test_2:
   \   00006F   90....       MOV     DPTR,#edgeCnt
   \   000072   C082         PUSH    DPL
   \   000074   C083         PUSH    DPH
   \   000076   90....       MOV     DPTR,#edgeNum
   \   000079   E0           MOVX    A,@DPTR
   \   00007A   FA           MOV     R2,A
   \   00007B   A3           INC     DPTR
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   FB           MOV     R3,A
   \   00007E   D083         POP     DPH
   \   000080   D082         POP     DPL
   \   000082   C3           CLR     C
   \   000083   E0           MOVX    A,@DPTR
   \   000084   9A           SUBB    A,R2
   \   000085   A3           INC     DPTR
   \   000086   E0           MOVX    A,@DPTR
   \   000087   9B           SUBB    A,R3
   \   000088   506E         JNC     ??irCodeTx4Test_3
    216          	{
    217          		us10Cnt = EdgeTimeSlot_LR[edgeCnt];
   \   00008A   90....       MOV     DPTR,#edgeCnt
   \   00008D   E0           MOVX    A,@DPTR
   \   00008E   FA           MOV     R2,A
   \   00008F   A3           INC     DPTR
   \   000090   E0           MOVX    A,@DPTR
   \   000091   FB           MOV     R3,A
   \   000092   EA           MOV     A,R2
   \   000093   75F002       MOV     B,#0x2
   \   000096   A4           MUL     AB
   \   000097   CA           XCH     A,R2
   \   000098   ACF0         MOV     R4,B
   \   00009A   75F000       MOV     B,#0x0
   \   00009D   A4           MUL     AB
   \   00009E   2C           ADD     A,R4
   \   00009F   FC           MOV     R4,A
   \   0000A0   75F002       MOV     B,#0x2
   \   0000A3   EB           MOV     A,R3
   \   0000A4   A4           MUL     AB
   \   0000A5   2C           ADD     A,R4
   \   0000A6   FB           MOV     R3,A
   \   0000A7   74..         MOV     A,#EdgeTimeSlot_LR & 0xff
   \   0000A9   2A           ADD     A,R2
   \   0000AA   F582         MOV     DPL,A
   \   0000AC   74..         MOV     A,#(EdgeTimeSlot_LR >> 8) & 0xff
   \   0000AE   3B           ADDC    A,R3
   \   0000AF   F583         MOV     DPH,A
   \   0000B1   E0           MOVX    A,@DPTR
   \   0000B2   FA           MOV     R2,A
   \   0000B3   A3           INC     DPTR
   \   0000B4   E0           MOVX    A,@DPTR
   \   0000B5   FB           MOV     R3,A
   \   0000B6   90....       MOV     DPTR,#us10Cnt
   \   0000B9   EA           MOV     A,R2
   \   0000BA   F0           MOVX    @DPTR,A
   \   0000BB   A3           INC     DPTR
   \   0000BC   EB           MOV     A,R3
   \   0000BD   F0           MOVX    @DPTR,A
    218          		if(edgeCnt % 2)
   \   0000BE   90....       MOV     DPTR,#edgeCnt
   \   0000C1   E0           MOVX    A,@DPTR
   \   0000C2   FA           MOV     R2,A
   \   0000C3   A3           INC     DPTR
   \   0000C4   E0           MOVX    A,@DPTR
   \   0000C5   FB           MOV     R3,A
   \   0000C6   EA           MOV     A,R2
   \   0000C7   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000C9   5005         JNC     ??irCodeTx4Test_4
    219          		{
    220          			T3CCTL0 = 0x14;		//0x14--比较输出，0->105->0 时翻转比较输出引脚 
   \   0000CB   75CC14       MOV     0xcc,#0x14
   \   0000CE   8003         SJMP    ??irCodeTx4Test_5
    221          			//0x04 比较输出引脚 输出高电平
    222          		}
    223          		else
    224          		{
    225          			T3CCTL0 = 0x04;		//0x14--比较输出，0->105->0 时翻转比较输出引脚 
   \                     ??irCodeTx4Test_4:
   \   0000D0   75CC04       MOV     0xcc,#0x4
    226          			//0x04 比较输出引脚 输出高电平
    227          		}
    228          		//T4CTL |= 0x04;    //清零counter
    229          		//read us10Cnt from NV
    230          		
    231          		//while(us10Cnt);
    232          		//T4CTL |= 0x04;    //清零counter
    233          		//T4CC0 = 100 - EdgeTimeSlot_L[i];
    234          		//EdgeTimeSlot_HRsl = EdgeTimeSlot_HR[i];
    235          		singleEdgeEndFlag = 0;
   \                     ??irCodeTx4Test_5:
   \   0000D3   90....       MOV     DPTR,#singleEdgeEndFlag
   \   0000D6   7400         MOV     A,#0x0
   \   0000D8   F0           MOVX    @DPTR,A
    236                          P1_1 = ~P1_1;
   \   0000D9   D2F0         SETB    B.0
   \   0000DB   A291         MOV     C,0x90.1
   \   0000DD   30F001       JNB     B.0,??irCodeTx4Test_6
   \   0000E0   B3           CPL     C
   \                     ??irCodeTx4Test_6:
   \   0000E1   9291         MOV     0x90.1,C
    237          		while(!singleEdgeEndFlag);
   \                     ??irCodeTx4Test_7:
   \   0000E3   90....       MOV     DPTR,#singleEdgeEndFlag
   \   0000E6   E0           MOVX    A,@DPTR
   \   0000E7   60FA         JZ      ??irCodeTx4Test_7
    238          		
    239          	}
   \   0000E9   90....       MOV     DPTR,#edgeCnt
   \   0000EC   E0           MOVX    A,@DPTR
   \   0000ED   2401         ADD     A,#0x1
   \   0000EF   F0           MOVX    @DPTR,A
   \   0000F0   A3           INC     DPTR
   \   0000F1   E0           MOVX    A,@DPTR
   \   0000F2   3400         ADDC    A,#0x0
   \   0000F4   F0           MOVX    @DPTR,A
   \   0000F5   02....       LJMP    ??irCodeTx4Test_2 & 0xFFFF
    240          	TIMER34_START(4,0);    //关闭T4,
   \                     ??irCodeTx4Test_3:
   \   0000F8   53EBEF       ANL     0xeb,#0xef
    241          	TIMER3_START(0);       //关闭T3,
   \   0000FB   53CBEF       ANL     0xcb,#0xef
    242          	T3CCTL0 = 0;		//0x14--比较输出，0->105 时翻转比较输出引脚
   \   0000FE   75CC00       MOV     0xcc,#0x0
    243          	irCodeTxFlag = 0;
   \   000101   90....       MOV     DPTR,#irCodeTxFlag
   \   000104   7400         MOV     A,#0x0
   \   000106   F0           MOVX    @DPTR,A
    244                  P1_1 = 1;//off led
   \   000107   D291         SETB    0x90.1
    245          }
   \   000109   D083         POP     DPH
   \   00010B   D082         POP     DPL
   \   00010D   02....       LJMP    ?BRET
   \   000110                REQUIRE T3CCTL0
   \   000110                REQUIRE T3CTL
   \   000110                REQUIRE T4CTL
   \   000110                REQUIRE _A_P1
    246          
    247          //测试flash读写

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    248          void flashTest(void)
   \                     flashTest:
    249          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 20
   \   000005   74EC         MOV     A,#-0x14
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    250            uint8 m25p16_wrBuff[20] = {1,2,3,4,5,6,7,8,9,10};
   \   00000A   90....       MOV     DPTR,#`?<Constant {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}>`
   \   00000D   C082         PUSH    DPL
   \   00000F   C083         PUSH    DPH
   \   000011   85..82       MOV     DPL,?XSP + 0
   \   000014   85..83       MOV     DPH,?XSP + 1
   \   000017   AC82         MOV     R4,DPL
   \   000019   AD83         MOV     R5,DPH
   \   00001B   D083         POP     DPH
   \   00001D   D082         POP     DPL
   \   00001F   7414         MOV     A,#0x14
   \   000021   12....       LCALL   ?MOVE_LONG8_XDATA_XDATA
    251            uint8 i;
    252            //判断ID是否正确
    253            Hal_SPI_Init();
   \   000024                ; Setup parameters for call to function Hal_SPI_Init
   \   000024   12....       LCALL   ??Hal_SPI_Init?relay
    254            m25p16_wakeUP(); //唤醒m25p16，
   \   000027                ; Setup parameters for call to function m25p16_wakeUP
   \   000027   12....       LCALL   ??m25p16_wakeUP?relay
    255            m25p16_beWIP();
   \   00002A                ; Setup parameters for call to function m25p16_beWIP
   \   00002A   12....       LCALL   ??m25p16_beWIP?relay
    256            m25p16_readID();
   \   00002D                ; Setup parameters for call to function m25p16_readID
   \   00002D   12....       LCALL   ??m25p16_readID?relay
    257            if((m25p16_ID[0] == 0)&&
    258              (m25p16_ID[1] == 0x20)&&
    259                (m25p16_ID[2] == 0x20)&&
    260                  (m25p16_ID[3] == 0x15))
   \   000030   90....       MOV     DPTR,#m25p16_ID
   \   000033   E0           MOVX    A,@DPTR
   \   000034   7018         JNZ     ??flashTest_0
   \   000036   90....       MOV     DPTR,#m25p16_ID + 1
   \   000039   E0           MOVX    A,@DPTR
   \   00003A   6420         XRL     A,#0x20
   \   00003C   7010         JNZ     ??flashTest_0
   \   00003E   90....       MOV     DPTR,#m25p16_ID + 2
   \   000041   E0           MOVX    A,@DPTR
   \   000042   6420         XRL     A,#0x20
   \   000044   7008         JNZ     ??flashTest_0
   \   000046   90....       MOV     DPTR,#m25p16_ID + 3
   \   000049   E0           MOVX    A,@DPTR
   \   00004A   6415         XRL     A,#0x15
   \   00004C   6004         JZ      ??flashTest_1
    261            {
    262          
    263            }
    264            else
    265            {
    266              //ID不对
    267              P1_1 = 0;//亮红灯
   \                     ??flashTest_0:
   \   00004E   C291         CLR     0x90.1
    268              while(1);
   \                     ??flashTest_2:
   \   000050   80FE         SJMP    ??flashTest_2
    269            }
    270            //读写操作是否OK
    271            m25p16_beWIP();
   \                     ??flashTest_1:
   \   000052                ; Setup parameters for call to function m25p16_beWIP
   \   000052   12....       LCALL   ??m25p16_beWIP?relay
    272            m25p16_writeEnable();
   \   000055                ; Setup parameters for call to function m25p16_writeEnable
   \   000055   12....       LCALL   ??m25p16_writeEnable?relay
    273            m25p16_sectorErase(0,0,0);//擦除第0扇区
   \   000058                ; Setup parameters for call to function m25p16_sectorErase
   \   000058   7B00         MOV     R3,#0x0
   \   00005A   7A00         MOV     R2,#0x0
   \   00005C   7900         MOV     R1,#0x0
   \   00005E   12....       LCALL   ??m25p16_sectorErase?relay
    274            
    275            m25p16_beWIP();
   \   000061                ; Setup parameters for call to function m25p16_beWIP
   \   000061   12....       LCALL   ??m25p16_beWIP?relay
    276            m25p16_writeEnable();
   \   000064                ; Setup parameters for call to function m25p16_writeEnable
   \   000064   12....       LCALL   ??m25p16_writeEnable?relay
    277            m25p16_pageProgram(0,0,0x00,(uint8 *)&(m25p16_wrBuff),10);//写0三区 0页 第0字节 ，写10个
   \   000067                ; Setup parameters for call to function m25p16_pageProgram
   \   000067   75..0A       MOV     ?V0 + 0,#0xa
   \   00006A   75..00       MOV     ?V0 + 1,#0x0
   \   00006D   78..         MOV     R0,#?V0 + 0
   \   00006F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000072   7402         MOV     A,#0x2
   \   000074   12....       LCALL   ?XSTACK_DISP0_8
   \   000077   AC82         MOV     R4,DPL
   \   000079   AD83         MOV     R5,DPH
   \   00007B   7B00         MOV     R3,#0x0
   \   00007D   7A00         MOV     R2,#0x0
   \   00007F   7900         MOV     R1,#0x0
   \   000081   12....       LCALL   ??m25p16_pageProgram?relay
   \   000084   7402         MOV     A,#0x2
   \   000086   12....       LCALL   ?DEALLOC_XSTACK8
    278            
    279            //clear buff
    280            for(i = 0;i < 10;i++)
   \   000089   7E00         MOV     R6,#0x0
   \                     ??flashTest_3:
   \   00008B   EE           MOV     A,R6
   \   00008C   C3           CLR     C
   \   00008D   940A         SUBB    A,#0xa
   \   00008F   501D         JNC     ??flashTest_4
    281              m25p16_wrBuff[i] = 0;
   \   000091   8E..         MOV     ?V0 + 0,R6
   \   000093   75..00       MOV     ?V0 + 1,#0x0
   \   000096   85..82       MOV     DPL,?XSP + 0
   \   000099   85..83       MOV     DPH,?XSP + 1
   \   00009C   E582         MOV     A,DPL
   \   00009E   25..         ADD     A,?V0 + 0
   \   0000A0   F582         MOV     DPL,A
   \   0000A2   E583         MOV     A,DPH
   \   0000A4   35..         ADDC    A,?V0 + 1
   \   0000A6   F583         MOV     DPH,A
   \   0000A8   7400         MOV     A,#0x0
   \   0000AA   F0           MOVX    @DPTR,A
   \   0000AB   0E           INC     R6
   \   0000AC   80DD         SJMP    ??flashTest_3
    282            
    283            //读出写入的数据
    284            m25p16_beWIP();
   \                     ??flashTest_4:
   \   0000AE                ; Setup parameters for call to function m25p16_beWIP
   \   0000AE   12....       LCALL   ??m25p16_beWIP?relay
    285            m25p16_readData(0,0,0x00,(uint8 *)&(m25p16_wrBuff),10);
   \   0000B1                ; Setup parameters for call to function m25p16_readData
   \   0000B1   75..0A       MOV     ?V0 + 0,#0xa
   \   0000B4   75..00       MOV     ?V0 + 1,#0x0
   \   0000B7   78..         MOV     R0,#?V0 + 0
   \   0000B9   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000BC   7402         MOV     A,#0x2
   \   0000BE   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C1   AC82         MOV     R4,DPL
   \   0000C3   AD83         MOV     R5,DPH
   \   0000C5   7B00         MOV     R3,#0x0
   \   0000C7   7A00         MOV     R2,#0x0
   \   0000C9   7900         MOV     R1,#0x0
   \   0000CB   12....       LCALL   ??m25p16_readData?relay
   \   0000CE   7402         MOV     A,#0x2
   \   0000D0   12....       LCALL   ?DEALLOC_XSTACK8
    286            
    287            //对比数据
    288            for(i = 0;i < 10;i++)
   \   0000D3   7E00         MOV     R6,#0x0
   \                     ??flashTest_5:
   \   0000D5   EE           MOV     A,R6
   \   0000D6   C3           CLR     C
   \   0000D7   940A         SUBB    A,#0xa
   \   0000D9   5039         JNC     ??flashTest_6
    289            {
    290              if(m25p16_wrBuff[i] == i + 1)
   \   0000DB   8E..         MOV     ?V0 + 0,R6
   \   0000DD   75..00       MOV     ?V0 + 1,#0x0
   \   0000E0   85..82       MOV     DPL,?XSP + 0
   \   0000E3   85..83       MOV     DPH,?XSP + 1
   \   0000E6   E582         MOV     A,DPL
   \   0000E8   25..         ADD     A,?V0 + 0
   \   0000EA   F582         MOV     DPL,A
   \   0000EC   E583         MOV     A,DPH
   \   0000EE   35..         ADDC    A,?V0 + 1
   \   0000F0   F583         MOV     DPH,A
   \   0000F2   E0           MOVX    A,@DPTR
   \   0000F3   FA           MOV     R2,A
   \   0000F4   7B00         MOV     R3,#0x0
   \   0000F6   8E..         MOV     ?V0 + 0,R6
   \   0000F8   75..00       MOV     ?V0 + 1,#0x0
   \   0000FB   E5..         MOV     A,?V0 + 0
   \   0000FD   2401         ADD     A,#0x1
   \   0000FF   F8           MOV     R0,A
   \   000100   E5..         MOV     A,?V0 + 1
   \   000102   3400         ADDC    A,#0x0
   \   000104   F9           MOV     R1,A
   \   000105   E8           MOV     A,R0
   \   000106   6A           XRL     A,R2
   \   000107   7002         JNZ     ??flashTest_7
   \   000109   E9           MOV     A,R1
   \   00010A   6B           XRL     A,R3
   \                     ??flashTest_7:
   \   00010B   6004         JZ      ??flashTest_8
    291              {
    292                
    293              }
    294              else
    295              {
    296                //flash fail
    297                P1_1 = 0;//亮红灯
   \   00010D   C291         CLR     0x90.1
    298                while(1);
   \                     ??flashTest_9:
   \   00010F   80FE         SJMP    ??flashTest_9
    299              }
    300            }
   \                     ??flashTest_8:
   \   000111   0E           INC     R6
   \   000112   80C1         SJMP    ??flashTest_5
    301            
    302          //读写OK，清flash  
    303            //但不能改写，只能擦除扇区，插0扇区
    304            m25p16_beWIP();
   \                     ??flashTest_6:
   \   000114                ; Setup parameters for call to function m25p16_beWIP
   \   000114   12....       LCALL   ??m25p16_beWIP?relay
    305            m25p16_writeEnable();
   \   000117                ; Setup parameters for call to function m25p16_writeEnable
   \   000117   12....       LCALL   ??m25p16_writeEnable?relay
    306            m25p16_sectorErase(0,0,0);//擦除第0扇区
   \   00011A                ; Setup parameters for call to function m25p16_sectorErase
   \   00011A   7B00         MOV     R3,#0x0
   \   00011C   7A00         MOV     R2,#0x0
   \   00011E   7900         MOV     R1,#0x0
   \   000120   12....       LCALL   ??m25p16_sectorErase?relay
    307            
    308            m25p16_beWIP();
   \   000123                ; Setup parameters for call to function m25p16_beWIP
   \   000123   12....       LCALL   ??m25p16_beWIP?relay
    309            m25p16_readData(0,0,0x00,(uint8 *)&(m25p16_wrBuff),20);//多读10个来判断，看是否被擦除
   \   000126                ; Setup parameters for call to function m25p16_readData
   \   000126   75..14       MOV     ?V0 + 0,#0x14
   \   000129   75..00       MOV     ?V0 + 1,#0x0
   \   00012C   78..         MOV     R0,#?V0 + 0
   \   00012E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000131   7402         MOV     A,#0x2
   \   000133   12....       LCALL   ?XSTACK_DISP0_8
   \   000136   AC82         MOV     R4,DPL
   \   000138   AD83         MOV     R5,DPH
   \   00013A   7B00         MOV     R3,#0x0
   \   00013C   7A00         MOV     R2,#0x0
   \   00013E   7900         MOV     R1,#0x0
   \   000140   12....       LCALL   ??m25p16_readData?relay
   \   000143   7402         MOV     A,#0x2
   \   000145   12....       LCALL   ?DEALLOC_XSTACK8
    310            
    311            for(i = 0;i < 20;i++)
   \   000148   7E00         MOV     R6,#0x0
   \                     ??flashTest_10:
   \   00014A   EE           MOV     A,R6
   \   00014B   C3           CLR     C
   \   00014C   9414         SUBB    A,#0x14
   \   00014E   5023         JNC     ??flashTest_11
    312            {
    313              if(m25p16_wrBuff[i] == 0xFF)
   \   000150   8E..         MOV     ?V0 + 0,R6
   \   000152   75..00       MOV     ?V0 + 1,#0x0
   \   000155   85..82       MOV     DPL,?XSP + 0
   \   000158   85..83       MOV     DPH,?XSP + 1
   \   00015B   E582         MOV     A,DPL
   \   00015D   25..         ADD     A,?V0 + 0
   \   00015F   F582         MOV     DPL,A
   \   000161   E583         MOV     A,DPH
   \   000163   35..         ADDC    A,?V0 + 1
   \   000165   F583         MOV     DPH,A
   \   000167   E0           MOVX    A,@DPTR
   \   000168   64FF         XRL     A,#0xff
   \   00016A   6004         JZ      ??flashTest_12
    314              {
    315                
    316              }
    317              else
    318              {
    319                //flash fail
    320                P1_1 = 0;//亮红灯
   \   00016C   C291         CLR     0x90.1
    321                while(1);
   \                     ??flashTest_13:
   \   00016E   80FE         SJMP    ??flashTest_13
    322              }
    323            }
   \                     ??flashTest_12:
   \   000170   0E           INC     R6
   \   000171   80D7         SJMP    ??flashTest_10
    324            //pass
    325            m25p16_beWIP();
   \                     ??flashTest_11:
   \   000173                ; Setup parameters for call to function m25p16_beWIP
   \   000173   12....       LCALL   ??m25p16_beWIP?relay
    326            m25p16_deepPowerDown();//m25p16睡眠
   \   000176                ; Setup parameters for call to function m25p16_deepPowerDown
   \   000176   12....       LCALL   ??m25p16_deepPowerDown?relay
    327            powerDown();//2530 外设关闭
   \   000179                ; Setup parameters for call to function powerDown
   \   000179   12....       LCALL   ??powerDown?relay
    328            
    329          }
   \   00017C   7414         MOV     A,#0x14
   \   00017E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000181   7F02         MOV     R7,#0x2
   \   000183   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000186                REQUIRE _A_P1

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??irCodeRx4Test?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    irCodeRx4Test

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??irCodeTx4Test?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    irCodeTx4Test

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??flashTest?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    flashTest

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}>`:
   \   000000   01           DB 1
   \   000001   02           DB 2
   \   000002   03           DB 3
   \   000003   04           DB 4
   \   000004   05           DB 5
   \   000005   06           DB 6
   \   000006   07           DB 7
   \   000007   08           DB 8
   \   000008   09           DB 9
   \   000009   0A           DB 10
   \   00000A   00000000     DB 0, 0, 0, 0, 0, 0, 0, 0
   \            00000000
   \   000012   0000         DB 0, 0

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_fde8:
   \   000000   E8FD0000     DD 65000

   Maximum stack usage in bytes:

     Function                  ISTACK PSTACK XSTACK
     --------                  ------ ------ ------
     flashTest                     2      0     32
       -> Hal_SPI_Init             0      0     60
       -> m25p16_wakeUP            0      0     60
       -> m25p16_beWIP             0      0     60
       -> m25p16_readID            0      0     60
       -> m25p16_beWIP             0      0     60
       -> m25p16_writeEnable       0      0     60
       -> m25p16_sectorErase       0      0     60
       -> m25p16_beWIP             0      0     60
       -> m25p16_writeEnable       0      0     60
       -> m25p16_pageProgram       0      0     64
       -> m25p16_beWIP             0      0     60
       -> m25p16_readData          0      0     64
       -> m25p16_beWIP             0      0     60
       -> m25p16_writeEnable       0      0     60
       -> m25p16_sectorErase       0      0     60
       -> m25p16_beWIP             0      0     60
       -> m25p16_readData          0      0     64
       -> m25p16_beWIP             0      0     60
       -> m25p16_deepPowerDown     0      0     60
       -> powerDown                0      0     60
     irCodeRx4Test                 0      0     10
       -> Delay_1u_test            0      0     20
     irCodeTx4Test                 4      0      0


   Segment part sizes:

     Function/Label                              Bytes
     --------------                              -----
     _A_P1                                          1
     T3CTL                                          1
     T3CCTL0                                        1
     T3CCTL1                                        1
     T4CTL                                          1
     irCodeRx4Test                                515
     irCodeTx4Test                                272
     flashTest                                    390
     ??irCodeRx4Test?relay                          6
     ??irCodeTx4Test?relay                          6
     ??flashTest?relay                              6
     ?<Constant {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}>   20
     __Constant_fde8                                4

 
 1 177 bytes in segment BANKED_CODE
    18 bytes in segment BANK_RELAYS
     5 bytes in segment SFR_AN
    24 bytes in segment XDATA_ROM_C
 
 1 195 bytes of CODE  memory
    20 bytes of CONST memory (+ 4 bytes shared)
     0 bytes of DATA  memory (+ 5 bytes shared)

Errors: none
Warnings: 1
