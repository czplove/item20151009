###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         05/Nov/2015  09:29:42 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251) #
#                          -14-12-8\Projects\zstack\Samples\SampleApp\Source\ #
#                          DOOR_BELL_BUTTON\DOOR_BELL_BUTTON_User_app.c       #
#    Command line       =  -f "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP( #
#                          251)-14-12-8\Projects\zstack\Samples\SampleApp\CC2 #
#                          530DB\..\..\..\Tools\CC2530DB\f8wEndev.cfg"        #
#                          (-DCPU32MHZ -DROOT=__near_func                     #
#                          -DMAC_CFG_TX_DATA_MAX=3 -DMAC_CFG_TX_MAX=6         #
#                          -DMAC_CFG_RX_MAX=3) -f "F:\2015\公司产品管理\志富\ #
#                          RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstack\S #
#                          amples\SampleApp\CC2530DB\..\..\..\Tools\CC2530DB\ #
#                          f8wConfig.cfg" (-DZIGBEEPRO -DSECURE=1             #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=60            #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=30           #
#                          -DNWK_MAX_BINDING_ENTRIES=10                       #
#                          -DMAX_BINDING_CLUSTER_IDS=4 -DASSERT_RESET         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=8000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=1000)  #
#                          -DREJOIN_POLL_RATE=440 "F:\2015\公司产品管理\志富\ #
#                          RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstack\S #
#                          amples\SampleApp\Source\DOOR_BELL_BUTTON\DOOR_BELL #
#                          _BUTTON_User_app.c" -D NV_INIT -D NV_RESTORE -D    #
#                          HOLD_AUTO_START -D MT_TASK -D xMT_APP_FUNC -D      #
#                          MT_SYS_FUNC -D MT_ZDO_FUNC -D xMT_ZDO_MGMT -D      #
#                          ISR_KEYINTERRUPT -D POWER_SAVING -D                #
#                          xLONG_POLL_TIMES -D xHAVE_TEST_FUN -D              #
#                          RESUME_TIME_TEST -D xDOOR_BELL_BUTTON -D BELL -D   #
#                          xM_V332 -D ASSERT_RESET -D WDT_IN_PM1 -lC          #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\DOOR_BELL_BUTTON\List\" -lA                     #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\DOOR_BELL_BUTTON\List\" --diag_suppress         #
#                          Pe001,Pa010 -o "F:\2015\公司产品管理\志富\RE_1_2_0 #
#                          _FORMAL_APP(251)-14-12-8\Projects\zstack\Samples\S #
#                          ampleApp\CC2530DB\DOOR_BELL_BUTTON\Obj\" -e        #
#                          --no_cse --no_unroll --no_inline --no_code_motion  #
#                          --no_tbaa --debug --core=plain --dptr=16,1         #
#                          --data_model=large --code_model=banked             #
#                          --calling_convention=xdata_reentrant               #
#                          --place_constants=data_rom --nr_virtual_regs 16    #
#                          -I "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP( #
#                          251)-14-12-8\Projects\zstack\Samples\SampleApp\CC2 #
#                          530DB\" -I "F:\2015\公司产品管理\志富\RE_1_2_0_FOR #
#                          MAL_APP(251)-14-12-8\Projects\zstack\Samples\Sampl #
#                          eApp\CC2530DB\..\Source\" -I                       #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\Source\rssi_test\h\" -I                      #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\Source\DOOR_BELL_BUTTON\" -I                 #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\ZMain\TI2530DB\" -I                    #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\hal\include\" -I      #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\hal\target\CC2530EB\" #
#                           -I "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP #
#                          (251)-14-12-8\Projects\zstack\Samples\SampleApp\CC #
#                          2530DB\..\..\..\..\..\Components\mac\include\" -I  #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\mac\high_level\" -I   #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\mac\low_level\srf04\" #
#                           -I "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP #
#                          (251)-14-12-8\Projects\zstack\Samples\SampleApp\CC #
#                          2530DB\..\..\..\..\..\Components\mac\low_level\srf #
#                          04\single_chip\" -I "F:\2015\公司产品管理\志富\RE_ #
#                          1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstack\Samp #
#                          les\SampleApp\CC2530DB\..\..\..\..\..\Components\m #
#                          t\" -I "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_ #
#                          APP(251)-14-12-8\Projects\zstack\Samples\SampleApp #
#                          \CC2530DB\..\..\..\..\..\Components\osal\include\" #
#                           -I "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP #
#                          (251)-14-12-8\Projects\zstack\Samples\SampleApp\CC #
#                          2530DB\..\..\..\..\..\Components\services\saddr\"  #
#                          -I "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP( #
#                          251)-14-12-8\Projects\zstack\Samples\SampleApp\CC2 #
#                          530DB\..\..\..\..\..\Components\services\sdata\"   #
#                          -I "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP( #
#                          251)-14-12-8\Projects\zstack\Samples\SampleApp\CC2 #
#                          530DB\..\..\..\..\..\Components\stack\af\" -I      #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\stack\nwk\" -I        #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\stack\sapi\" -I       #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\stack\sec\" -I        #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\stack\sys\" -I        #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\stack\zdo\" -I        #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\zmac\" -I             #
#                          "F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\zmac\f8w\" -On        #
#                          --require_prototypes                               #
#    List file          =  F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251) #
#                          -14-12-8\Projects\zstack\Samples\SampleApp\CC2530D #
#                          B\DOOR_BELL_BUTTON\List\DOOR_BELL_BUTTON_User_app. #
#                          lst                                                #
#    Object file        =  F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251) #
#                          -14-12-8\Projects\zstack\Samples\SampleApp\CC2530D #
#                          B\DOOR_BELL_BUTTON\Obj\DOOR_BELL_BUTTON_User_app.r #
#                          51                                                 #
#                                                                             #
#                                                                             #
###############################################################################

F:\2015\公司产品管理\志富\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstack\Samples\SampleApp\Source\DOOR_BELL_BUTTON\DOOR_BELL_BUTTON_User_app.c
      1          /**************************************************************************************************
      2            Filename:       SampleApp.c
      3            Revised:        $Date: 2007-10-27 17:16:54 -0700 (Sat, 27 Oct 2007) $
      4            Revision:       $Revision: 15793 $
      5          
      6            Description:    Sample Application (no Profile).
      7          
      8          
      9            Copyright 2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41            This application isn't intended to do anything useful, it is
     42            intended to be a simple example of an application's structure.
     43          
     44            This application sends it's messages either as broadcast or
     45            broadcast filtered group messages.  The other (more normal)
     46            message addressing is unicast.  Most of the other sample
     47            applications are written to support the unicast message model.
     48          
     49            Key control:
     50              SW1:  Sends a flash command to all devices in Group 1.
     51              SW2:  Adds/Removes (toggles) this device in and out
     52                    of Group 1.  This will enable and disable the
     53                    reception of the flash command.
     54          *********************************************************************/
     55          
     56          /*********************************************************************
     57           * INCLUDES
     58           */
     59          
     60          
     61          
     62          
     63          #include "OSAL.h"
     64          #include "ZGlobals.h"
     65          #include "AF.h"
     66          #include "aps_groups.h"
     67          #include "ZDApp.h"
     68          #include "device.h"
     69          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0x80
   \   union <unnamed> volatile __sfr _A_P0
   \                     _A_P0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x8f
   \   unsigned char volatile __sfr P0INP
   \                     P0INP:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf6
   \   unsigned char volatile __sfr P1INP
   \                     P1INP:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfd
   \   unsigned char volatile __sfr P0DIR
   \                     P0DIR:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     70          #include "MT_UART.h"
     71          #include "mac_rx.h"
     72          
     73          /* HAL */
     74          #include "hal_led.h"
     75          #include "hal_key.h"
     76          #include "OSAL_Nv.h"
     77          
     78          #include "AddrMgr.h"
     79          #include "nwk_util.h"
     80          #include "ZDObject.h"
     81          #include "ZDO_LIB.h"
     82          #include "common_device.h"
     83          #include "IO_config.h"
     84          #include "OSAL_PwrMgr.h"
     85          
     86          
     87          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     88          afAddrType_t SampleApp_BIND_DstAddr;
   \                     SampleApp_BIND_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
     89          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     90          uint8 UserApp_TaskID;
   \                     UserApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     91          uint8 RS_LEN=0;
   \                     RS_LEN:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     92          uint8 RS_STR[10];
   \                     RS_STR:
   \   000000                DS 10
   \   00000A                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     93          uint8 SHORT_ADRESS[4];
   \                     SHORT_ADRESS:
   \   000000                DS 4
   \   000004                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     94          uint8 USER_DATA_LEN=0;
   \                     USER_DATA_LEN:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     95          uint8 USER_DATA_TYPE=0;
   \                     USER_DATA_TYPE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     96          uint8 *USER_DATA_STR;
   \                     USER_DATA_STR:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
     97          
     98          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     99          uint8 DEVICE_ID;
   \                     DEVICE_ID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    100          uint8 DEFINED_CONTROL_CHAR;
   \                     DEFINED_CONTROL_CHAR:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    101          uint8 JOIN_ROLE;
   \                     JOIN_ROLE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    102          uint16 NORMAL_POLL_TIME=7000;
   \                     NORMAL_POLL_TIME:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for NORMAL_POLL_TIME>`
   \   000002                REQUIRE __INIT_XDATA_I
    103          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    104          uint8 DEEP_POLL_FLAG;
   \                     DEEP_POLL_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    105          uint8 FRONT_ALARM_FLAG=0;
   \                     FRONT_ALARM_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    106          uint8 FRONT_ALARM_BIT=0;
   \                     FRONT_ALARM_BIT:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    107          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    108          uint16 active_battery_voltage=0;
   \                     active_battery_voltage:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    109          uint8 CASH_TIME_FLAG=0;
   \                     CASH_TIME_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    110          uint8 HIGH_BUTTERY_FLAG = 0; //大于2.9V
   \                     HIGH_BUTTERY_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    111          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    112          uint8 LOW_POWER_MODE=0;  // 低于2.5V ，进入放电模式
   \                     LOW_POWER_MODE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    113          uint16 Heart_mesg_count;  
   \                     Heart_mesg_count:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    114          uint8 poll_count=0;    //
   \                     poll_count:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    115          uint8 Hour_count=0;
   \                     Hour_count:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    116          uint8 more_detect_low_power_flag=0;
   \                     more_detect_low_power_flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    117          uint8 BUTTERY_LOW_FLAG=0;
   \                     BUTTERY_LOW_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    118          uint8 BUTTERY_ALARM_BIT=0;
   \                     BUTTERY_ALARM_BIT:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    119          uint8 POLLRATE_TIME_VALUE = 0;
   \                     POLLRATE_TIME_VALUE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    120            uint8 Key_Delay_Flag =0 ;
   \                     Key_Delay_Flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    121          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    122          uint8 BUUTON_STATE = 0;
   \                     BUUTON_STATE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    123          
    124          #define WALL_ONOFF_BINDOUTGLIST       1

   \                                 In  segment XDATA_I, align 1, keep-with-next
    125          static cId_t bindingOUTClusters[WALL_ONOFF_BINDOUTGLIST] =
   \                     bindingOUTClusters:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for bindingOUTClusters>`
   \   000002                REQUIRE __INIT_XDATA_I
    126          {
    127            SAMPLEAPP_ONOFF_CLUSTERID,
    128          };
    129          
    130          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    131          uint8 ONOROFF1=0,ONOROFF2=0,ONOROFF3=0,ONOROFF4=0,ONOROFF5=0,ONOROFF6=0;
   \                     ONOROFF1:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ONOROFF2:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ONOROFF3:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ONOROFF4:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ONOROFF5:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ONOROFF6:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    132          uint8 screen_current_flag =0 ;
   \                     screen_current_flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    133          uint8 screen_flag = 0;
   \                     screen_flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    134          
    135          
    136          
    137          
    138          
    139             

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    140          uint8   CR2_DATA_NODETECT_FLAG = 0; //设置标记位，发送数据的时候禁止中断
   \                     CR2_DATA_NODETECT_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    141          void CR2_DATA_NODETECT_MSG(void);
    142             
    143          
    144          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    145          uint8 forever_forbiten_flag=0;
   \                     forever_forbiten_flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    146          cId_t bindingINClusters[1];
   \                     bindingINClusters:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    147          //afAddrType_t SampleApp_BIND_DstAddr;
    148          
    149          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    150              	uint8 CmdType;  //命令类型： '1' 学习，'2' 使用
   \                     CmdType:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    151          	uint16 IRCodeIndex;   //
   \                     IRCodeIndex:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    152          uint8 longPollRateFlag = 1;
   \                     longPollRateFlag:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for longPollRateFlag>`
   \   000001                REQUIRE __INIT_XDATA_I
    153          
    154          
    155          

   \                                 In  segment XDATA_ROM_C, align 1
    156          const cId_t USER_SampleApp_ClusterList[SAMPLEAPP_MAX_CLUSTERS] =
   \                     USER_SampleApp_ClusterList:
   \   000000   0100         DW 1
   \   000002   0200         DW 2
   \   000004   0300         DW 3
   \   000006   0400         DW 4
   \   000008   0500         DW 5
   \   00000A   0600         DW 6
   \   00000C   0700         DW 7
   \   00000E   0800         DW 8
   \   000010   0B00         DW 11
   \   000012   0C00         DW 12
   \   000014   0D00         DW 13
   \   000016   0E00         DW 14
   \   000018   0000         DW 0
    157          {
    158            SAMPLEAPP_ONOFF_CLUSTERID, //周期信息簇ID=1
    159            SAMPLEAPP_FLASH_CLUSTERID,    //闪烁信息簇ID=2
    160            SAMPLEAPP_ADDR_CLUSTERID,
    161            SAMPLEAPP_COMMAND_CLUSTERID,
    162            SAMPLEAPP_PERIODIC_CLUSTERID,
    163            SAMPLEAPP_ANNCE_REQ_CLUSTERID,
    164            SAMPLEAPP_PERIODIC_COORDINATOR_CLUSTERID,
    165            SAMPLEAPP_ACTIVE_COMMAND_CLUSTERID,
    166            SAMPLEAPP_DIMMER_CLUSTERID,
    167            SAMPLEAPP_IR_CLUSTERID,
    168            SAMPLEAPP_CERTAIN_CONTROL_CLUSTERID,
    169            SAMPLEAPP_ELOCK_CLUSTERID       
    170          };
    171          
    172          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    173          endPointDesc_t SampleApp_epDesc1;
   \                     SampleApp_epDesc1:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z
    174          
    175          

   \                                 In  segment XDATA_ROM_C, align 1
    176          const SimpleDescriptionFormat_t SampleApp_SimpleDesc1 =
   \                     SampleApp_SimpleDesc1:
   \   000000   15           DB 21
   \   000001   080F         DW 3848
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   0D           DB 13
   \   000007   ....         DW SampleApp_ClusterList
   \   000009   0D           DB 13
   \   00000A   ....         DW SampleApp_ClusterList
    177          {
    178            SAMPLEAPP_ENDPOINT1,              //  int Endpoint;
    179            SAMPLEAPP_PROFID,                //  uint16 AppProfId[2];/**/
    180            SAMPLEAPP_DEVICEID,              //  uint16 AppDeviceId[2];
    181            SAMPLEAPP_DEVICE_VERSION,        //  int   AppDevVer:4;
    182            SAMPLEAPP_FLAGS,                 //  int   AppFlags:4;
    183            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
    184            (cId_t *)SampleApp_ClusterList,  //  uint8 *pAppInClusterList;
    185            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
    186            (cId_t *)SampleApp_ClusterList   //  uint8 *pAppInClusterList;
    187          };
    188          
    189          
    190          
    191          
    192          uint8 USER_APP_COMMAND(uint8 *user_app_data,uint8 *str); 
    193          void USER_APP_JOIN_MSG(void);
    194          void SampleApp_ProcessBINDINGMessage(afIncomingMSGPacket_t *pkt);
    195          void SampleAPP_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg );
    196          
    197          void User_APP_Drive_init(void);
    198          void SampleApp_HandleKeys( uint8 shift, uint8 keys );//本用户应用按键函数
    199          void USER_SET_RS_MSG(void);//设置RS数据
    200          
    201          void USER_AFTER_RS_MSG(void);
    202          
    203          void USER_ZDO_JOINING_MSG(void); //ZDO层入网的时候处理函数 就是闪烁灯
    204          uint8 READ_NETKEY(void); //读取入网状态按键的状态传递到应用层
    205          void LED_CHANGE(uint8 Position,uint8 Mode);// 设置LED函数
    206          
    207          void SampleAPP_send_delay_message(void);
    208          
    209          void changePollRate(void);
    210          
    211          
    212          
    213          
    214          
    215          
    216          
    217          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    218          void UserApp_Init( uint8 task_id )
   \                     UserApp_Init:
    219          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    220          
    221            UserApp_TaskID = task_id;
   \   000007   EE           MOV     A,R6
   \   000008   90....       MOV     DPTR,#UserApp_TaskID
   \   00000B   F0           MOVX    @DPTR,A
    222            
    223            RegisterForKeys(task_id);
   \   00000C                ; Setup parameters for call to function RegisterForKeys
   \   00000C   EE           MOV     A,R6
   \   00000D   F9           MOV     R1,A
   \   00000E   12....       LCALL   ??RegisterForKeys?relay
   \   000011   E9           MOV     A,R1
    224          
    225            SampleApp_epDesc1.endPoint = SAMPLEAPP_ENDPOINT1;//SampleApp EP描述符的EP号：20
   \   000012   90....       MOV     DPTR,#SampleApp_epDesc1
   \   000015   7415         MOV     A,#0x15
   \   000017   F0           MOVX    @DPTR,A
    226            SampleApp_epDesc1.task_id = &SampleApp_TaskID;//SampleApp EP描述符的任务ID：0
   \   000018   90....       MOV     DPTR,#SampleApp_epDesc1 + 1
   \   00001B   74..         MOV     A,#SampleApp_TaskID & 0xff
   \   00001D   F0           MOVX    @DPTR,A
   \   00001E   A3           INC     DPTR
   \   00001F   74..         MOV     A,#(SampleApp_TaskID >> 8) & 0xff
   \   000021   F0           MOVX    @DPTR,A
    227            SampleApp_epDesc1.simpleDesc
    228                      = (SimpleDescriptionFormat_t *)&SampleApp_SimpleDesc1;//SampleApp EP简单描述符
   \   000022   90....       MOV     DPTR,#SampleApp_epDesc1 + 3
   \   000025   74..         MOV     A,#SampleApp_SimpleDesc1 & 0xff
   \   000027   F0           MOVX    @DPTR,A
   \   000028   A3           INC     DPTR
   \   000029   74..         MOV     A,#(SampleApp_SimpleDesc1 >> 8) & 0xff
   \   00002B   F0           MOVX    @DPTR,A
    229            SampleApp_epDesc1.latencyReq = noLatencyReqs;//延时策略
   \   00002C   90....       MOV     DPTR,#SampleApp_epDesc1 + 5
   \   00002F   7400         MOV     A,#0x0
   \   000031   F0           MOVX    @DPTR,A
    230          
    231            
    232            SampleApp_BIND_DstAddr.addrMode = (afAddrMode_t)AddrNotPresent;
   \   000032   90....       MOV     DPTR,#SampleApp_BIND_DstAddr + 8
   \   000035   7400         MOV     A,#0x0
   \   000037   F0           MOVX    @DPTR,A
    233            SampleApp_BIND_DstAddr.endPoint = 0;
   \   000038   90....       MOV     DPTR,#SampleApp_BIND_DstAddr + 9
   \   00003B   7400         MOV     A,#0x0
   \   00003D   F0           MOVX    @DPTR,A
    234            SampleApp_BIND_DstAddr.addr.shortAddr = 0;
   \   00003E   90....       MOV     DPTR,#SampleApp_BIND_DstAddr
   \   000041   7400         MOV     A,#0x0
   \   000043   F0           MOVX    @DPTR,A
   \   000044   A3           INC     DPTR
   \   000045   7400         MOV     A,#0x0
   \   000047   F0           MOVX    @DPTR,A
    235            
    236            
    237            // Register the endpoint description with the AF
    238            afRegister( &SampleApp_epDesc1 );
   \   000048                ; Setup parameters for call to function afRegister
   \   000048   7A..         MOV     R2,#SampleApp_epDesc1 & 0xff
   \   00004A   7B..         MOV     R3,#(SampleApp_epDesc1 >> 8) & 0xff
   \   00004C   12....       LCALL   ??afRegister?relay
   \   00004F   E9           MOV     A,R1
    239            //afRegister( &SampleApp_epDesc2 );
    240            //afRegister( &SampleApp_epDesc3 );
    241            //afRegister( &SampleApp_epDesc4 );
    242           // afRegister( &SampleApp_epDesc5 );
    243           // afRegister( &SampleApp_epDesc6 );
    244          
    245          
    246            RegisterForKeys( UserApp_TaskID ); 
   \   000050                ; Setup parameters for call to function RegisterForKeys
   \   000050   90....       MOV     DPTR,#UserApp_TaskID
   \   000053   E0           MOVX    A,@DPTR
   \   000054   F9           MOV     R1,A
   \   000055   12....       LCALL   ??RegisterForKeys?relay
   \   000058   E9           MOV     A,R1
    247            
    248            ZDO_RegisterForZDOMsg( UserApp_TaskID, End_Device_Bind_rsp );
   \   000059                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000059   7A20         MOV     R2,#0x20
   \   00005B   7B80         MOV     R3,#-0x80
   \   00005D   90....       MOV     DPTR,#UserApp_TaskID
   \   000060   E0           MOVX    A,@DPTR
   \   000061   F9           MOV     R1,A
   \   000062   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
   \   000065   E9           MOV     A,R1
    249          
    250            
    251            User_APP_Drive_init();
   \   000066                ; Setup parameters for call to function User_APP_Drive_init
   \   000066   12....       LCALL   ??User_APP_Drive_init?relay
    252          
    253          }
   \   000069   7F01         MOV     R7,#0x1
   \   00006B   02....       LJMP    ?BANKED_LEAVE_XDATA
    254          
    255          /*********************************************************************
    256           * @fn      SampleApp_ProcessEvent
    257           *
    258           * @brief   Generic Application Task event processor.  This function
    259           *          is called to process all events for the task.  Events
    260           *          include timers, messages and any other user defined events.
    261           *
    262           * @param   task_id  - The OSAL assigned task ID.
    263           * @param   events - events to process.  This is a bit map and can
    264           *                   contain more than one event.
    265           *
    266           * @return  none
    267           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    268          uint16 UserApp_ProcessEvent( uint8 task_id, uint16 events )
   \                     UserApp_ProcessEvent:
    269          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 2,R1
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
   \   000009   EB           MOV     A,R3
   \   00000A   FF           MOV     R7,A
    270            afIncomingMSGPacket_t *MSGpkt;
    271           
    272            if ( events & SYS_EVENT_MSG )
   \   00000B   EE           MOV     A,R6
   \   00000C   5400         ANL     A,#0x0
   \   00000E   F8           MOV     R0,A
   \   00000F   EF           MOV     A,R7
   \   000010   5480         ANL     A,#0x80
   \   000012   F9           MOV     R1,A
   \   000013   E8           MOV     A,R0
   \   000014   49           ORL     A,R1
   \   000015   606F         JZ      ??UserApp_ProcessEvent_0
    273            {
    274              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( UserApp_TaskID );
   \   000017                ; Setup parameters for call to function osal_msg_receive
   \   000017   90....       MOV     DPTR,#UserApp_TaskID
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   F9           MOV     R1,A
   \   00001C   12....       LCALL   ??osal_msg_receive?relay
   \   00001F   8A..         MOV     ?V0 + 4,R2
   \   000021   8B..         MOV     ?V0 + 5,R3
   \   000023   85....       MOV     ?V0 + 0,?V0 + 4
   \   000026   85....       MOV     ?V0 + 1,?V0 + 5
    275              while ( MSGpkt )                                           
   \                     ??UserApp_ProcessEvent_1:
   \   000029   E5..         MOV     A,?V0 + 0
   \   00002B   45..         ORL     A,?V0 + 1
   \   00002D   604C         JZ      ??UserApp_ProcessEvent_2
    276              {                                                                     
    277                switch ( MSGpkt->hdr.event )
   \   00002F   85..82       MOV     DPL,?V0 + 0
   \   000032   85..83       MOV     DPH,?V0 + 1
   \   000035   E0           MOVX    A,@DPTR
   \   000036   2440         ADD     A,#0x40
   \   000038   600D         JZ      ??UserApp_ProcessEvent_3
   \   00003A   24ED         ADD     A,#-0x13
   \   00003C   7021         JNZ     ??UserApp_ProcessEvent_4
    278                {
    279                  
    280                   
    281                   case ZDO_CB_MSG:
    282                    SampleAPP_ProcessZDOMsgs( (zdoIncomingMsg_t *)MSGpkt );
   \   00003E                ; Setup parameters for call to function SampleAPP_ProcessZDOMsgs
   \   00003E   AA..         MOV     R2,?V0 + 0
   \   000040   AB..         MOV     R3,?V0 + 1
   \   000042   12....       LCALL   ??SampleAPP_ProcessZDOMsgs?relay
    283                    break; 
   \   000045   8018         SJMP    ??UserApp_ProcessEvent_4
    284                    
    285                  case KEY_CHANGE:      
    286                    SampleApp_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
   \                     ??UserApp_ProcessEvent_3:
   \   000047                ; Setup parameters for call to function SampleApp_HandleKeys
   \   000047   85..82       MOV     DPL,?V0 + 0
   \   00004A   85..83       MOV     DPH,?V0 + 1
   \   00004D   A3           INC     DPTR
   \   00004E   A3           INC     DPTR
   \   00004F   A3           INC     DPTR
   \   000050   E0           MOVX    A,@DPTR
   \   000051   FA           MOV     R2,A
   \   000052   85..82       MOV     DPL,?V0 + 0
   \   000055   85..83       MOV     DPH,?V0 + 1
   \   000058   A3           INC     DPTR
   \   000059   A3           INC     DPTR
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   F9           MOV     R1,A
   \   00005C   12....       LCALL   ??SampleApp_HandleKeys?relay
    287                    break;                                             
    288          
    289                  default:
    290                    break;
    291                }
    292          
    293                // Release the memory
    294                //释放消息占用的内存
    295                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??UserApp_ProcessEvent_4:
   \   00005F                ; Setup parameters for call to function osal_msg_deallocate
   \   00005F   AA..         MOV     R2,?V0 + 0
   \   000061   AB..         MOV     R3,?V0 + 1
   \   000063   12....       LCALL   ??osal_msg_deallocate?relay
   \   000066   E9           MOV     A,R1
    296          
    297                // Next - if one is available
    298                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( UserApp_TaskID );
   \   000067                ; Setup parameters for call to function osal_msg_receive
   \   000067   90....       MOV     DPTR,#UserApp_TaskID
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   F9           MOV     R1,A
   \   00006C   12....       LCALL   ??osal_msg_receive?relay
   \   00006F   8A..         MOV     ?V0 + 4,R2
   \   000071   8B..         MOV     ?V0 + 5,R3
   \   000073   85....       MOV     ?V0 + 0,?V0 + 4
   \   000076   85....       MOV     ?V0 + 1,?V0 + 5
   \   000079   80AE         SJMP    ??UserApp_ProcessEvent_1
    299              }//end： while ( MSGpkt )
    300          
    301              return (events ^ SYS_EVENT_MSG);
   \                     ??UserApp_ProcessEvent_2:
   \   00007B   EE           MOV     A,R6
   \   00007C   6400         XRL     A,#0x0
   \   00007E   FA           MOV     R2,A
   \   00007F   EF           MOV     A,R7
   \   000080   6480         XRL     A,#0x80
   \   000082   FB           MOV     R3,A
   \   000083   02....       LJMP    ??UserApp_ProcessEvent_5 & 0xFFFF
    302            }
    303            
    304          /*  
    305           //用户自行添加事件
    306           //test
    307            if ( events & USER_TEST_EVT )
    308            {
    309              HAL_TOGGLE_LED1();
    310                osal_start_timerEx( UserApp_TaskID, USER_TEST_EVT,10000);
    311              
    312               return (events ^ USER_TEST_EVT );
    313            } 
    314          */  
    315            if ( events & SAMPLEAPP_SEND_LOWBUTTERY_EVT )
   \                     ??UserApp_ProcessEvent_0:
   \   000086   EE           MOV     A,R6
   \   000087   5404         ANL     A,#0x4
   \   000089   6013         JZ      ??UserApp_ProcessEvent_6
    316            {
    317            
    318              BUTTERY_LOW_FLAG =1;
   \   00008B   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   00008E   7401         MOV     A,#0x1
   \   000090   F0           MOVX    @DPTR,A
    319              SampleApp_SendInMessage();
   \   000091                ; Setup parameters for call to function SampleApp_SendInMessage
   \   000091   12....       LCALL   ??SampleApp_SendInMessage?relay
    320              
    321             return ( events ^ SAMPLEAPP_SEND_LOWBUTTERY_EVT);
   \   000094   EE           MOV     A,R6
   \   000095   6404         XRL     A,#0x4
   \   000097   FA           MOV     R2,A
   \   000098   EF           MOV     A,R7
   \   000099   6400         XRL     A,#0x0
   \   00009B   FB           MOV     R3,A
   \   00009C   8078         SJMP    ??UserApp_ProcessEvent_5
    322            }
    323            
    324            
    325          /*
    326            
    327             if ( events & SAMPLEAPP_SEND_NBJC_EVT )
    328            {
    329                  active_battery_voltage=myApp_ReadBattery();
    330                //  BUTTERY_LOW_FLAG =1;
    331               //   SampleApp_SendInMessage();
    332                   if(active_battery_voltage<=245)
    333                    {
    334                      P0IEN &=~BV(4);
    335                      P1IEN &=~BV(5);
    336                      forever_forbiten_flag=1;
    337                      
    338                 
    339                      more_detect_low_power_flag++;
    340                      if(more_detect_low_power_flag>=3)
    341                      {
    342                      LOW_POWER_MODE=1;
    343                      osal_start_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_LOWBUTTERY_EVT,60000 );
    344                      osal_stop_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_NBJC_EVT);   
    345                      }
    346                      else
    347                      {
    348             
    349          
    350                      osal_start_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_NBJC_EVT,3000 );   
    351                      } 
    352                    }
    353                    else
    354                    {
    355                     more_detect_low_power_flag=0;
    356                     forever_forbiten_flag=0;  
    357                     osal_pwrmgr_device( PWRMGR_BATTERY );
    358          
    359                    }
    360                   
    361             return ( events ^ SAMPLEAPP_SEND_NBJC_EVT);
    362            }
    363            
    364            
    365            
    366               if ( events & CR2_DATA_DETECT_EVT )
    367            {
    368              
    369              if( (PUSH4_SBIT==0) && (forever_forbiten_flag==0))
    370              // if(PUSH4_SBIT==0)
    371              { 
    372                if( (CASH_TIME_FLAG==1) ||(HIGH_BUTTERY_FLAG==1)) //消除警告后再过1S再打开，防止莫名的误报,如果电池大于2.9V则直接开启中断
    373                {
    374                  EA=0;
    375                  P0IEN |=BV(4);
    376                  P1IEN |=BV(5);
    377                  P0IFG=0;
    378                  P1IFG=0;
    379                  EA=1;
    380                  
    381                  if(FRONT_ALARM_FLAG==1)//如果是因为报警导致的禁止中断
    382                  {
    383                    FRONT_ALARM_FLAG=0;
    384                    SampleApp_SendInMessage();//补发消警消息上去
    385                  }
    386                  CASH_TIME_FLAG=0;
    387                }
    388                else
    389                {
    390                  //刚刚消除警告，且电池有电，则再延迟1S，再打开中断
    391                  CASH_TIME_FLAG=1;
    392                  osal_start_timerEx( UserApp_TaskID, CR2_DATA_DETECT_EVT,1000);
    393                }  
    394              }
    395              else
    396              {
    397               osal_start_timerEx( UserApp_TaskID, CR2_DATA_DETECT_EVT,500);
    398              }  
    399                return (events ^ CR2_DATA_DETECT_EVT );
    400            }
    401            */
    402            
    403            if ( events & RE_SET_POLL_EVT )
   \                     ??UserApp_ProcessEvent_6:
   \   00009E   EE           MOV     A,R6
   \   00009F   5410         ANL     A,#0x10
   \   0000A1   6042         JZ      ??UserApp_ProcessEvent_7
    404            {
    405              if(poll_count++>=5)
   \   0000A3   90....       MOV     DPTR,#poll_count
   \   0000A6   E0           MOVX    A,@DPTR
   \   0000A7   F8           MOV     R0,A
   \   0000A8   7401         MOV     A,#0x1
   \   0000AA   28           ADD     A,R0
   \   0000AB   90....       MOV     DPTR,#poll_count
   \   0000AE   F0           MOVX    @DPTR,A
   \   0000AF   E8           MOV     A,R0
   \   0000B0   C3           CLR     C
   \   0000B1   9405         SUBB    A,#0x5
   \   0000B3   4015         JC      ??UserApp_ProcessEvent_8
    406              { 
    407                poll_count=0;
   \   0000B5   90....       MOV     DPTR,#poll_count
   \   0000B8   7400         MOV     A,#0x0
   \   0000BA   F0           MOVX    @DPTR,A
    408                NLME_SetPollRate(0); //直接不POLL了，靠心跳的POLL来做
   \   0000BB                ; Setup parameters for call to function NLME_SetPollRate
   \   0000BB   7A00         MOV     R2,#0x0
   \   0000BD   7B00         MOV     R3,#0x0
   \   0000BF   12....       LCALL   ??NLME_SetPollRate?relay
    409                DEEP_POLL_FLAG =1;
   \   0000C2   90....       MOV     DPTR,#DEEP_POLL_FLAG
   \   0000C5   7401         MOV     A,#0x1
   \   0000C7   F0           MOVX    @DPTR,A
   \   0000C8   8011         SJMP    ??UserApp_ProcessEvent_9
    410              }  
    411              else
    412              {
    413                osal_start_timerEx( UserApp_TaskID, RE_SET_POLL_EVT,60000);//10分钟
   \                     ??UserApp_ProcessEvent_8:
   \   0000CA                ; Setup parameters for call to function osal_start_timerEx
   \   0000CA   7C60         MOV     R4,#0x60
   \   0000CC   7DEA         MOV     R5,#-0x16
   \   0000CE   7A10         MOV     R2,#0x10
   \   0000D0   7B00         MOV     R3,#0x0
   \   0000D2   90....       MOV     DPTR,#UserApp_TaskID
   \   0000D5   E0           MOVX    A,@DPTR
   \   0000D6   F9           MOV     R1,A
   \   0000D7   12....       LCALL   ??osal_start_timerEx?relay
   \   0000DA   E9           MOV     A,R1
    414              }  
    415              return ( events ^ RE_SET_POLL_EVT);
   \                     ??UserApp_ProcessEvent_9:
   \   0000DB   EE           MOV     A,R6
   \   0000DC   6410         XRL     A,#0x10
   \   0000DE   FA           MOV     R2,A
   \   0000DF   EF           MOV     A,R7
   \   0000E0   6400         XRL     A,#0x0
   \   0000E2   FB           MOV     R3,A
   \   0000E3   8031         SJMP    ??UserApp_ProcessEvent_5
    416            }
    417            
    418            
    419            if ( events & SAMPLEAPP_KEYREALY_EVT )
   \                     ??UserApp_ProcessEvent_7:
   \   0000E5   EE           MOV     A,R6
   \   0000E6   5420         ANL     A,#0x20
   \   0000E8   6010         JZ      ??UserApp_ProcessEvent_10
    420            {    
    421                  Key_Delay_Flag =0;
   \   0000EA   90....       MOV     DPTR,#Key_Delay_Flag
   \   0000ED   7400         MOV     A,#0x0
   \   0000EF   F0           MOVX    @DPTR,A
    422                 return ( events ^ SAMPLEAPP_KEYREALY_EVT);
   \   0000F0   EE           MOV     A,R6
   \   0000F1   6420         XRL     A,#0x20
   \   0000F3   FA           MOV     R2,A
   \   0000F4   EF           MOV     A,R7
   \   0000F5   6400         XRL     A,#0x0
   \   0000F7   FB           MOV     R3,A
   \   0000F8   801C         SJMP    ??UserApp_ProcessEvent_5
    423            }
    424            
    425              
    426            if ( events & SAMPLEAPP_OVERMSG_EVT )
   \                     ??UserApp_ProcessEvent_10:
   \   0000FA   EE           MOV     A,R6
   \   0000FB   5440         ANL     A,#0x40
   \   0000FD   6013         JZ      ??UserApp_ProcessEvent_11
    427            {    
    428                   BUUTON_STATE = 0;
   \   0000FF   90....       MOV     DPTR,#BUUTON_STATE
   \   000102   7400         MOV     A,#0x0
   \   000104   F0           MOVX    @DPTR,A
    429                SampleApp_SendInMessage();
   \   000105                ; Setup parameters for call to function SampleApp_SendInMessage
   \   000105   12....       LCALL   ??SampleApp_SendInMessage?relay
    430                 return ( events ^ SAMPLEAPP_OVERMSG_EVT);
   \   000108   EE           MOV     A,R6
   \   000109   6440         XRL     A,#0x40
   \   00010B   FA           MOV     R2,A
   \   00010C   EF           MOV     A,R7
   \   00010D   6400         XRL     A,#0x0
   \   00010F   FB           MOV     R3,A
   \   000110   8004         SJMP    ??UserApp_ProcessEvent_5
    431            }
    432            
    433            
    434          
    435            return 0;
   \                     ??UserApp_ProcessEvent_11:
   \   000112   7A00         MOV     R2,#0x0
   \   000114   7B00         MOV     R3,#0x0
   \                     ??UserApp_ProcessEvent_5:
   \   000116   7F06         MOV     R7,#0x6
   \   000118   02....       LJMP    ?BANKED_LEAVE_XDATA
    436          }
    437          
    438          // 按键命令传输到USER层，用户自行添加删除

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    439          void SampleApp_HandleKeys( uint8 shift, uint8 keys )
   \                     SampleApp_HandleKeys:
    440          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 10
   \   000005   74F6         MOV     A,#-0xa
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FF           MOV     R7,A
   \   00000C   8A..         MOV     ?V0 + 0,R2
    441            //uint8 startOptions;
    442           // uint8 logicalType;
    443            zAddrType_t dstAddr;
    444            
    445            if ( keys &  HAL_KEY_SW_8 )
   \   00000E   E5..         MOV     A,?V0 + 0
   \   000010   A2E7         MOV     C,0xE0 /* A   */.7
   \   000012   4003         JC      $+5
   \   000014   02....       LJMP    ??SampleApp_HandleKeys_0 & 0xFFFF
    446            {     
    447              if(key_double_flag==1)
   \   000017   90....       MOV     DPTR,#key_double_flag
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   6401         XRL     A,#0x1
   \   00001D   7021         JNZ     ??SampleApp_HandleKeys_1
    448              {
    449                BUUTON_STATE = 0;
   \   00001F   90....       MOV     DPTR,#BUUTON_STATE
   \   000022   7400         MOV     A,#0x0
   \   000024   F0           MOVX    @DPTR,A
    450                SampleApp_SendInMessage();
   \   000025                ; Setup parameters for call to function SampleApp_SendInMessage
   \   000025   12....       LCALL   ??SampleApp_SendInMessage?relay
    451                
    452                FRONT_ALARM_FLAG = 1;
   \   000028   90....       MOV     DPTR,#FRONT_ALARM_FLAG
   \   00002B   7401         MOV     A,#0x1
   \   00002D   F0           MOVX    @DPTR,A
    453                FRONT_ALARM_BIT =0;
   \   00002E   90....       MOV     DPTR,#FRONT_ALARM_BIT
   \   000031   7400         MOV     A,#0x0
   \   000033   F0           MOVX    @DPTR,A
    454                SampleApp_SendInMessage();
   \   000034                ; Setup parameters for call to function SampleApp_SendInMessage
   \   000034   12....       LCALL   ??SampleApp_SendInMessage?relay
    455                key_double_flag=0;
   \   000037   90....       MOV     DPTR,#key_double_flag
   \   00003A   7400         MOV     A,#0x0
   \   00003C   F0           MOVX    @DPTR,A
   \   00003D   02....       LJMP    ??SampleApp_HandleKeys_0 & 0xFFFF
    456              }
    457              else if((key_double_flag==3)&&(P0_5 == 0))
   \                     ??SampleApp_HandleKeys_1:
   \   000040   90....       MOV     DPTR,#key_double_flag
   \   000043   E0           MOVX    A,@DPTR
   \   000044   6403         XRL     A,#0x3
   \   000046   6003         JZ      $+5
   \   000048   02....       LJMP    ??SampleApp_HandleKeys_2 & 0xFFFF
   \   00004B   A285         MOV     C,0x80.5
   \   00004D   5003         JNC     $+5
   \   00004F   02....       LJMP    ??SampleApp_HandleKeys_2 & 0xFFFF
    458              {
    459                key_double_flag=0;
   \   000052   90....       MOV     DPTR,#key_double_flag
   \   000055   7400         MOV     A,#0x0
   \   000057   F0           MOVX    @DPTR,A
    460                HalLedBlink ( HAL_LED_1, 1, 50, 1000 );
   \   000058                ; Setup parameters for call to function HalLedBlink
   \   000058   7CE8         MOV     R4,#-0x18
   \   00005A   7D03         MOV     R5,#0x3
   \   00005C   7B32         MOV     R3,#0x32
   \   00005E   7A01         MOV     R2,#0x1
   \   000060   7901         MOV     R1,#0x1
   \   000062   12....       LCALL   ??HalLedBlink?relay
    461                if( (devState==DEV_END_DEVICE) || (devState==DEV_ROUTER) )
   \   000065   90....       MOV     DPTR,#devState
   \   000068   E0           MOVX    A,@DPTR
   \   000069   6406         XRL     A,#0x6
   \   00006B   600B         JZ      ??SampleApp_HandleKeys_3
   \   00006D   90....       MOV     DPTR,#devState
   \   000070   E0           MOVX    A,@DPTR
   \   000071   6407         XRL     A,#0x7
   \   000073   6003         JZ      $+5
   \   000075   02....       LJMP    ??SampleApp_HandleKeys_0 & 0xFFFF
    462                {
    463                  dstAddr.addrMode = afAddr16Bit;
   \                     ??SampleApp_HandleKeys_3:
   \   000078   7409         MOV     A,#0x9
   \   00007A   12....       LCALL   ?XSTACK_DISP0_8
   \   00007D   7402         MOV     A,#0x2
   \   00007F   F0           MOVX    @DPTR,A
    464                  dstAddr.addr.shortAddr = 0;   // Coordinator makes the match
   \   000080   7401         MOV     A,#0x1
   \   000082   12....       LCALL   ?XSTACK_DISP0_8
   \   000085   7400         MOV     A,#0x0
   \   000087   F0           MOVX    @DPTR,A
   \   000088   A3           INC     DPTR
   \   000089   7400         MOV     A,#0x0
   \   00008B   F0           MOVX    @DPTR,A
    465                  
    466                  ZDP_EndDeviceBindReq( &dstAddr, NLME_GetShortAddr(),
    467                                       SAMPLEAPP_ENDPOINT1,
    468                                       0x0F08,
    469                                       0, NULL,   // No incoming clusters to bind   0, NULL
    470                                       WALL_ONOFF_BINDOUTGLIST, bindingOUTClusters,
    471                                       FALSE );
   \   00008C                ; Setup parameters for call to function ZDP_EndDeviceBindReq
   \   00008C   75..00       MOV     ?V0 + 1,#0x0
   \   00008F   78..         MOV     R0,#?V0 + 1
   \   000091   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000094   75....       MOV     ?V0 + 2,#bindingOUTClusters & 0xff
   \   000097   75....       MOV     ?V0 + 3,#(bindingOUTClusters >> 8) & 0xff
   \   00009A   78..         MOV     R0,#?V0 + 2
   \   00009C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009F   75..01       MOV     ?V0 + 1,#0x1
   \   0000A2   78..         MOV     R0,#?V0 + 1
   \   0000A4   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000A7   E4           CLR     A
   \   0000A8   F5..         MOV     ?V0 + 2,A
   \   0000AA   F5..         MOV     ?V0 + 3,A
   \   0000AC   78..         MOV     R0,#?V0 + 2
   \   0000AE   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000B1   75..00       MOV     ?V0 + 1,#0x0
   \   0000B4   78..         MOV     R0,#?V0 + 1
   \   0000B6   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000B9   75..08       MOV     ?V0 + 2,#0x8
   \   0000BC   75..0F       MOV     ?V0 + 3,#0xf
   \   0000BF   78..         MOV     R0,#?V0 + 2
   \   0000C1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000C4   7915         MOV     R1,#0x15
   \   0000C6   E9           MOV     A,R1
   \   0000C7   FE           MOV     R6,A
   \   0000C8   F9           MOV     R1,A
   \   0000C9                ; Setup parameters for call to function NLME_GetShortAddr
   \   0000C9   12....       LCALL   ??NLME_GetShortAddr?relay
   \   0000CC   EA           MOV     A,R2
   \   0000CD   FC           MOV     R4,A
   \   0000CE   EB           MOV     A,R3
   \   0000CF   FD           MOV     R5,A
   \   0000D0   EE           MOV     A,R6
   \   0000D1   F9           MOV     R1,A
   \   0000D2   FE           MOV     R6,A
   \   0000D3   740A         MOV     A,#0xa
   \   0000D5   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D8   AA82         MOV     R2,DPL
   \   0000DA   AB83         MOV     R3,DPH
   \   0000DC   12....       LCALL   ??ZDP_EndDeviceBindReq?relay
   \   0000DF   7409         MOV     A,#0x9
   \   0000E1   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000E4   E9           MOV     A,R1
   \   0000E5   805F         SJMP    ??SampleApp_HandleKeys_0
    472                }
    473              }
    474              else if(key_double_flag==4)
   \                     ??SampleApp_HandleKeys_2:
   \   0000E7   90....       MOV     DPTR,#key_double_flag
   \   0000EA   E0           MOVX    A,@DPTR
   \   0000EB   6404         XRL     A,#0x4
   \   0000ED   700F         JNZ     ??SampleApp_HandleKeys_4
    475              {
    476                key_double_flag=0;
   \   0000EF   90....       MOV     DPTR,#key_double_flag
   \   0000F2   7400         MOV     A,#0x0
   \   0000F4   F0           MOVX    @DPTR,A
    477                if(P0_5 == 0)
   \   0000F5   A285         MOV     C,0x80.5
   \   0000F7   404D         JC      ??SampleApp_HandleKeys_0
    478                 APPLY_TO_JOIN_OF_KEY();
   \   0000F9                ; Setup parameters for call to function APPLY_TO_JOIN_OF_KEY
   \   0000F9   12....       LCALL   ??APPLY_TO_JOIN_OF_KEY?relay
   \   0000FC   8048         SJMP    ??SampleApp_HandleKeys_0
    479              }
    480               else if(key_double_flag==8)
   \                     ??SampleApp_HandleKeys_4:
   \   0000FE   90....       MOV     DPTR,#key_double_flag
   \   000101   E0           MOVX    A,@DPTR
   \   000102   6408         XRL     A,#0x8
   \   000104   702D         JNZ     ??SampleApp_HandleKeys_5
    481              { 
    482                key_double_flag=0;
   \   000106   90....       MOV     DPTR,#key_double_flag
   \   000109   7400         MOV     A,#0x0
   \   00010B   F0           MOVX    @DPTR,A
    483                if(P0_5 == 0)
   \   00010C   A285         MOV     C,0x80.5
   \   00010E   4036         JC      ??SampleApp_HandleKeys_0
    484                {
    485                 HalLedBlink ( HAL_LED_1, 4, 50, 1000 );
   \   000110                ; Setup parameters for call to function HalLedBlink
   \   000110   7CE8         MOV     R4,#-0x18
   \   000112   7D03         MOV     R5,#0x3
   \   000114   7B32         MOV     R3,#0x32
   \   000116   7A04         MOV     R2,#0x4
   \   000118   7901         MOV     R1,#0x1
   \   00011A   12....       LCALL   ??HalLedBlink?relay
    486                RESTORE_TO_FACTORY();
   \   00011D                ; Setup parameters for call to function RESTORE_TO_FACTORY
   \   00011D   12....       LCALL   ??RESTORE_TO_FACTORY?relay
    487                osal_start_timerEx( SampleApp_TaskID,SAMPLEAPP_RESTORE_EVT,5000);
   \   000120                ; Setup parameters for call to function osal_start_timerEx
   \   000120   7C88         MOV     R4,#-0x78
   \   000122   7D13         MOV     R5,#0x13
   \   000124   7A10         MOV     R2,#0x10
   \   000126   7B00         MOV     R3,#0x0
   \   000128   90....       MOV     DPTR,#SampleApp_TaskID
   \   00012B   E0           MOVX    A,@DPTR
   \   00012C   F9           MOV     R1,A
   \   00012D   12....       LCALL   ??osal_start_timerEx?relay
   \   000130   E9           MOV     A,R1
   \   000131   8013         SJMP    ??SampleApp_HandleKeys_0
    488                }
    489               }
    490              else if(key_hold_flag==1)
   \                     ??SampleApp_HandleKeys_5:
   \   000133   90....       MOV     DPTR,#key_hold_flag
   \   000136   E0           MOVX    A,@DPTR
   \   000137   6401         XRL     A,#0x1
   \   000139   700B         JNZ     ??SampleApp_HandleKeys_0
    491              {
    492                osal_pwrmgr_device( PWRMGR_BATTERY );
   \   00013B                ; Setup parameters for call to function osal_pwrmgr_device
   \   00013B   7901         MOV     R1,#0x1
   \   00013D   12....       LCALL   ??osal_pwrmgr_device?relay
    493                key_hold_flag=0;
   \   000140   90....       MOV     DPTR,#key_hold_flag
   \   000143   7400         MOV     A,#0x0
   \   000145   F0           MOVX    @DPTR,A
    494              }
    495            }
    496              if (keys &  HAL_KEY_SW_9) 
   \                     ??SampleApp_HandleKeys_0:
   \   000146   E5..         MOV     A,?V0 + 0
   \   000148   A2E6         MOV     C,0xE0 /* A   */.6
   \   00014A   5009         JNC     ??SampleApp_HandleKeys_6
    497            { 
    498               FRONT_ALARM_BIT =1;
   \   00014C   90....       MOV     DPTR,#FRONT_ALARM_BIT
   \   00014F   7401         MOV     A,#0x1
   \   000151   F0           MOVX    @DPTR,A
    499               SampleApp_SendInMessage();  
   \   000152                ; Setup parameters for call to function SampleApp_SendInMessage
   \   000152   12....       LCALL   ??SampleApp_SendInMessage?relay
    500            
    501            }
    502            if (keys &  HAL_KEY_SW_5) 
   \                     ??SampleApp_HandleKeys_6:
   \   000155   E5..         MOV     A,?V0 + 0
   \   000157   A2E2         MOV     C,0xE0 /* A   */.2
   \   000159   4003         JC      $+5
   \   00015B   02....       LJMP    ??SampleApp_HandleKeys_7 & 0xFFFF
    503            { 
    504              
    505             if( (devState==DEV_END_DEVICE) || (devState==DEV_ROUTER) )
   \   00015E   90....       MOV     DPTR,#devState
   \   000161   E0           MOVX    A,@DPTR
   \   000162   6406         XRL     A,#0x6
   \   000164   600B         JZ      ??SampleApp_HandleKeys_8
   \   000166   90....       MOV     DPTR,#devState
   \   000169   E0           MOVX    A,@DPTR
   \   00016A   6407         XRL     A,#0x7
   \   00016C   6003         JZ      $+5
   \   00016E   02....       LJMP    ??SampleApp_HandleKeys_7 & 0xFFFF
    506             {
    507               
    508               if(Key_Delay_Flag == 0)
   \                     ??SampleApp_HandleKeys_8:
   \   000171   90....       MOV     DPTR,#Key_Delay_Flag
   \   000174   E0           MOVX    A,@DPTR
   \   000175   6003         JZ      $+5
   \   000177   02....       LJMP    ??SampleApp_HandleKeys_7 & 0xFFFF
    509               {  
    510                 BUUTON_STATE = 1;
   \   00017A   90....       MOV     DPTR,#BUUTON_STATE
   \   00017D   7401         MOV     A,#0x1
   \   00017F   F0           MOVX    @DPTR,A
    511                 SampleApp_SendInMessage();
   \   000180                ; Setup parameters for call to function SampleApp_SendInMessage
   \   000180   12....       LCALL   ??SampleApp_SendInMessage?relay
    512                 HalLedBlink ( HAL_LED_2, 1, 25, 200 );
   \   000183                ; Setup parameters for call to function HalLedBlink
   \   000183   7CC8         MOV     R4,#-0x38
   \   000185   7D00         MOV     R5,#0x0
   \   000187   7B19         MOV     R3,#0x19
   \   000189   7A01         MOV     R2,#0x1
   \   00018B   7902         MOV     R1,#0x2
   \   00018D   12....       LCALL   ??HalLedBlink?relay
    513                 
    514                if(bindNumReflections(SAMPLEAPP_ENDPOINT1,SAMPLEAPP_ONOFF_CLUSTERID)>0)//有绑定项目
   \   000190                ; Setup parameters for call to function bindNumReflections
   \   000190   7A01         MOV     R2,#0x1
   \   000192   7B00         MOV     R3,#0x0
   \   000194   7915         MOV     R1,#0x15
   \   000196   12....       LCALL   ??bindNumReflections?relay
   \   000199   8A..         MOV     ?V0 + 2,R2
   \   00019B   8B..         MOV     ?V0 + 3,R3
   \   00019D   E5..         MOV     A,?V0 + 2
   \   00019F   45..         ORL     A,?V0 + 3
   \   0001A1   605E         JZ      ??SampleApp_HandleKeys_9
    515                {
    516                  uint8 ONOROFF =0;
   \   0001A3   85..82       MOV     DPL,?XSP + 0
   \   0001A6   85..83       MOV     DPH,?XSP + 1
   \   0001A9   7400         MOV     A,#0x0
   \   0001AB   F0           MOVX    @DPTR,A
    517                  ONOROFF = 1;  //开         
   \   0001AC   85..82       MOV     DPL,?XSP + 0
   \   0001AF   85..83       MOV     DPH,?XSP + 1
   \   0001B2   7401         MOV     A,#0x1
   \   0001B4   F0           MOVX    @DPTR,A
    518                  if ( AF_DataRequest( &SampleApp_BIND_DstAddr, &SampleApp_epDesc1,
    519                                 SAMPLEAPP_ONOFF_CLUSTERID,
    520                                 1,  //数据长度
    521                                 &ONOROFF,//###添加的发送数据        
    522                                 &SampleApp_TransID,
    523                                 AF_DISCV_ROUTE,
    524                                 AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   0001B5                ; Setup parameters for call to function AF_DataRequest
   \   0001B5   75..0F       MOV     ?V0 + 1,#0xf
   \   0001B8   78..         MOV     R0,#?V0 + 1
   \   0001BA   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0001BD   75....       MOV     ?V0 + 2,#SampleApp_TransID & 0xff
   \   0001C0   75....       MOV     ?V0 + 3,#(SampleApp_TransID >> 8) & 0xff
   \   0001C3   78..         MOV     R0,#?V0 + 2
   \   0001C5   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001C8   7403         MOV     A,#0x3
   \   0001CA   12....       LCALL   ?XSTACK_DISP0_8
   \   0001CD   8582..       MOV     ?V0 + 2,DPL
   \   0001D0   8583..       MOV     ?V0 + 3,DPH
   \   0001D3   78..         MOV     R0,#?V0 + 2
   \   0001D5   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001D8   75..01       MOV     ?V0 + 2,#0x1
   \   0001DB   75..00       MOV     ?V0 + 3,#0x0
   \   0001DE   78..         MOV     R0,#?V0 + 2
   \   0001E0   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001E3   75..01       MOV     ?V0 + 2,#0x1
   \   0001E6   75..00       MOV     ?V0 + 3,#0x0
   \   0001E9   78..         MOV     R0,#?V0 + 2
   \   0001EB   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001EE   7920         MOV     R1,#0x20
   \   0001F0   7C..         MOV     R4,#SampleApp_epDesc1 & 0xff
   \   0001F2   7D..         MOV     R5,#(SampleApp_epDesc1 >> 8) & 0xff
   \   0001F4   7A..         MOV     R2,#SampleApp_BIND_DstAddr & 0xff
   \   0001F6   7B..         MOV     R3,#(SampleApp_BIND_DstAddr >> 8) & 0xff
   \   0001F8   12....       LCALL   ??AF_DataRequest?relay
   \   0001FB   7409         MOV     A,#0x9
   \   0001FD   12....       LCALL   ?DEALLOC_XSTACK8
   \   000200   E9           MOV     A,R1
    525                  {
    526                  }
    527                  else
    528                  {
    529                  }
    530                  
    531                 }
    532                        Key_Delay_Flag =1;
   \                     ??SampleApp_HandleKeys_9:
   \   000201   90....       MOV     DPTR,#Key_Delay_Flag
   \   000204   7401         MOV     A,#0x1
   \   000206   F0           MOVX    @DPTR,A
    533                   osal_start_timerEx( UserApp_TaskID,SAMPLEAPP_KEYREALY_EVT,2000);//2000-->500 by zhongls 20151014
   \   000207                ; Setup parameters for call to function osal_start_timerEx
   \   000207   7CD0         MOV     R4,#-0x30
   \   000209   7D07         MOV     R5,#0x7
   \   00020B   7A20         MOV     R2,#0x20
   \   00020D   7B00         MOV     R3,#0x0
   \   00020F   90....       MOV     DPTR,#UserApp_TaskID
   \   000212   E0           MOVX    A,@DPTR
   \   000213   F9           MOV     R1,A
   \   000214   12....       LCALL   ??osal_start_timerEx?relay
   \   000217   E9           MOV     A,R1
    534          #if defined (BELL)         
    535                   osal_start_timerEx( UserApp_TaskID,SAMPLEAPP_OVERMSG_EVT,10000);
   \   000218                ; Setup parameters for call to function osal_start_timerEx
   \   000218   7C10         MOV     R4,#0x10
   \   00021A   7D27         MOV     R5,#0x27
   \   00021C   7A40         MOV     R2,#0x40
   \   00021E   7B00         MOV     R3,#0x0
   \   000220   90....       MOV     DPTR,#UserApp_TaskID
   \   000223   E0           MOVX    A,@DPTR
   \   000224   F9           MOV     R1,A
   \   000225   12....       LCALL   ??osal_start_timerEx?relay
   \   000228   E9           MOV     A,R1
    536          #endif         
    537               }
    538             }
    539            }
    540          keys=0;
   \                     ??SampleApp_HandleKeys_7:
   \   000229   75..00       MOV     ?V0 + 0,#0x0
    541            
    542          }
   \   00022C   740A         MOV     A,#0xa
   \   00022E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000231   7F04         MOV     R7,#0x4
   \   000233   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000236                REQUIRE _A_P0
    543          
    544          
    545          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    546          void SampleApp_ProcessBINDINGMessage(afIncomingMSGPacket_t *pkt)
   \                     SampleApp_ProcessBINDINGMessage:
    547          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    548          
    549            
    550          }
   \   000000   02....       LJMP    ?BRET
    551          
    552          
    553          // 入网后添加函数

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    554          void USER_APP_JOIN_MSG(void)
   \                     USER_APP_JOIN_MSG:
    555          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    556              HalLedBlink ( HAL_LED_1, 1, 99, 2500 );//用BLINK模拟灯亮两秒后熄灭
   \   000005                ; Setup parameters for call to function HalLedBlink
   \   000005   7CC4         MOV     R4,#-0x3c
   \   000007   7D09         MOV     R5,#0x9
   \   000009   7B63         MOV     R3,#0x63
   \   00000B   7A01         MOV     R2,#0x1
   \   00000D   7901         MOV     R1,#0x1
   \   00000F   12....       LCALL   ??HalLedBlink?relay
    557              //NLME_SetPollRate( 2000 );//set the poll rate to quick ,and   
    558              NLME_SetPollRate( 5000 );//set the poll rate to quick ,and       
   \   000012                ; Setup parameters for call to function NLME_SetPollRate
   \   000012   7A88         MOV     R2,#-0x78
   \   000014   7B13         MOV     R3,#0x13
   \   000016   12....       LCALL   ??NLME_SetPollRate?relay
    559           
    560              DEEP_POLL_FLAG =0; 
   \   000019   90....       MOV     DPTR,#DEEP_POLL_FLAG
   \   00001C   7400         MOV     A,#0x0
   \   00001E   F0           MOVX    @DPTR,A
    561              HEART_NEED_ACK_FLAG =0;
   \   00001F   90....       MOV     DPTR,#HEART_NEED_ACK_FLAG
   \   000022   7400         MOV     A,#0x0
   \   000024   F0           MOVX    @DPTR,A
    562              Heart_mesg_count=0;
   \   000025   90....       MOV     DPTR,#Heart_mesg_count
   \   000028   7400         MOV     A,#0x0
   \   00002A   F0           MOVX    @DPTR,A
   \   00002B   A3           INC     DPTR
   \   00002C   7400         MOV     A,#0x0
   \   00002E   F0           MOVX    @DPTR,A
    563              
    564              
    565            
    566              
    567              uint8 *Sample_Cmd_shorAddr;
    568              Sample_Cmd_shorAddr=SampleApp_GetShortAddr();
   \   00002F                ; Setup parameters for call to function SampleApp_GetShortAddr
   \   00002F   12....       LCALL   ??SampleApp_GetShortAddr?relay
   \   000032   8A..         MOV     ?V0 + 0,R2
   \   000034   8B..         MOV     ?V0 + 1,R3
   \   000036   AE..         MOV     R6,?V0 + 0
   \   000038   AF..         MOV     R7,?V0 + 1
    569              SHORT_ADRESS[0]=*Sample_Cmd_shorAddr++;
   \   00003A   8E82         MOV     DPL,R6
   \   00003C   8F83         MOV     DPH,R7
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   90....       MOV     DPTR,#SHORT_ADRESS
   \   000042   F0           MOVX    @DPTR,A
   \   000043   8E82         MOV     DPL,R6
   \   000045   8F83         MOV     DPH,R7
   \   000047   A3           INC     DPTR
   \   000048   AE82         MOV     R6,DPL
   \   00004A   AF83         MOV     R7,DPH
    570              SHORT_ADRESS[1]=*Sample_Cmd_shorAddr++;
   \   00004C   8E82         MOV     DPL,R6
   \   00004E   8F83         MOV     DPH,R7
   \   000050   E0           MOVX    A,@DPTR
   \   000051   90....       MOV     DPTR,#SHORT_ADRESS + 1
   \   000054   F0           MOVX    @DPTR,A
   \   000055   8E82         MOV     DPL,R6
   \   000057   8F83         MOV     DPH,R7
   \   000059   A3           INC     DPTR
   \   00005A   AE82         MOV     R6,DPL
   \   00005C   AF83         MOV     R7,DPH
    571              SHORT_ADRESS[2]=*Sample_Cmd_shorAddr++;
   \   00005E   8E82         MOV     DPL,R6
   \   000060   8F83         MOV     DPH,R7
   \   000062   E0           MOVX    A,@DPTR
   \   000063   90....       MOV     DPTR,#SHORT_ADRESS + 2
   \   000066   F0           MOVX    @DPTR,A
   \   000067   8E82         MOV     DPL,R6
   \   000069   8F83         MOV     DPH,R7
   \   00006B   A3           INC     DPTR
   \   00006C   AE82         MOV     R6,DPL
   \   00006E   AF83         MOV     R7,DPH
    572              SHORT_ADRESS[3]=*Sample_Cmd_shorAddr;
   \   000070   8E82         MOV     DPL,R6
   \   000072   8F83         MOV     DPH,R7
   \   000074   E0           MOVX    A,@DPTR
   \   000075   90....       MOV     DPTR,#SHORT_ADRESS + 3
   \   000078   F0           MOVX    @DPTR,A
    573              osal_mem_free( shortddr_mem );
   \   000079                ; Setup parameters for call to function osal_mem_free
   \   000079   90....       MOV     DPTR,#shortddr_mem
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   FA           MOV     R2,A
   \   00007E   A3           INC     DPTR
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   FB           MOV     R3,A
   \   000081   12....       LCALL   ??osal_mem_free?relay
    574              
    575          
    576            // USER自行添加入网后的操作代码
    577           
    578          }
   \   000084   7F02         MOV     R7,#0x2
   \   000086   02....       LJMP    ?BANKED_LEAVE_XDATA
    579          
    580          
    581          // 收到命令后添加函数
    582          // user_app_data 上位机发过来的有效数据 字母后面开始 13开始
    583          //user_rf_data 需要填入的返回数据数组

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    584          uint8 USER_APP_COMMAND(uint8 *user_app_data,uint8 *str)
   \                     USER_APP_COMMAND:
    585          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    586            uint8 active_len=0;
   \   000005   7900         MOV     R1,#0x0
    587            
    588              str[0] = '/';
   \   000007   8C82         MOV     DPL,R4
   \   000009   8D83         MOV     DPH,R5
   \   00000B   742F         MOV     A,#0x2f
   \   00000D   F0           MOVX    @DPTR,A
    589          
    590             CmdType = user_app_data[0];//窗帘设备命令类型 学习 使用
   \   00000E   8A82         MOV     DPL,R2
   \   000010   8B83         MOV     DPH,R3
   \   000012   E0           MOVX    A,@DPTR
   \   000013   90....       MOV     DPTR,#CmdType
   \   000016   F0           MOVX    @DPTR,A
    591             IRCodeIndex = (user_app_data[1]- '0')*100 +
    592                           (user_app_data[2]- '0')*10 +
    593                           (user_app_data[3]- '0');      //编码序号
   \   000017   8A82         MOV     DPL,R2
   \   000019   8B83         MOV     DPH,R3
   \   00001B   A3           INC     DPTR
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   FE           MOV     R6,A
   \   00001E   7F00         MOV     R7,#0x0
   \   000020   EE           MOV     A,R6
   \   000021   75F064       MOV     B,#0x64
   \   000024   A4           MUL     AB
   \   000025   CE           XCH     A,R6
   \   000026   A8F0         MOV     R0,B
   \   000028   75F000       MOV     B,#0x0
   \   00002B   A4           MUL     AB
   \   00002C   28           ADD     A,R0
   \   00002D   F8           MOV     R0,A
   \   00002E   75F064       MOV     B,#0x64
   \   000031   EF           MOV     A,R7
   \   000032   A4           MUL     AB
   \   000033   28           ADD     A,R0
   \   000034   FF           MOV     R7,A
   \   000035   8A82         MOV     DPL,R2
   \   000037   8B83         MOV     DPH,R3
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   F5..         MOV     ?V0 + 0,A
   \   00003E   75..00       MOV     ?V0 + 1,#0x0
   \   000041   E5..         MOV     A,?V0 + 0
   \   000043   75F00A       MOV     B,#0xa
   \   000046   A4           MUL     AB
   \   000047   C5..         XCH     A,?V0 + 0
   \   000049   A8F0         MOV     R0,B
   \   00004B   75F000       MOV     B,#0x0
   \   00004E   A4           MUL     AB
   \   00004F   28           ADD     A,R0
   \   000050   F8           MOV     R0,A
   \   000051   75F00A       MOV     B,#0xa
   \   000054   E5..         MOV     A,?V0 + 1
   \   000056   A4           MUL     AB
   \   000057   28           ADD     A,R0
   \   000058   F5..         MOV     ?V0 + 1,A
   \   00005A   EE           MOV     A,R6
   \   00005B   25..         ADD     A,?V0 + 0
   \   00005D   FE           MOV     R6,A
   \   00005E   EF           MOV     A,R7
   \   00005F   35..         ADDC    A,?V0 + 1
   \   000061   FF           MOV     R7,A
   \   000062   8A82         MOV     DPL,R2
   \   000064   8B83         MOV     DPH,R3
   \   000066   A3           INC     DPTR
   \   000067   A3           INC     DPTR
   \   000068   A3           INC     DPTR
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   F5..         MOV     ?V0 + 0,A
   \   00006C   75..00       MOV     ?V0 + 1,#0x0
   \   00006F   EE           MOV     A,R6
   \   000070   25..         ADD     A,?V0 + 0
   \   000072   FE           MOV     R6,A
   \   000073   EF           MOV     A,R7
   \   000074   35..         ADDC    A,?V0 + 1
   \   000076   FF           MOV     R7,A
   \   000077   EE           MOV     A,R6
   \   000078   2430         ADD     A,#0x30
   \   00007A   FE           MOV     R6,A
   \   00007B   EF           MOV     A,R7
   \   00007C   34EB         ADDC    A,#-0x15
   \   00007E   FF           MOV     R7,A
   \   00007F   90....       MOV     DPTR,#IRCodeIndex
   \   000082   EE           MOV     A,R6
   \   000083   F0           MOVX    @DPTR,A
   \   000084   A3           INC     DPTR
   \   000085   EF           MOV     A,R7
   \   000086   F0           MOVX    @DPTR,A
    594          
    595          
    596             if('1' == CmdType)		//'1' 表示学习
   \   000087   90....       MOV     DPTR,#CmdType
   \   00008A   E0           MOVX    A,@DPTR
   \   00008B   6431         XRL     A,#0x31
    597             {
    598              
    599               
    600             }
    601             else if('2' == CmdType)	//'2' 表示使用
    602             {   
    603               
    604               
    605             }
    606             str[1] = CmdType - '0';//数据回填
   \   00008D   90....       MOV     DPTR,#CmdType
   \   000090   E0           MOVX    A,@DPTR
   \   000091   24D0         ADD     A,#-0x30
   \   000093   8C82         MOV     DPL,R4
   \   000095   8D83         MOV     DPH,R5
   \   000097   A3           INC     DPTR
   \   000098   F0           MOVX    @DPTR,A
    607             str[3] = IRCodeIndex;//数据回填
   \   000099   90....       MOV     DPTR,#IRCodeIndex
   \   00009C   E0           MOVX    A,@DPTR
   \   00009D   FE           MOV     R6,A
   \   00009E   A3           INC     DPTR
   \   00009F   E0           MOVX    A,@DPTR
   \   0000A0   FF           MOV     R7,A
   \   0000A1   EE           MOV     A,R6
   \   0000A2   8C82         MOV     DPL,R4
   \   0000A4   8D83         MOV     DPH,R5
   \   0000A6   A3           INC     DPTR
   \   0000A7   A3           INC     DPTR
   \   0000A8   A3           INC     DPTR
   \   0000A9   F0           MOVX    @DPTR,A
    608             str[2] = IRCodeIndex >> 8;
   \   0000AA   90....       MOV     DPTR,#IRCodeIndex
   \   0000AD   E0           MOVX    A,@DPTR
   \   0000AE   FE           MOV     R6,A
   \   0000AF   A3           INC     DPTR
   \   0000B0   E0           MOVX    A,@DPTR
   \   0000B1   FF           MOV     R7,A
   \   0000B2   E4           CLR     A
   \   0000B3   EF           MOV     A,R7
   \   0000B4   FE           MOV     R6,A
   \   0000B5   8C82         MOV     DPL,R4
   \   0000B7   8D83         MOV     DPH,R5
   \   0000B9   A3           INC     DPTR
   \   0000BA   A3           INC     DPTR
   \   0000BB   F0           MOVX    @DPTR,A
    609             active_len=13;
   \   0000BC   790D         MOV     R1,#0xd
    610             return active_len;
   \   0000BE   7F02         MOV     R7,#0x2
   \   0000C0   02....       LJMP    ?BANKED_LEAVE_XDATA
    611          }
    612          
    613          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    614          void USER_SET_RS_MSG(void)//用户自行设置RS数据
   \                     USER_SET_RS_MSG:
    615          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    616          #if defined (BELL)  //门铃按钮
    617              DEVICE_ID=175;
   \   000004   90....       MOV     DPTR,#DEVICE_ID
   \   000007   74AF         MOV     A,#-0x51
   \   000009   F0           MOVX    @DPTR,A
    618              DEFINED_CONTROL_CHAR='/';
   \   00000A   90....       MOV     DPTR,#DEFINED_CONTROL_CHAR
   \   00000D   742F         MOV     A,#0x2f
   \   00000F   F0           MOVX    @DPTR,A
    619              RS_STR[0] = BUUTON_STATE;// 确实是报警的;
   \   000010   90....       MOV     DPTR,#BUUTON_STATE
   \   000013   E0           MOVX    A,@DPTR
   \   000014   90....       MOV     DPTR,#RS_STR
   \   000017   F0           MOVX    @DPTR,A
    620              RS_LEN = 1;
   \   000018   90....       MOV     DPTR,#RS_LEN
   \   00001B   7401         MOV     A,#0x1
   \   00001D   F0           MOVX    @DPTR,A
    621          #else 
    622              DEVICE_ID=0x04; //紧急按钮
    623              DEFINED_CONTROL_CHAR='J';
    624              RS_STR[0] = BUUTON_STATE;// 确实是报警的;
    625              RS_LEN = 1;
    626          #endif
    627              JOIN_ROLE=Send_Endvice;
   \   00001E   90....       MOV     DPTR,#JOIN_ROLE
   \   000021   7401         MOV     A,#0x1
   \   000023   F0           MOVX    @DPTR,A
    628              
    629              // 对于电池设备每次RS后面可以跟一个电池有电的标记，如果是有电的话
    630              
    631              active_battery_voltage=myApp_ReadBattery();
   \   000024                ; Setup parameters for call to function myApp_ReadBattery
   \   000024   12....       LCALL   ??myApp_ReadBattery?relay
   \   000027   90....       MOV     DPTR,#active_battery_voltage
   \   00002A   EA           MOV     A,R2
   \   00002B   F0           MOVX    @DPTR,A
   \   00002C   A3           INC     DPTR
   \   00002D   EB           MOV     A,R3
   \   00002E   F0           MOVX    @DPTR,A
    632              
    633              if(active_battery_voltage>265)
   \   00002F   90....       MOV     DPTR,#active_battery_voltage
   \   000032   C3           CLR     C
   \   000033   E0           MOVX    A,@DPTR
   \   000034   940A         SUBB    A,#0xa
   \   000036   A3           INC     DPTR
   \   000037   E0           MOVX    A,@DPTR
   \   000038   9401         SUBB    A,#0x1
   \   00003A   4008         JC      ??USER_SET_RS_MSG_0
    634              {
    635                BUTTERY_ALARM_BIT=0;
   \   00003C   90....       MOV     DPTR,#BUTTERY_ALARM_BIT
   \   00003F   7400         MOV     A,#0x0
   \   000041   F0           MOVX    @DPTR,A
   \   000042   8006         SJMP    ??USER_SET_RS_MSG_1
    636          //      osal_start_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_LOWBUTTERY_EVT,20000 );
    637              }
    638              else
    639              { 
    640                BUTTERY_ALARM_BIT=1;
   \                     ??USER_SET_RS_MSG_0:
   \   000044   90....       MOV     DPTR,#BUTTERY_ALARM_BIT
   \   000047   7401         MOV     A,#0x1
   \   000049   F0           MOVX    @DPTR,A
    641              }
    642                BUTTERY_LOW_FLAG=1;
   \                     ??USER_SET_RS_MSG_1:
   \   00004A   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   00004D   7401         MOV     A,#0x1
   \   00004F   F0           MOVX    @DPTR,A
    643                osal_start_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_LOWBUTTERY_EVT,20000 );
   \   000050                ; Setup parameters for call to function osal_start_timerEx
   \   000050   7C20         MOV     R4,#0x20
   \   000052   7D4E         MOV     R5,#0x4e
   \   000054   7A04         MOV     R2,#0x4
   \   000056   7B00         MOV     R3,#0x0
   \   000058   90....       MOV     DPTR,#UserApp_TaskID
   \   00005B   E0           MOVX    A,@DPTR
   \   00005C   F9           MOV     R1,A
   \   00005D   12....       LCALL   ??osal_start_timerEx?relay
   \   000060   E9           MOV     A,R1
    644          
    645            
    646          }
   \   000061   D083         POP     DPH
   \   000063   D082         POP     DPL
   \   000065   02....       LJMP    ?BRET
    647          
    648          
    649          /*
    650           用户自行规划主动上报数据的格式。
    651          */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    652          void SampleApp_SendInMessage(void)
   \                     SampleApp_SendInMessage:
    653          { 
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
    654            uint8 *send_str;
    655            uint8 send_count=0;
   \   000005   75..00       MOV     ?V0 + 2,#0x0
    656            send_count = 10+3;
   \   000008   75..0D       MOV     ?V0 + 2,#0xd
    657            send_str = osal_mem_alloc(send_count);
   \   00000B                ; Setup parameters for call to function osal_mem_alloc
   \   00000B   85....       MOV     ?V0 + 0,?V0 + 2
   \   00000E   75..00       MOV     ?V0 + 1,#0x0
   \   000011   AA..         MOV     R2,?V0 + 0
   \   000013   AB..         MOV     R3,?V0 + 1
   \   000015   12....       LCALL   ??osal_mem_alloc?relay
   \   000018   8A..         MOV     ?V0 + 0,R2
   \   00001A   8B..         MOV     ?V0 + 1,R3
   \   00001C   AE..         MOV     R6,?V0 + 0
   \   00001E   AF..         MOV     R7,?V0 + 1
    658            
    659            USER_SEND_ADD_STR(send_str);  //\添加固定帧头
   \   000020                ; Setup parameters for call to function USER_SEND_ADD_STR
   \   000020   EE           MOV     A,R6
   \   000021   FA           MOV     R2,A
   \   000022   EF           MOV     A,R7
   \   000023   FB           MOV     R3,A
   \   000024   12....       LCALL   ??USER_SEND_ADD_STR?relay
    660          
    661            if((BUTTERY_LOW_FLAG==1)&&(FRONT_ALARM_FLAG==1))
   \   000027   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   6401         XRL     A,#0x1
   \   00002D   7062         JNZ     ??SampleApp_SendInMessage_0
   \   00002F   90....       MOV     DPTR,#FRONT_ALARM_FLAG
   \   000032   E0           MOVX    A,@DPTR
   \   000033   6401         XRL     A,#0x1
   \   000035   705A         JNZ     ??SampleApp_SendInMessage_0
    662            {
    663             send_str[9]=0xA1; 
   \   000037   8E82         MOV     DPL,R6
   \   000039   8F83         MOV     DPH,R7
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   A3           INC     DPTR
   \   00003F   A3           INC     DPTR
   \   000040   A3           INC     DPTR
   \   000041   A3           INC     DPTR
   \   000042   A3           INC     DPTR
   \   000043   A3           INC     DPTR
   \   000044   74A1         MOV     A,#-0x5f
   \   000046   F0           MOVX    @DPTR,A
    664              send_str[10]=3;//3代表 电池告警和防拆同时存在标记位
   \   000047   8E82         MOV     DPL,R6
   \   000049   8F83         MOV     DPH,R7
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   A3           INC     DPTR
   \   00004E   A3           INC     DPTR
   \   00004F   A3           INC     DPTR
   \   000050   A3           INC     DPTR
   \   000051   A3           INC     DPTR
   \   000052   A3           INC     DPTR
   \   000053   A3           INC     DPTR
   \   000054   A3           INC     DPTR
   \   000055   7403         MOV     A,#0x3
   \   000057   F0           MOVX    @DPTR,A
    665              send_str[11]=BUTTERY_LOW_FLAG+FRONT_ALARM_FLAG;
   \   000058   90....       MOV     DPTR,#FRONT_ALARM_FLAG
   \   00005B   C082         PUSH    DPL
   \   00005D   C083         PUSH    DPH
   \   00005F   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   000062   E0           MOVX    A,@DPTR
   \   000063   D083         POP     DPH
   \   000065   D082         POP     DPL
   \   000067   F8           MOV     R0,A
   \   000068   E0           MOVX    A,@DPTR
   \   000069   28           ADD     A,R0
   \   00006A   C0E0         PUSH    A
   \   00006C   EE           MOV     A,R6
   \   00006D   240B         ADD     A,#0xb
   \   00006F   F582         MOV     DPL,A
   \   000071   EF           MOV     A,R7
   \   000072   3400         ADDC    A,#0x0
   \   000074   F583         MOV     DPH,A
   \   000076   D0E0         POP     A
   \   000078   F0           MOVX    @DPTR,A
    666              BUTTERY_LOW_FLAG = 0;
   \   000079   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   00007C   7400         MOV     A,#0x0
   \   00007E   F0           MOVX    @DPTR,A
    667              FRONT_ALARM_FLAG = 0;
   \   00007F   90....       MOV     DPTR,#FRONT_ALARM_FLAG
   \   000082   7400         MOV     A,#0x0
   \   000084   F0           MOVX    @DPTR,A
    668              USER_APP_SEND_IN(12,send_str);//发送出数据 
   \   000085                ; Setup parameters for call to function USER_APP_SEND_IN
   \   000085   EE           MOV     A,R6
   \   000086   FA           MOV     R2,A
   \   000087   EF           MOV     A,R7
   \   000088   FB           MOV     R3,A
   \   000089   790C         MOV     R1,#0xc
   \   00008B   12....       LCALL   ??USER_APP_SEND_IN?relay
   \   00008E   02....       LJMP    ??SampleApp_SendInMessage_1 & 0xFFFF
    669              
    670            }
    671            
    672             else if(BUTTERY_LOW_FLAG==1)
   \                     ??SampleApp_SendInMessage_0:
   \   000091   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   000094   E0           MOVX    A,@DPTR
   \   000095   6401         XRL     A,#0x1
   \   000097   7046         JNZ     ??SampleApp_SendInMessage_2
    673             {  
    674              send_str[9]=0xA1; 
   \   000099   8E82         MOV     DPL,R6
   \   00009B   8F83         MOV     DPH,R7
   \   00009D   A3           INC     DPTR
   \   00009E   A3           INC     DPTR
   \   00009F   A3           INC     DPTR
   \   0000A0   A3           INC     DPTR
   \   0000A1   A3           INC     DPTR
   \   0000A2   A3           INC     DPTR
   \   0000A3   A3           INC     DPTR
   \   0000A4   A3           INC     DPTR
   \   0000A5   A3           INC     DPTR
   \   0000A6   74A1         MOV     A,#-0x5f
   \   0000A8   F0           MOVX    @DPTR,A
    675              send_str[10]=1;//1代表 电池告警标记位
   \   0000A9   8E82         MOV     DPL,R6
   \   0000AB   8F83         MOV     DPH,R7
   \   0000AD   A3           INC     DPTR
   \   0000AE   A3           INC     DPTR
   \   0000AF   A3           INC     DPTR
   \   0000B0   A3           INC     DPTR
   \   0000B1   A3           INC     DPTR
   \   0000B2   A3           INC     DPTR
   \   0000B3   A3           INC     DPTR
   \   0000B4   A3           INC     DPTR
   \   0000B5   A3           INC     DPTR
   \   0000B6   A3           INC     DPTR
   \   0000B7   7401         MOV     A,#0x1
   \   0000B9   F0           MOVX    @DPTR,A
    676              send_str[11]=BUTTERY_ALARM_BIT;//1; //代表 电池告警事件
   \   0000BA   90....       MOV     DPTR,#BUTTERY_ALARM_BIT
   \   0000BD   E0           MOVX    A,@DPTR
   \   0000BE   C0E0         PUSH    A
   \   0000C0   EE           MOV     A,R6
   \   0000C1   240B         ADD     A,#0xb
   \   0000C3   F582         MOV     DPL,A
   \   0000C5   EF           MOV     A,R7
   \   0000C6   3400         ADDC    A,#0x0
   \   0000C8   F583         MOV     DPH,A
   \   0000CA   D0E0         POP     A
   \   0000CC   F0           MOVX    @DPTR,A
    677              BUTTERY_LOW_FLAG = 0;
   \   0000CD   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   0000D0   7400         MOV     A,#0x0
   \   0000D2   F0           MOVX    @DPTR,A
    678              USER_APP_SEND_IN(12,send_str);//发送出数据
   \   0000D3                ; Setup parameters for call to function USER_APP_SEND_IN
   \   0000D3   EE           MOV     A,R6
   \   0000D4   FA           MOV     R2,A
   \   0000D5   EF           MOV     A,R7
   \   0000D6   FB           MOV     R3,A
   \   0000D7   790C         MOV     R1,#0xc
   \   0000D9   12....       LCALL   ??USER_APP_SEND_IN?relay
   \   0000DC   02....       LJMP    ??SampleApp_SendInMessage_1 & 0xFFFF
    679             }
    680             else if(FRONT_ALARM_FLAG==1)
   \                     ??SampleApp_SendInMessage_2:
   \   0000DF   90....       MOV     DPTR,#FRONT_ALARM_FLAG
   \   0000E2   E0           MOVX    A,@DPTR
   \   0000E3   6401         XRL     A,#0x1
   \   0000E5   7045         JNZ     ??SampleApp_SendInMessage_3
    681             {  
    682              send_str[9]=0xA1; 
   \   0000E7   8E82         MOV     DPL,R6
   \   0000E9   8F83         MOV     DPH,R7
   \   0000EB   A3           INC     DPTR
   \   0000EC   A3           INC     DPTR
   \   0000ED   A3           INC     DPTR
   \   0000EE   A3           INC     DPTR
   \   0000EF   A3           INC     DPTR
   \   0000F0   A3           INC     DPTR
   \   0000F1   A3           INC     DPTR
   \   0000F2   A3           INC     DPTR
   \   0000F3   A3           INC     DPTR
   \   0000F4   74A1         MOV     A,#-0x5f
   \   0000F6   F0           MOVX    @DPTR,A
    683              send_str[10]=2;//1代表 
   \   0000F7   8E82         MOV     DPL,R6
   \   0000F9   8F83         MOV     DPH,R7
   \   0000FB   A3           INC     DPTR
   \   0000FC   A3           INC     DPTR
   \   0000FD   A3           INC     DPTR
   \   0000FE   A3           INC     DPTR
   \   0000FF   A3           INC     DPTR
   \   000100   A3           INC     DPTR
   \   000101   A3           INC     DPTR
   \   000102   A3           INC     DPTR
   \   000103   A3           INC     DPTR
   \   000104   A3           INC     DPTR
   \   000105   7402         MOV     A,#0x2
   \   000107   F0           MOVX    @DPTR,A
    684              send_str[11]=FRONT_ALARM_BIT;
   \   000108   90....       MOV     DPTR,#FRONT_ALARM_BIT
   \   00010B   E0           MOVX    A,@DPTR
   \   00010C   C0E0         PUSH    A
   \   00010E   EE           MOV     A,R6
   \   00010F   240B         ADD     A,#0xb
   \   000111   F582         MOV     DPL,A
   \   000113   EF           MOV     A,R7
   \   000114   3400         ADDC    A,#0x0
   \   000116   F583         MOV     DPH,A
   \   000118   D0E0         POP     A
   \   00011A   F0           MOVX    @DPTR,A
    685              FRONT_ALARM_FLAG = 0;
   \   00011B   90....       MOV     DPTR,#FRONT_ALARM_FLAG
   \   00011E   7400         MOV     A,#0x0
   \   000120   F0           MOVX    @DPTR,A
    686              USER_APP_SEND_IN(12,send_str);//发送出数据
   \   000121                ; Setup parameters for call to function USER_APP_SEND_IN
   \   000121   EE           MOV     A,R6
   \   000122   FA           MOV     R2,A
   \   000123   EF           MOV     A,R7
   \   000124   FB           MOV     R3,A
   \   000125   790C         MOV     R1,#0xc
   \   000127   12....       LCALL   ??USER_APP_SEND_IN?relay
   \   00012A   8041         SJMP    ??SampleApp_SendInMessage_1
    687             } 
    688             else
    689             {
    690          #if defined (BELL)     
    691               
    692               send_str[9]='/';
   \                     ??SampleApp_SendInMessage_3:
   \   00012C   8E82         MOV     DPL,R6
   \   00012E   8F83         MOV     DPH,R7
   \   000130   A3           INC     DPTR
   \   000131   A3           INC     DPTR
   \   000132   A3           INC     DPTR
   \   000133   A3           INC     DPTR
   \   000134   A3           INC     DPTR
   \   000135   A3           INC     DPTR
   \   000136   A3           INC     DPTR
   \   000137   A3           INC     DPTR
   \   000138   A3           INC     DPTR
   \   000139   742F         MOV     A,#0x2f
   \   00013B   F0           MOVX    @DPTR,A
    693               //send_str[10]= BUUTON_STATE;去掉，改成下面if else 语句为实时上报数据
    694               
    695               if(P0_5==0)
   \   00013C   A285         MOV     C,0x80.5
   \   00013E   4013         JC      ??SampleApp_SendInMessage_4
    696                 send_str[10]=1;
   \   000140   8E82         MOV     DPL,R6
   \   000142   8F83         MOV     DPH,R7
   \   000144   A3           INC     DPTR
   \   000145   A3           INC     DPTR
   \   000146   A3           INC     DPTR
   \   000147   A3           INC     DPTR
   \   000148   A3           INC     DPTR
   \   000149   A3           INC     DPTR
   \   00014A   A3           INC     DPTR
   \   00014B   A3           INC     DPTR
   \   00014C   A3           INC     DPTR
   \   00014D   A3           INC     DPTR
   \   00014E   7401         MOV     A,#0x1
   \   000150   F0           MOVX    @DPTR,A
   \   000151   8011         SJMP    ??SampleApp_SendInMessage_5
    697               else 
    698                 send_str[10]=0;
   \                     ??SampleApp_SendInMessage_4:
   \   000153   8E82         MOV     DPL,R6
   \   000155   8F83         MOV     DPH,R7
   \   000157   A3           INC     DPTR
   \   000158   A3           INC     DPTR
   \   000159   A3           INC     DPTR
   \   00015A   A3           INC     DPTR
   \   00015B   A3           INC     DPTR
   \   00015C   A3           INC     DPTR
   \   00015D   A3           INC     DPTR
   \   00015E   A3           INC     DPTR
   \   00015F   A3           INC     DPTR
   \   000160   A3           INC     DPTR
   \   000161   7400         MOV     A,#0x0
   \   000163   F0           MOVX    @DPTR,A
    699               
    700               USER_APP_SEND_IN(11,send_str);//发送出数据
   \                     ??SampleApp_SendInMessage_5:
   \   000164                ; Setup parameters for call to function USER_APP_SEND_IN
   \   000164   EE           MOV     A,R6
   \   000165   FA           MOV     R2,A
   \   000166   EF           MOV     A,R7
   \   000167   FB           MOV     R3,A
   \   000168   790B         MOV     R1,#0xb
   \   00016A   12....       LCALL   ??USER_APP_SEND_IN?relay
    701               
    702          #else
    703          
    704               send_str[9]='J';
    705              // send_str[10]= BUUTON_STATE;去掉，改成下面if else 语句为实时上报数据
    706               if(P0_5==0)
    707                 send_str[10]=1;
    708               else 
    709                 send_str[10]=0;
    710               
    711               send_str[11]= 0;
    712               send_str[12]= 0;
    713               //ACK_FLAG = 1;
    714               USER_APP_SEND_IN(13,send_str);//发送出数据
    715               //NLME_SetPollRate( 1000 );
    716          #endif     
    717             }   
    718          
    719            osal_mem_free( send_str );
   \                     ??SampleApp_SendInMessage_1:
   \   00016D                ; Setup parameters for call to function osal_mem_free
   \   00016D   EE           MOV     A,R6
   \   00016E   FA           MOV     R2,A
   \   00016F   EF           MOV     A,R7
   \   000170   FB           MOV     R3,A
   \   000171   12....       LCALL   ??osal_mem_free?relay
    720          }
   \   000174   7F03         MOV     R7,#0x3
   \   000176   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   000179                REQUIRE _A_P0
    721          
    722          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    723          void User_APP_Drive_init(void)
   \                     User_APP_Drive_init:
    724          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    725            HAL_IO_CONFIG_INIT();
   \   000000   43FE01       ORL     0xfe,#0x1
   \   000003   D290         SETB    0x90.0
   \   000005   43FD40       ORL     0xfd,#0x40
   \   000008   D286         SETB    0x80.6
   \   00000A   43F604       ORL     0xf6,#0x4
   \   00000D   438F20       ORL     0x8f,#0x20
   \   000010   43F620       ORL     0xf6,#0x20
    726          
    727            //P1INP |= HAL_KEY_SW_9_BIT;
    728            //P1INP |= HAL_KEY_SW_8_BIT;
    729            
    730          }
   \   000013   02....       LJMP    ?BRET
   \   000016                REQUIRE P1DIR
   \   000016                REQUIRE _A_P1
   \   000016                REQUIRE P0DIR
   \   000016                REQUIRE _A_P0
   \   000016                REQUIRE P1INP
   \   000016                REQUIRE P0INP
    731          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    732          uint8 READ_NETKEY() //读取入网状态按键的状态传递到应用层
   \                     READ_NETKEY:
    733          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    734          
    735            return HAL_PUSH_BUTTON1();
   \   000000   A292         MOV     C,0x90.2
   \   000002   E4           CLR     A
   \   000003   33           RLC     A
   \   000004   F9           MOV     R1,A
   \   000005   02....       LJMP    ?BRET
   \   000008                REQUIRE _A_P1
    736          }
    737          
    738          
    739          
    740          /*
    741          mode 0 关
    742          1 开
    743          2 切换
    744          */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    745          void LED_CHANGE(uint8 Position,uint8 Mode)// 设置LED函数
   \                     LED_CHANGE:
    746          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    747           switch (Position )
   \   000000   E9           MOV     A,R1
   \   000001   14           DEC     A
   \   000002   6018         JZ      ??LED_CHANGE_0
   \   000004   14           DEC     A
   \   000005   603F         JZ      ??LED_CHANGE_1
   \   000007   24FE         ADD     A,#-0x2
   \   000009   6064         JZ      ??LED_CHANGE_2
   \   00000B   24FC         ADD     A,#-0x4
   \   00000D   7003         JNZ     $+5
   \   00000F   02....       LJMP    ??LED_CHANGE_3 & 0xFFFF
   \   000012   24F8         ADD     A,#-0x8
   \   000014   7003         JNZ     $+5
   \   000016   02....       LJMP    ??LED_CHANGE_4 & 0xFFFF
   \   000019   02....       LJMP    ??LED_CHANGE_5 & 0xFFFF
    748              {
    749                case HAL_LED_1:      
    750                  {
    751                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_0:
   \   00001C   EA           MOV     A,R2
   \   00001D   6005         JZ      ??LED_CHANGE_6
   \   00001F   7401         MOV     A,#0x1
   \   000021   6A           XRL     A,R2
   \   000022   7010         JNZ     ??LED_CHANGE_7
    752                   {
    753                    LED1_SBIT = LED1_POLARITY(Mode);
   \                     ??LED_CHANGE_6:
   \   000024   EA           MOV     A,R2
   \   000025   7004         JNZ     ??LED_CHANGE_8
   \   000027   7801         MOV     R0,#0x1
   \   000029   8002         SJMP    ??LED_CHANGE_9
   \                     ??LED_CHANGE_8:
   \   00002B   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_9:
   \   00002D   E8           MOV     A,R0
   \   00002E   A2E0         MOV     C,0xE0 /* A   */.0
   \   000030   9290         MOV     0x90.0,C
   \   000032   800F         SJMP    ??LED_CHANGE_10
    754                   }
    755                   else if(Mode==2)
   \                     ??LED_CHANGE_7:
   \   000034   7402         MOV     A,#0x2
   \   000036   6A           XRL     A,R2
   \   000037   700A         JNZ     ??LED_CHANGE_10
    756                   {
    757                    if (LED1_SBIT) 
   \   000039   A290         MOV     C,0x90.0
   \   00003B   5004         JNC     ??LED_CHANGE_11
    758                    { 
    759                      LED1_SBIT = 0; 
   \   00003D   C290         CLR     0x90.0
   \   00003F   8002         SJMP    ??LED_CHANGE_10
    760                    } 
    761                    else 
    762                    { 
    763                      LED1_SBIT = 1;
   \                     ??LED_CHANGE_11:
   \   000041   D290         SETB    0x90.0
    764                    } 
    765                   }
    766                  }   
    767                  break;     
   \                     ??LED_CHANGE_10:
   \   000043   02....       LJMP    ??LED_CHANGE_5 & 0xFFFF
    768                  
    769                  case HAL_LED_2:      
    770                  {
    771                   if(Mode==0||Mode==1)
   \                     ??LED_CHANGE_1:
   \   000046   EA           MOV     A,R2
   \   000047   6005         JZ      ??LED_CHANGE_12
   \   000049   7401         MOV     A,#0x1
   \   00004B   6A           XRL     A,R2
   \   00004C   7010         JNZ     ??LED_CHANGE_13
    772                   {
    773                    LED2_SBIT = LED2_POLARITY(Mode);
   \                     ??LED_CHANGE_12:
   \   00004E   EA           MOV     A,R2
   \   00004F   7004         JNZ     ??LED_CHANGE_14
   \   000051   7801         MOV     R0,#0x1
   \   000053   8002         SJMP    ??LED_CHANGE_15
   \                     ??LED_CHANGE_14:
   \   000055   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_15:
   \   000057   E8           MOV     A,R0
   \   000058   A2E0         MOV     C,0xE0 /* A   */.0
   \   00005A   9286         MOV     0x80.6,C
   \   00005C   800F         SJMP    ??LED_CHANGE_16
    774                   }
    775                   else if(Mode==2)
   \                     ??LED_CHANGE_13:
   \   00005E   7402         MOV     A,#0x2
   \   000060   6A           XRL     A,R2
   \   000061   700A         JNZ     ??LED_CHANGE_16
    776                   {
    777                    if (LED1_SBIT) 
   \   000063   A290         MOV     C,0x90.0
   \   000065   5004         JNC     ??LED_CHANGE_17
    778                    { 
    779                      LED2_SBIT = 0; 
   \   000067   C286         CLR     0x80.6
   \   000069   807D         SJMP    ??LED_CHANGE_5
    780                    } 
    781                    else 
    782                    { 
    783                      LED2_SBIT = 1;
   \                     ??LED_CHANGE_17:
   \   00006B   D286         SETB    0x80.6
    784                    } 
    785                   }
    786                  }   
    787                  break;     
   \                     ??LED_CHANGE_16:
   \   00006D   8079         SJMP    ??LED_CHANGE_5
    788                  
    789                  case HAL_LED_3:      
    790                  {
    791                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_2:
   \   00006F   EA           MOV     A,R2
   \   000070   6005         JZ      ??LED_CHANGE_18
   \   000072   7401         MOV     A,#0x1
   \   000074   6A           XRL     A,R2
   \   000075   7010         JNZ     ??LED_CHANGE_19
    792                   {
    793                    LED3_SBIT = LED3_POLARITY(Mode);
   \                     ??LED_CHANGE_18:
   \   000077   EA           MOV     A,R2
   \   000078   7004         JNZ     ??LED_CHANGE_20
   \   00007A   7801         MOV     R0,#0x1
   \   00007C   8002         SJMP    ??LED_CHANGE_21
   \                     ??LED_CHANGE_20:
   \   00007E   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_21:
   \   000080   E8           MOV     A,R0
   \   000081   A2E0         MOV     C,0xE0 /* A   */.0
   \   000083   9286         MOV     0x80.6,C
   \   000085   8061         SJMP    ??LED_CHANGE_5
    794                   }
    795                   else if(Mode==2)
   \                     ??LED_CHANGE_19:
   \   000087   7402         MOV     A,#0x2
   \   000089   6A           XRL     A,R2
   \   00008A   705C         JNZ     ??LED_CHANGE_5
    796                   {
    797                    if (LED3_SBIT) 
   \   00008C   A286         MOV     C,0x80.6
   \   00008E   5004         JNC     ??LED_CHANGE_22
    798                    { 
    799                      LED3_SBIT = 0; 
   \   000090   C286         CLR     0x80.6
   \   000092   8054         SJMP    ??LED_CHANGE_5
    800                    } 
    801                    else 
    802                    { 
    803                      LED3_SBIT = 1;
   \                     ??LED_CHANGE_22:
   \   000094   D286         SETB    0x80.6
    804                    } 
    805                   }
    806                  }   
    807                  break;  
   \   000096   8050         SJMP    ??LED_CHANGE_5
    808                  
    809                    case HAL_LED_4:      
    810                  {
    811                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_3:
   \   000098   EA           MOV     A,R2
   \   000099   6005         JZ      ??LED_CHANGE_23
   \   00009B   7401         MOV     A,#0x1
   \   00009D   6A           XRL     A,R2
   \   00009E   7010         JNZ     ??LED_CHANGE_24
    812                   {
    813                    LED4_SBIT = LED4_POLARITY(Mode);
   \                     ??LED_CHANGE_23:
   \   0000A0   EA           MOV     A,R2
   \   0000A1   7004         JNZ     ??LED_CHANGE_25
   \   0000A3   7801         MOV     R0,#0x1
   \   0000A5   8002         SJMP    ??LED_CHANGE_26
   \                     ??LED_CHANGE_25:
   \   0000A7   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_26:
   \   0000A9   E8           MOV     A,R0
   \   0000AA   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000AC   9286         MOV     0x80.6,C
   \   0000AE   8038         SJMP    ??LED_CHANGE_5
    814                   }
    815                   else if(Mode==2)
   \                     ??LED_CHANGE_24:
   \   0000B0   7402         MOV     A,#0x2
   \   0000B2   6A           XRL     A,R2
   \   0000B3   7033         JNZ     ??LED_CHANGE_5
    816                   {
    817                    if (LED4_SBIT) 
   \   0000B5   A286         MOV     C,0x80.6
   \   0000B7   5004         JNC     ??LED_CHANGE_27
    818                    { 
    819                      LED4_SBIT = 0; 
   \   0000B9   C286         CLR     0x80.6
   \   0000BB   802B         SJMP    ??LED_CHANGE_5
    820                    } 
    821                    else 
    822                    { 
    823                      LED4_SBIT = 1;
   \                     ??LED_CHANGE_27:
   \   0000BD   D286         SETB    0x80.6
    824                    } 
    825                   }
    826                  }   
    827                  break;
   \   0000BF   8027         SJMP    ??LED_CHANGE_5
    828                  
    829                    case HAL_LED_5:      
    830                  {
    831                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_4:
   \   0000C1   EA           MOV     A,R2
   \   0000C2   6005         JZ      ??LED_CHANGE_28
   \   0000C4   7401         MOV     A,#0x1
   \   0000C6   6A           XRL     A,R2
   \   0000C7   7010         JNZ     ??LED_CHANGE_29
    832                   {
    833                    LED5_SBIT = LED5_POLARITY(Mode);
   \                     ??LED_CHANGE_28:
   \   0000C9   EA           MOV     A,R2
   \   0000CA   7004         JNZ     ??LED_CHANGE_30
   \   0000CC   7801         MOV     R0,#0x1
   \   0000CE   8002         SJMP    ??LED_CHANGE_31
   \                     ??LED_CHANGE_30:
   \   0000D0   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_31:
   \   0000D2   E8           MOV     A,R0
   \   0000D3   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000D5   9286         MOV     0x80.6,C
   \   0000D7   800F         SJMP    ??LED_CHANGE_5
    834                   }
    835                   else if(Mode==2)
   \                     ??LED_CHANGE_29:
   \   0000D9   7402         MOV     A,#0x2
   \   0000DB   6A           XRL     A,R2
   \   0000DC   700A         JNZ     ??LED_CHANGE_5
    836                   {
    837                    if (LED5_SBIT) 
   \   0000DE   A286         MOV     C,0x80.6
   \   0000E0   5004         JNC     ??LED_CHANGE_32
    838                    { 
    839                      LED5_SBIT = 0; 
   \   0000E2   C286         CLR     0x80.6
   \   0000E4   8002         SJMP    ??LED_CHANGE_5
    840                    } 
    841                    else 
    842                    { 
    843                      LED5_SBIT = 1;
   \                     ??LED_CHANGE_32:
   \   0000E6   D286         SETB    0x80.6
    844                    } 
    845                   }
    846                  }   
    847                  break;
    848          
    849              default:
    850                break;
    851              }
    852          }
   \                     ??LED_CHANGE_5:
   \   0000E8   02....       LJMP    ?BRET
   \   0000EB                REQUIRE _A_P1
   \   0000EB                REQUIRE _A_P0
    853          
    854          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    855          void USER_ZDO_JOINING_MSG(void)
   \                     USER_ZDO_JOINING_MSG:
    856          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    857           HalLedBlink ( HAL_LED_1, 1, 30, 500 );
   \   000004                ; Setup parameters for call to function HalLedBlink
   \   000004   7CF4         MOV     R4,#-0xc
   \   000006   7D01         MOV     R5,#0x1
   \   000008   7B1E         MOV     R3,#0x1e
   \   00000A   7A01         MOV     R2,#0x1
   \   00000C   7901         MOV     R1,#0x1
   \   00000E   12....       LCALL   ??HalLedBlink?relay
    858          }
   \   000011   D083         POP     DPH
   \   000013   D082         POP     DPL
   \   000015   02....       LJMP    ?BRET
    859          //RS后面是否要处理相关事件或者应用，在此进行处理

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    860          void USER_AFTER_RS_MSG(void)
   \                     USER_AFTER_RS_MSG:
    861          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    862          
    863          
    864          }
   \   000000   02....       LJMP    ?BRET
    865          
    866          
    867          //跟随心跳1分钟一次，可以用来做电池检测，如果需要的话

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    868          void USER_MAYBE_BUTTERY_MSG(void)
   \                     USER_MAYBE_BUTTERY_MSG:
    869          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    870               if(Heart_mesg_count%60==0) //1小时使用ACK一次，如果失败了则重新入网 gai 30
   \   000005   90....       MOV     DPTR,#Heart_mesg_count
   \   000008   E0           MOVX    A,@DPTR
   \   000009   F8           MOV     R0,A
   \   00000A   A3           INC     DPTR
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   7A3C         MOV     R2,#0x3c
   \   00000F   7B00         MOV     R3,#0x0
   \   000011   12....       LCALL   ?US_DIV_MOD
   \   000014   8A..         MOV     ?V0 + 0,R2
   \   000016   8B..         MOV     ?V0 + 1,R3
   \   000018   E5..         MOV     A,?V0 + 0
   \   00001A   45..         ORL     A,?V0 + 1
   \   00001C   704D         JNZ     ??USER_MAYBE_BUTTERY_MSG_0
    871                {
    872                    HEART_NEED_ACK_FLAG =1;
   \   00001E   90....       MOV     DPTR,#HEART_NEED_ACK_FLAG
   \   000021   7401         MOV     A,#0x1
   \   000023   F0           MOVX    @DPTR,A
    873                    active_battery_voltage=myApp_ReadBattery();
   \   000024                ; Setup parameters for call to function myApp_ReadBattery
   \   000024   12....       LCALL   ??myApp_ReadBattery?relay
   \   000027   90....       MOV     DPTR,#active_battery_voltage
   \   00002A   EA           MOV     A,R2
   \   00002B   F0           MOVX    @DPTR,A
   \   00002C   A3           INC     DPTR
   \   00002D   EB           MOV     A,R3
   \   00002E   F0           MOVX    @DPTR,A
    874                    
    875                    if(active_battery_voltage<=265)
   \   00002F   90....       MOV     DPTR,#active_battery_voltage
   \   000032   C3           CLR     C
   \   000033   E0           MOVX    A,@DPTR
   \   000034   940A         SUBB    A,#0xa
   \   000036   A3           INC     DPTR
   \   000037   E0           MOVX    A,@DPTR
   \   000038   9401         SUBB    A,#0x1
   \   00003A   5029         JNC     ??USER_MAYBE_BUTTERY_MSG_1
    876                    {
    877                      if( (devState==DEV_END_DEVICE) || (devState==DEV_ROUTER) )
   \   00003C   90....       MOV     DPTR,#devState
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   6406         XRL     A,#0x6
   \   000042   6008         JZ      ??USER_MAYBE_BUTTERY_MSG_2
   \   000044   90....       MOV     DPTR,#devState
   \   000047   E0           MOVX    A,@DPTR
   \   000048   6407         XRL     A,#0x7
   \   00004A   701F         JNZ     ??USER_MAYBE_BUTTERY_MSG_0
    878                      {
    879                      BUTTERY_ALARM_BIT=1;
   \                     ??USER_MAYBE_BUTTERY_MSG_2:
   \   00004C   90....       MOV     DPTR,#BUTTERY_ALARM_BIT
   \   00004F   7401         MOV     A,#0x1
   \   000051   F0           MOVX    @DPTR,A
    880                      osal_start_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_LOWBUTTERY_EVT,
    881                                        20000 );
   \   000052                ; Setup parameters for call to function osal_start_timerEx
   \   000052   7C20         MOV     R4,#0x20
   \   000054   7D4E         MOV     R5,#0x4e
   \   000056   7A04         MOV     R2,#0x4
   \   000058   7B00         MOV     R3,#0x0
   \   00005A   90....       MOV     DPTR,#UserApp_TaskID
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F9           MOV     R1,A
   \   00005F   12....       LCALL   ??osal_start_timerEx?relay
   \   000062   E9           MOV     A,R1
   \   000063   8006         SJMP    ??USER_MAYBE_BUTTERY_MSG_0
    882                      }
    883                      
    884                    }
    885                    else
    886                    {
    887                      BUTTERY_ALARM_BIT=0;
   \                     ??USER_MAYBE_BUTTERY_MSG_1:
   \   000065   90....       MOV     DPTR,#BUTTERY_ALARM_BIT
   \   000068   7400         MOV     A,#0x0
   \   00006A   F0           MOVX    @DPTR,A
    888                    }
    889                   
    890                 }
    891                Heart_mesg_count++;
   \                     ??USER_MAYBE_BUTTERY_MSG_0:
   \   00006B   90....       MOV     DPTR,#Heart_mesg_count
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   2401         ADD     A,#0x1
   \   000071   F0           MOVX    @DPTR,A
   \   000072   A3           INC     DPTR
   \   000073   E0           MOVX    A,@DPTR
   \   000074   3400         ADDC    A,#0x0
   \   000076   F0           MOVX    @DPTR,A
    892           
    893          }
   \   000077   7F02         MOV     R7,#0x2
   \   000079   02....       LJMP    ?BANKED_LEAVE_XDATA
    894          
    895          
    896          // 入网成功后，进入正常模式后设置设备的POLL RATE时间,红外人体修改为10S，维持半分钟

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    897          void USER_SET_NOMAL_POLL_TIME(void)
   \                     USER_SET_NOMAL_POLL_TIME:
    898          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    899            NORMAL_POLL_TIME=18000;
   \   000004   90....       MOV     DPTR,#NORMAL_POLL_TIME
   \   000007   7450         MOV     A,#0x50
   \   000009   F0           MOVX    @DPTR,A
   \   00000A   A3           INC     DPTR
   \   00000B   7446         MOV     A,#0x46
   \   00000D   F0           MOVX    @DPTR,A
    900           
    901            //poll_count=0;
    902            //osal_start_timerEx( UserApp_TaskID, RE_SET_POLL_EVT,60000);//10分钟
    903          } 
   \   00000E   D083         POP     DPH
   \   000010   D082         POP     DPL
   \   000012   02....       LJMP    ?BRET
    904          
    905          
    906          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    907          void SampleAPP_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg )
   \                     SampleAPP_ProcessZDOMsgs:
    908          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    909            switch ( inMsg->clusterID )
   \   000009   EE           MOV     A,R6
   \   00000A   240C         ADD     A,#0xc
   \   00000C   F582         MOV     DPL,A
   \   00000E   EF           MOV     A,R7
   \   00000F   3400         ADDC    A,#0x0
   \   000011   F583         MOV     DPH,A
   \   000013   E0           MOVX    A,@DPTR
   \   000014   6420         XRL     A,#0x20
   \   000016   7004         JNZ     ??SampleAPP_ProcessZDOMsgs_0
   \   000018   A3           INC     DPTR
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   6480         XRL     A,#0x80
   \                     ??SampleAPP_ProcessZDOMsgs_0:
   \   00001C   7031         JNZ     ??SampleAPP_ProcessZDOMsgs_1
    910            {
    911              case End_Device_Bind_rsp:
    912                if ( ZDO_ParseBindRsp( inMsg ) == ZSuccess )
   \   00001E   EE           MOV     A,R6
   \   00001F   2413         ADD     A,#0x13
   \   000021   F582         MOV     DPL,A
   \   000023   EF           MOV     A,R7
   \   000024   3400         ADDC    A,#0x0
   \   000026   F583         MOV     DPH,A
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F8           MOV     R0,A
   \   00002A   A3           INC     DPTR
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F583         MOV     DPH,A
   \   00002E   8882         MOV     DPL,R0
   \   000030   E0           MOVX    A,@DPTR
   \   000031   700F         JNZ     ??SampleAPP_ProcessZDOMsgs_2
    913                {
    914                 HalLedBlink ( HAL_LED_1, 3, 50, 1000 );
   \   000033                ; Setup parameters for call to function HalLedBlink
   \   000033   7CE8         MOV     R4,#-0x18
   \   000035   7D03         MOV     R5,#0x3
   \   000037   7B32         MOV     R3,#0x32
   \   000039   7A03         MOV     R2,#0x3
   \   00003B   7901         MOV     R1,#0x1
   \   00003D   12....       LCALL   ??HalLedBlink?relay
   \   000040   800D         SJMP    ??SampleAPP_ProcessZDOMsgs_1
    915                }
    916          
    917                else
    918                {
    919                  HalLedBlink ( HAL_LED_1, 6, 50, 500 );
   \                     ??SampleAPP_ProcessZDOMsgs_2:
   \   000042                ; Setup parameters for call to function HalLedBlink
   \   000042   7CF4         MOV     R4,#-0xc
   \   000044   7D01         MOV     R5,#0x1
   \   000046   7B32         MOV     R3,#0x32
   \   000048   7A06         MOV     R2,#0x6
   \   00004A   7901         MOV     R1,#0x1
   \   00004C   12....       LCALL   ??HalLedBlink?relay
    920                }
    921                break;
    922            }
    923           
    924          }
   \                     ??SampleAPP_ProcessZDOMsgs_1:
   \   00004F   7F01         MOV     R7,#0x1
   \   000051   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for NORMAL_POLL_TIME>`:
   \   000000   581B         DW 7000

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for bindingOUTClusters>`:
   \   000000   0100         DW 1

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for longPollRateFlag>`:
   \   000000   01           DB 1

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??UserApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    UserApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??UserApp_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    UserApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_HandleKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_HandleKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_ProcessBINDINGMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_ProcessBINDINGMessage

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_APP_JOIN_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_APP_JOIN_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_APP_COMMAND?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_APP_COMMAND

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_SET_RS_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_SET_RS_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_SendInMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_SendInMessage

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??User_APP_Drive_init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    User_APP_Drive_init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??READ_NETKEY?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    READ_NETKEY

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??LED_CHANGE?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    LED_CHANGE

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_ZDO_JOINING_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_ZDO_JOINING_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_AFTER_RS_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_AFTER_RS_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_MAYBE_BUTTERY_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_MAYBE_BUTTERY_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_SET_NOMAL_POLL_TIME?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_SET_NOMAL_POLL_TIME

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleAPP_ProcessZDOMsgs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleAPP_ProcessZDOMsgs

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     LED_CHANGE                         0      0      0
     READ_NETKEY                        0      0      0
     SampleAPP_ProcessZDOMsgs           0      0     23
       -> HalLedBlink                   0      0     18
       -> HalLedBlink                   0      0     18
     SampleApp_HandleKeys               0      0     45
       -> SampleApp_SendInMessage       0      0     44
       -> SampleApp_SendInMessage       0      0     44
       -> HalLedBlink                   0      0     44
       -> NLME_GetShortAddr             0      0     62
       -> ZDP_EndDeviceBindReq          0      0     62
       -> APPLY_TO_JOIN_OF_KEY          0      0     44
       -> HalLedBlink                   0      0     44
       -> RESTORE_TO_FACTORY            0      0     44
       -> osal_start_timerEx            0      0     44
       -> osal_pwrmgr_device            0      0     44
       -> SampleApp_SendInMessage       0      0     44
       -> SampleApp_SendInMessage       0      0     44
       -> HalLedBlink                   0      0     44
       -> bindNumReflections            0      0     44
       -> AF_DataRequest                0      0     62
       -> osal_start_timerEx            0      0     44
       -> osal_start_timerEx            0      0     44
     SampleApp_ProcessBINDINGMessage
                                        0      0      0
     SampleApp_SendInMessage            2      0     33
       -> osal_mem_alloc                0      0     22
       -> USER_SEND_ADD_STR             0      0     22
       -> USER_APP_SEND_IN              0      0     22
       -> USER_APP_SEND_IN              0      0     22
       -> USER_APP_SEND_IN              0      0     22
       -> USER_APP_SEND_IN              0      0     22
       -> osal_mem_free                 0      0     22
     USER_AFTER_RS_MSG                  0      0      0
     USER_APP_COMMAND                   1      0     10
     USER_APP_JOIN_MSG                  0      0     10
       -> HalLedBlink                   0      0     20
       -> NLME_SetPollRate              0      0     20
       -> SampleApp_GetShortAddr        0      0     20
       -> osal_mem_free                 0      0     20
     USER_MAYBE_BUTTERY_MSG             0      0     10
       -> myApp_ReadBattery             0      0     20
       -> osal_start_timerEx            0      0     20
     USER_SET_NOMAL_POLL_TIME           2      0      0
     USER_SET_RS_MSG                    2      0      0
       -> myApp_ReadBattery             4      0      0
       -> osal_start_timerEx            4      0      0
     USER_ZDO_JOINING_MSG               2      0      0
       -> HalLedBlink                   4      0      0
     UserApp_Init                       0      0      9
       -> RegisterForKeys               0      0     18
       -> afRegister                    0      0     18
       -> RegisterForKeys               0      0     18
       -> ZDO_RegisterForZDOMsg         0      0     18
       -> User_APP_Drive_init           0      0     18
     UserApp_ProcessEvent               0      0     14
       -> osal_msg_receive              0      0     28
       -> SampleAPP_ProcessZDOMsgs      0      0     28
       -> SampleApp_HandleKeys          0      0     28
       -> osal_msg_deallocate           0      0     28
       -> osal_msg_receive              0      0     28
       -> SampleApp_SendInMessage       0      0     28
       -> NLME_SetPollRate              0      0     28
       -> osal_start_timerEx            0      0     28
       -> SampleApp_SendInMessage       0      0     28
     User_APP_Drive_init                0      0      9


   Segment part sizes:

     Function/Label                          Bytes
     --------------                          -----
     _A_P0                                      1
     P0INP                                      1
     _A_P1                                      1
     P1INP                                      1
     P0DIR                                      1
     P1DIR                                      1
     SampleApp_BIND_DstAddr                    12
     UserApp_TaskID                             1
     RS_LEN                                     1
     RS_STR                                    10
     SHORT_ADRESS                               4
     USER_DATA_LEN                              1
     USER_DATA_TYPE                             1
     USER_DATA_STR                              2
     DEVICE_ID                                  1
     DEFINED_CONTROL_CHAR                       1
     JOIN_ROLE                                  1
     NORMAL_POLL_TIME                           2
     DEEP_POLL_FLAG                             1
     FRONT_ALARM_FLAG                           1
     FRONT_ALARM_BIT                            1
     active_battery_voltage                     2
     CASH_TIME_FLAG                             1
     HIGH_BUTTERY_FLAG                          1
     LOW_POWER_MODE                             1
     Heart_mesg_count                           2
     poll_count                                 1
     Hour_count                                 1
     more_detect_low_power_flag                 1
     BUTTERY_LOW_FLAG                           1
     BUTTERY_ALARM_BIT                          1
     POLLRATE_TIME_VALUE                        1
     Key_Delay_Flag                             1
     BUUTON_STATE                               1
     bindingOUTClusters                         2
     ONOROFF1                                   1
     ONOROFF2                                   1
     ONOROFF3                                   1
     ONOROFF4                                   1
     ONOROFF5                                   1
     ONOROFF6                                   1
     screen_current_flag                        1
     screen_flag                                1
     CR2_DATA_NODETECT_FLAG                     1
     forever_forbiten_flag                      1
     bindingINClusters                          2
     CmdType                                    1
     IRCodeIndex                                2
     longPollRateFlag                           1
     USER_SampleApp_ClusterList                26
     SampleApp_epDesc1                          6
     SampleApp_SimpleDesc1                     12
     UserApp_Init                             110
     UserApp_ProcessEvent                     283
     SampleApp_HandleKeys                     566
     SampleApp_ProcessBINDINGMessage
                                                3
     USER_APP_JOIN_MSG                        137
     USER_APP_COMMAND                         195
     USER_SET_RS_MSG                          104
     SampleApp_SendInMessage                  377
     User_APP_Drive_init                       22
     READ_NETKEY                                8
     LED_CHANGE                               235
     USER_ZDO_JOINING_MSG                      24
     USER_AFTER_RS_MSG                          3
     USER_MAYBE_BUTTERY_MSG                   124
     USER_SET_NOMAL_POLL_TIME                  21
     SampleAPP_ProcessZDOMsgs                  84
     ?<Initializer for NORMAL_POLL_TIME>        2
     ?<Initializer for bindingOUTClusters>      2
     ?<Initializer for longPollRateFlag>        1
     ??UserApp_Init?relay                       6
     ??UserApp_ProcessEvent?relay               6
     ??SampleApp_HandleKeys?relay               6
     ??SampleApp_ProcessBINDINGMessage?relay    6
     ??USER_APP_JOIN_MSG?relay                  6
     ??USER_APP_COMMAND?relay                   6
     ??USER_SET_RS_MSG?relay                    6
     ??SampleApp_SendInMessage?relay            6
     ??User_APP_Drive_init?relay                6
     ??READ_NETKEY?relay                        6
     ??LED_CHANGE?relay                         6
     ??USER_ZDO_JOINING_MSG?relay               6
     ??USER_AFTER_RS_MSG?relay                  6
     ??USER_MAYBE_BUTTERY_MSG?relay             6
     ??USER_SET_NOMAL_POLL_TIME?relay           6
     ??SampleAPP_ProcessZDOMsgs?relay           6

 
 2 296 bytes in segment BANKED_CODE
    96 bytes in segment BANK_RELAYS
     6 bytes in segment SFR_AN
     5 bytes in segment XDATA_I
     5 bytes in segment XDATA_ID
    38 bytes in segment XDATA_ROM_C
    74 bytes in segment XDATA_Z
 
 2 397 bytes of CODE  memory
    38 bytes of CONST memory
     0 bytes of DATA  memory (+ 6 bytes shared)
    79 bytes of XDATA memory

Errors: none
Warnings: none
