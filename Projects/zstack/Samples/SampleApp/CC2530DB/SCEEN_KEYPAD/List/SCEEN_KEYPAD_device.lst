###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         11/Feb/2015  16:51:46 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\Source\SCEEN_KEYPAD\SCEEN_KEYP #
#                          AD_device.c                                        #
#    Command line       =  -f "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\z #
#                          stack\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC #
#                          2530DB\f8wEndev.cfg" (-DCPU32MHZ                   #
#                          -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3         #
#                          -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3) -f          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC253 #
#                          0DB\f8wConfig.cfg" (-DZIGBEEPRO -DSECURE=1         #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=60            #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=30           #
#                          -DNWK_MAX_BINDING_ENTRIES=10                       #
#                          -DMAX_BINDING_CLUSTER_IDS=4 -DASSERT_RESET         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=8000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=1000)  #
#                          -DREJOIN_POLL_RATE=440 "D:\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\Source #
#                          \SCEEN_KEYPAD\SCEEN_KEYPAD_device.c" -D NV_INIT    #
#                          -D NV_RESTORE -D HOLD_AUTO_START -D MT_TASK -D     #
#                          xMT_APP_FUNC -D MT_SYS_FUNC -D MT_ZDO_FUNC -D      #
#                          xMT_ZDO_MGMT -D ISR_KEYINTERRUPT -D POWER_SAVING   #
#                          -D xLONG_POLL_TIMES -D xHAVE_TEST_FUN -D           #
#                          RESUME_TIME_TEST -D SCEEN_KEYPAD -D xM_V332 -lC    #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\SCEEN_KEYPAD\List\"  #
#                          -lA "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\ #
#                          zstack\Samples\SampleApp\CC2530DB\SCEEN_KEYPAD\Lis #
#                          t\" --diag_suppress Pe001,Pa010 -o                 #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\SCEEN_KEYPAD\Obj\"   #
#                          -e --no_cse --no_unroll --no_inline                #
#                          --no_code_motion --no_tbaa --debug --core=plain    #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I "D:\RE_1_2_0_FORMAL_APP(25 #
#                          1)-14-12-8\Projects\zstack\Samples\SampleApp\CC253 #
#                          0DB\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\Source\" #
#                           -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\ #
#                          zstack\Samples\SampleApp\CC2530DB\..\Source\rssi_t #
#                          est\h\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Pr #
#                          ojects\zstack\Samples\SampleApp\CC2530DB\..\Source #
#                          \SCEEN_KEYPAD\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14 #
#                          -12-8\Projects\zstack\Samples\SampleApp\CC2530DB\. #
#                          .\..\..\ZMain\TI2530DB\" -I                        #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\hal\include\" -I "D:\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\hal\target\CC2530EB\" #
#                           -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\ #
#                          zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\C #
#                          omponents\mac\include\" -I                         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\high_level\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\low_level\srf04\" -I                     #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\low_level\srf04\single_chip\" -I         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mt\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8 #
#                          \Projects\zstack\Samples\SampleApp\CC2530DB\..\..\ #
#                          ..\..\..\Components\osal\include\" -I              #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\services\saddr\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\services\sdata\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\af\" -I "D:\RE_1_2_0_FORMAL_APP(251)-1 #
#                          4-12-8\Projects\zstack\Samples\SampleApp\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\nwk\" -I           #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\sapi\" -I "D:\RE_1_2_0_FORMAL_APP(251) #
#                          -14-12-8\Projects\zstack\Samples\SampleApp\CC2530D #
#                          B\..\..\..\..\..\Components\stack\sec\" -I         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\sys\" -I "D:\RE_1_2_0_FORMAL_APP(251)- #
#                          14-12-8\Projects\zstack\Samples\SampleApp\CC2530DB #
#                          \..\..\..\..\..\Components\stack\zdo\" -I          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\zmac\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12 #
#                          -8\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\Components\zmac\f8w\" -On               #
#                          --require_prototypes                               #
#    List file          =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\CC2530DB\SCEEN_KEYPAD\List\SCE #
#                          EN_KEYPAD_device.lst                               #
#    Object file        =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\CC2530DB\SCEEN_KEYPAD\Obj\SCEE #
#                          N_KEYPAD_device.r51                                #
#                                                                             #
#                                                                             #
###############################################################################

D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstack\Samples\SampleApp\Source\SCEEN_KEYPAD\SCEEN_KEYPAD_device.c
      1          /**************************************************************************************************
      2            Filename:       SampleApp.c
      3            Revised:        $Date: 2007-10-27 17:16:54 -0700 (Sat, 27 Oct 2007) $
      4            Revision:       $Revision: 15793 $
      5          
      6            Description:    Sample Application (no Profile).
      7          
      8          
      9            Copyright 2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41            This application isn't intended to do anything useful, it is
     42            intended to be a simple example of an application's structure.
     43          
     44            This application sends it's messages either as broadcast or
     45            broadcast filtered group messages.  The other (more normal)
     46            message addressing is unicast.  Most of the other sample
     47            applications are written to support the unicast message model.
     48          
     49            Key control:
     50              SW1:  Sends a flash command to all devices in Group 1.
     51              SW2:  Adds/Removes (toggles) this device in and out
     52                    of Group 1.  This will enable and disable the
     53                    reception of the flash command.
     54          *********************************************************************/
     55          
     56          /*********************************************************************
     57           * INCLUDES
     58           */
     59          
     60          
     61          
     62          //#define COMMUNICATION
     63          #include "OSAL.h"
     64          #include "ZGlobals.h"
     65          #include "AF.h"
     66          #include "aps_groups.h"
     67          #include "ZDApp.h"
     68          //#include "device.h"
     69          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0x88
   \   union <unnamed> volatile __sfr _A_TCON
   \                     _A_TCON:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xb6
   \   unsigned char volatile __sfr ADCCON3
   \                     ADCCON3:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xba
   \   unsigned char volatile __sfr ADCL
   \                     ADCL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xbb
   \   unsigned char volatile __sfr ADCH
   \                     ADCH:
   \   000000                DS 1
     70          #include "MT_UART.h"//2430 是 SPIMGR  2530叫 MT_UART  换了个名字
     71          #include "mac_rx.h"
     72          
     73          /* HAL */
     74          #include "hal_led.h"
     75          #include "hal_key.h"
     76          #include "OSAL_Nv.h"
     77          //#include "my_time.h"
     78          
     79          #include "AddrMgr.h"
     80          #include "nwk_util.h"
     81          #include "ZDObject.h"
     82          #include "ZDO_LIB.h"
     83          #include "common_device.h"
     84          #include "hal_drivers.h"
     85          #include "hal_key.h"
     86          #include "OSAL_PwrMgr.h"
     87          
     88          
     89          /*********************************************************************
     90           * MACROS
     91           */
     92          
     93          /*********************************************************************
     94           * CONSTANTS
     95           */
     96          
     97          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     98          uint8 Command_t,Sent_t;
   \                     Command_t:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     Sent_t:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     99              

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    100          devStates_t SampleApp_NwkState;
   \                     SampleApp_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    101              
    102          /*********************************************************************
    103           * TYPEDEFS
    104           */
    105          
    106          /*********************************************************************
    107           * GLOBAL VARIABLES―全局变量
    108           */
    109          

   \                                 In  segment XDATA_ROM_C, align 1
    110          const cId_t SampleApp_ClusterList[SAMPLEAPP_MAX_CLUSTERS] =
   \                     SampleApp_ClusterList:
   \   000000   0100         DW 1
   \   000002   0200         DW 2
   \   000004   0300         DW 3
   \   000006   0400         DW 4
   \   000008   0500         DW 5
   \   00000A   0600         DW 6
   \   00000C   0700         DW 7
   \   00000E   0000         DW 0
   \   000010   0000         DW 0
   \   000012   0000         DW 0
   \   000014   0000         DW 0
   \   000016   0000         DW 0
   \   000018   0000         DW 0
    111          {
    112            SAMPLEAPP_ONOFF_CLUSTERID, //周期信息簇ID=1
    113            SAMPLEAPP_FLASH_CLUSTERID,    //闪烁信息簇ID=2
    114            SAMPLEAPP_ADDR_CLUSTERID,
    115            SAMPLEAPP_COMMAND_CLUSTERID,
    116            SAMPLEAPP_PERIODIC_CLUSTERID,
    117            SAMPLEAPP_ANNCE_REQ_CLUSTERID,
    118            SAMPLEAPP_PERIODIC_COORDINATOR_CLUSTERID,
    119          };
    120          
    121          

   \                                 In  segment XDATA_ROM_C, align 1
    122          const SimpleDescriptionFormat_t SampleApp_SimpleDesc =
   \                     SampleApp_SimpleDesc:
   \   000000   14           DB 20
   \   000001   080F         DW 3848
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   0D           DB 13
   \   000007   ....         DW SampleApp_ClusterList
   \   000009   0D           DB 13
   \   00000A   ....         DW SampleApp_ClusterList
    123          {
    124            SAMPLEAPP_ENDPOINT,              //  int Endpoint;
    125            SAMPLEAPP_PROFID,                //  uint16 AppProfId[2];/**/
    126            SAMPLEAPP_DEVICEID,              //  uint16 AppDeviceId[2];
    127            SAMPLEAPP_DEVICE_VERSION,        //  int   AppDevVer:4;
    128            SAMPLEAPP_FLAGS,                 //  int   AppFlags:4;
    129            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
    130            (cId_t *)SampleApp_ClusterList,  //  uint8 *pAppInClusterList;
    131            SAMPLEAPP_MAX_CLUSTERS,          //  uint8  AppNumInClusters;
    132            (cId_t *)SampleApp_ClusterList   //  uint8 *pAppInClusterList;
    133          };
    134          
    135          
    136          
    137          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    138          afAddrType_t SampleApp_Periodic_DstAddr;       //周期事件寻址模式
   \                     SampleApp_Periodic_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    139          afAddrType_t SampleApp_Flash_DstAddr;          //闪烁事件寻址模式
   \                     SampleApp_Flash_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    140          afAddrType_t SampleApp_SPI_SendData_DstAddr;   //串口数据信息
   \                     SampleApp_SPI_SendData_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    141          afAddrType_t SampleApp_SPI_SendCommand_DstAddr;//串口命令信息
   \                     SampleApp_SPI_SendCommand_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    142          afAddrType_t SampleApp_Addr_SendData_DstAddr;  //入网报告
   \                     SampleApp_Addr_SendData_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    143          afAddrType_t SampleApp_annce_req_DstAddr;    //annce 关联表对比清楚信息
   \                     SampleApp_annce_req_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
    144          //afAddrType_t SampleApp_BIND_DstAddr;
    145          
    146          
    147          
    148          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    149          uint16 pollrate_time =0 ;
   \                     pollrate_time:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    150          extern uint8 POLLRATE_TIME_VALUE;
    151          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    152          uint8 ERROR_COUNT=0;
   \                     ERROR_COUNT:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    153            
    154          uint16 myApp_ReadBattery( void );
    155          
    156          extern void CR2_DATA_NODETECT_MSG(void);
    157          /*********************************************************************
    158           * LOCAL FUNCTIONS
    159           */
    160          //void SampleApp_HandleKeys( uint8 shift, uint8 keys );//本用户应用按键函数
    161          void SampleApp_MessageMSGCB( afIncomingMSGPacket_t *pckt );//本用户应用信息回调函数
    162          void SampleApp_SendPeriodicMessage( void );         //本用户应用发送周期消息函数
    163          void SampleApp_ProcessCommandMessage(afIncomingMSGPacket_t *pkt);
    164          void SampleApp_SendInMessage(void);
    165          void SampleApp_ProcessBINDINGMessage(afIncomingMSGPacket_t *pkt);
    166          //void  Delay_1u(uint32 microSecs);
    167          
    168          
    169          
    170          
    171          extern    	uint8 CmdType;  //命令类型： '1' 学习，'2' 使用
    172          	extern uint16 IRCodeIndex;   //
    173          //extern uint8 longPollRateFlag;
    174          extern void changePollRate(void);
    175          /*********************************************************************
    176           * @fn      SampleApp_Init
    177           *
    178           * @brief   Initialization function for the Generic App Task.
    179           *          This is called during initialization and should contain
    180           *          any application specific initialization (ie. hardware
    181           *          initialization/setup, table initialization, power up
    182           *          notificaiton ... ).
    183           *
    184           * @param   task_id - the ID assigned by OSAL.  This ID should be
    185           *                    used to send messages and set timers.
    186           *
    187           * @return  none
    188           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    189          void SampleApp_Init( uint8 task_id )
   \                     SampleApp_Init:
    190          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    191             #if defined ( LEAVE_NET_SET )
    192              LEAVE_NET_SET_FLAG =1;
    193            #else
    194              LEAVE_NET_SET_FLAG =0;
   \   000007   90....       MOV     DPTR,#LEAVE_NET_SET_FLAG
   \   00000A   7400         MOV     A,#0x0
   \   00000C   F0           MOVX    @DPTR,A
    195            #endif
    196              
    197            #if defined ( RTR_NWK )
    198              RTR_NWK_FLAG =1;
    199            #else
    200              RTR_NWK_FLAG =0;
   \   00000D   90....       MOV     DPTR,#RTR_NWK_FLAG
   \   000010   7400         MOV     A,#0x0
   \   000012   F0           MOVX    @DPTR,A
    201            #endif
    202            
    203            #if defined ( POWER_SAVING )
    204              POWER_SAVING_FLAG =1;
   \   000013   90....       MOV     DPTR,#POWER_SAVING_FLAG
   \   000016   7401         MOV     A,#0x1
   \   000018   F0           MOVX    @DPTR,A
    205            #else
    206              POWER_SAVING_FLAG =0;
    207            #endif
    208            
    209            #if defined ( POWER_PA )
    210              POWER_PA_FLAG =1;
    211            #else
    212              POWER_PA_FLAG =0;
   \   000019   90....       MOV     DPTR,#POWER_PA_FLAG
   \   00001C   7400         MOV     A,#0x0
   \   00001E   F0           MOVX    @DPTR,A
    213            #endif
    214            
    215            
    216            SampleApp_TaskID = task_id;
   \   00001F   EE           MOV     A,R6
   \   000020   90....       MOV     DPTR,#SampleApp_TaskID
   \   000023   F0           MOVX    @DPTR,A
    217            SampleApp_NwkState = DEV_INIT;
   \   000024   90....       MOV     DPTR,#SampleApp_NwkState
   \   000027   7401         MOV     A,#0x1
   \   000029   F0           MOVX    @DPTR,A
    218            SampleApp_TransID = 0;
   \   00002A   90....       MOV     DPTR,#SampleApp_TransID
   \   00002D   7400         MOV     A,#0x0
   \   00002F   F0           MOVX    @DPTR,A
    219          
    220            
    221            SampleApp_epDesc.endPoint = SAMPLEAPP_ENDPOINT;//SampleApp EP描述符的EP号：20
   \   000030   90....       MOV     DPTR,#SampleApp_epDesc
   \   000033   7414         MOV     A,#0x14
   \   000035   F0           MOVX    @DPTR,A
    222            SampleApp_epDesc.task_id = &SampleApp_TaskID;//SampleApp EP描述符的任务ID：0
   \   000036   90....       MOV     DPTR,#SampleApp_epDesc + 1
   \   000039   74..         MOV     A,#SampleApp_TaskID & 0xff
   \   00003B   F0           MOVX    @DPTR,A
   \   00003C   A3           INC     DPTR
   \   00003D   74..         MOV     A,#(SampleApp_TaskID >> 8) & 0xff
   \   00003F   F0           MOVX    @DPTR,A
    223            SampleApp_epDesc.simpleDesc
    224                      = (SimpleDescriptionFormat_t *)&SampleApp_SimpleDesc;//SampleApp EP简单描述符
   \   000040   90....       MOV     DPTR,#SampleApp_epDesc + 3
   \   000043   74..         MOV     A,#SampleApp_SimpleDesc & 0xff
   \   000045   F0           MOVX    @DPTR,A
   \   000046   A3           INC     DPTR
   \   000047   74..         MOV     A,#(SampleApp_SimpleDesc >> 8) & 0xff
   \   000049   F0           MOVX    @DPTR,A
    225            SampleApp_epDesc.latencyReq = noLatencyReqs;//延时策略
   \   00004A   90....       MOV     DPTR,#SampleApp_epDesc + 5
   \   00004D   7400         MOV     A,#0x0
   \   00004F   F0           MOVX    @DPTR,A
    226          
    227            // Register the endpoint description with the AF
    228            afRegister( &SampleApp_epDesc );
   \   000050                ; Setup parameters for call to function afRegister
   \   000050   7A..         MOV     R2,#SampleApp_epDesc & 0xff
   \   000052   7B..         MOV     R3,#(SampleApp_epDesc >> 8) & 0xff
   \   000054   12....       LCALL   ??afRegister?relay
   \   000057   E9           MOV     A,R1
    229            
    230            APP_JOIN_INIT();
   \   000058                ; Setup parameters for call to function APP_JOIN_INIT
   \   000058   12....       LCALL   ??APP_JOIN_INIT?relay
    231          
    232          }
   \   00005B   7F01         MOV     R7,#0x1
   \   00005D   02....       LJMP    ?BANKED_LEAVE_XDATA
    233          
    234          /*********************************************************************
    235           * @fn      SampleApp_ProcessEvent
    236           *
    237           * @brief   Generic Application Task event processor.  This function
    238           *          is called to process all events for the task.  Events
    239           *          include timers, messages and any other user defined events.
    240           *
    241           * @param   task_id  - The OSAL assigned task ID.
    242           * @param   events - events to process.  This is a bit map and can
    243           *                   contain more than one event.
    244           *
    245           * @return  none
    246           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    247          uint16 SampleApp_ProcessEvent( uint8 task_id, uint16 events )
   \                     SampleApp_ProcessEvent:
    248          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 3,R1
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
   \   000009   EB           MOV     A,R3
   \   00000A   FF           MOV     R7,A
    249            afIncomingMSGPacket_t *MSGpkt;
    250           
    251            
    252              afDataConfirm_t *afDataConfirm;
    253             uint8 sentStatus;
    254            
    255            if ( events & SYS_EVENT_MSG )
   \   00000B   EE           MOV     A,R6
   \   00000C   5400         ANL     A,#0x0
   \   00000E   F8           MOV     R0,A
   \   00000F   EF           MOV     A,R7
   \   000010   5480         ANL     A,#0x80
   \   000012   F9           MOV     R1,A
   \   000013   E8           MOV     A,R0
   \   000014   49           ORL     A,R1
   \   000015   7003         JNZ     $+5
   \   000017   02....       LJMP    ??SampleApp_ProcessEvent_0 & 0xFFFF
    256            {
    257              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SampleApp_TaskID );
   \   00001A                ; Setup parameters for call to function osal_msg_receive
   \   00001A   90....       MOV     DPTR,#SampleApp_TaskID
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   F9           MOV     R1,A
   \   00001F   12....       LCALL   ??osal_msg_receive?relay
   \   000022   8A..         MOV     ?V0 + 6,R2
   \   000024   8B..         MOV     ?V0 + 7,R3
   \   000026   85....       MOV     ?V0 + 0,?V0 + 6
   \   000029   85....       MOV     ?V0 + 1,?V0 + 7
    258              while ( MSGpkt )                                           
   \                     ??SampleApp_ProcessEvent_1:
   \   00002C   E5..         MOV     A,?V0 + 0
   \   00002E   45..         ORL     A,?V0 + 1
   \   000030   607E         JZ      ??SampleApp_ProcessEvent_2
    259              {                                                                     
    260                switch ( MSGpkt->hdr.event )
   \   000032   85..82       MOV     DPL,?V0 + 0
   \   000035   85..83       MOV     DPH,?V0 + 1
   \   000038   E0           MOVX    A,@DPTR
   \   000039   24E6         ADD     A,#-0x1a
   \   00003B   600A         JZ      ??SampleApp_ProcessEvent_3
   \   00003D   2449         ADD     A,#0x49
   \   00003F   6028         JZ      ??SampleApp_ProcessEvent_4
   \   000041   24D4         ADD     A,#-0x2c
   \   000043   600B         JZ      ??SampleApp_ProcessEvent_5
   \   000045   804C         SJMP    ??SampleApp_ProcessEvent_6
    261                {
    262                  case AF_INCOMING_MSG_CMD:
    263                    SampleApp_MessageMSGCB( MSGpkt );
   \                     ??SampleApp_ProcessEvent_3:
   \   000047                ; Setup parameters for call to function SampleApp_MessageMSGCB
   \   000047   AA..         MOV     R2,?V0 + 0
   \   000049   AB..         MOV     R3,?V0 + 1
   \   00004B   12....       LCALL   ??SampleApp_MessageMSGCB?relay
    264                    break;
   \   00004E   8043         SJMP    ??SampleApp_ProcessEvent_6
    265          
    266                    
    267                    case AF_DATA_CONFIRM_CMD:
    268                    afDataConfirm = (afDataConfirm_t *)MSGpkt;
   \                     ??SampleApp_ProcessEvent_5:
   \   000050   85....       MOV     ?V0 + 4,?V0 + 0
   \   000053   85....       MOV     ?V0 + 5,?V0 + 1
    269                    sentStatus = afDataConfirm->hdr.status;
   \   000056   85..82       MOV     DPL,?V0 + 4
   \   000059   85..83       MOV     DPH,?V0 + 5
   \   00005C   A3           INC     DPTR
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F5..         MOV     ?V0 + 2,A
    270                    if ( sentStatus != ZSuccess )
   \   000060   E5..         MOV     A,?V0 + 2
   \   000062   602F         JZ      ??SampleApp_ProcessEvent_6
    271                    {
    272                        ZDO_ACK_DEAL_WITH(); 
   \   000064                ; Setup parameters for call to function ZDO_ACK_DEAL_WITH
   \   000064   12....       LCALL   ??ZDO_ACK_DEAL_WITH?relay
    273                    }
    274                    break; 
   \   000067   802A         SJMP    ??SampleApp_ProcessEvent_6
    275                    
    276                  case ZDO_STATE_CHANGE:  
    277                    SampleApp_NwkState = (devStates_t)(MSGpkt->hdr.status);
   \                     ??SampleApp_ProcessEvent_4:
   \   000069   85..82       MOV     DPL,?V0 + 0
   \   00006C   85..83       MOV     DPH,?V0 + 1
   \   00006F   A3           INC     DPTR
   \   000070   E0           MOVX    A,@DPTR
   \   000071   90....       MOV     DPTR,#SampleApp_NwkState
   \   000074   F0           MOVX    @DPTR,A
    278                    if ( (SampleApp_NwkState == DEV_ZB_COORD)
    279                        || (SampleApp_NwkState == DEV_ROUTER)
    280                        || (SampleApp_NwkState == DEV_END_DEVICE) )
   \   000075   90....       MOV     DPTR,#SampleApp_NwkState
   \   000078   E0           MOVX    A,@DPTR
   \   000079   6409         XRL     A,#0x9
   \   00007B   6010         JZ      ??SampleApp_ProcessEvent_7
   \   00007D   90....       MOV     DPTR,#SampleApp_NwkState
   \   000080   E0           MOVX    A,@DPTR
   \   000081   6407         XRL     A,#0x7
   \   000083   6008         JZ      ??SampleApp_ProcessEvent_7
   \   000085   90....       MOV     DPTR,#SampleApp_NwkState
   \   000088   E0           MOVX    A,@DPTR
   \   000089   6406         XRL     A,#0x6
   \   00008B   7006         JNZ     ??SampleApp_ProcessEvent_6
    281                    {
    282                     APP_JOIN_DEAL_WITH();
   \                     ??SampleApp_ProcessEvent_7:
   \   00008D                ; Setup parameters for call to function APP_JOIN_DEAL_WITH
   \   00008D   12....       LCALL   ??APP_JOIN_DEAL_WITH?relay
    283                     USER_APP_JOIN_MSG(); // 处理入网后应用的内容 
   \   000090                ; Setup parameters for call to function USER_APP_JOIN_MSG
   \   000090   12....       LCALL   ??USER_APP_JOIN_MSG?relay
    284                    }
    285                    else
    286                    {
    287             
    288                    }
    289                    break;
    290          
    291                  default:
    292                    break;
    293                }
    294          
    295                // Release the memory
    296          
    297                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??SampleApp_ProcessEvent_6:
   \   000093                ; Setup parameters for call to function osal_msg_deallocate
   \   000093   AA..         MOV     R2,?V0 + 0
   \   000095   AB..         MOV     R3,?V0 + 1
   \   000097   12....       LCALL   ??osal_msg_deallocate?relay
   \   00009A   E9           MOV     A,R1
    298          
    299                // Next - if one is available
    300                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( SampleApp_TaskID );
   \   00009B                ; Setup parameters for call to function osal_msg_receive
   \   00009B   90....       MOV     DPTR,#SampleApp_TaskID
   \   00009E   E0           MOVX    A,@DPTR
   \   00009F   F9           MOV     R1,A
   \   0000A0   12....       LCALL   ??osal_msg_receive?relay
   \   0000A3   8A..         MOV     ?V0 + 6,R2
   \   0000A5   8B..         MOV     ?V0 + 7,R3
   \   0000A7   85....       MOV     ?V0 + 0,?V0 + 6
   \   0000AA   85....       MOV     ?V0 + 1,?V0 + 7
   \   0000AD   02....       LJMP    ??SampleApp_ProcessEvent_1 & 0xFFFF
    301              }//end： while ( MSGpkt )
    302          
    303              return (events ^ SYS_EVENT_MSG);
   \                     ??SampleApp_ProcessEvent_2:
   \   0000B0   EE           MOV     A,R6
   \   0000B1   6400         XRL     A,#0x0
   \   0000B3   FA           MOV     R2,A
   \   0000B4   EF           MOV     A,R7
   \   0000B5   6480         XRL     A,#0x80
   \   0000B7   FB           MOV     R3,A
   \   0000B8   02....       LJMP    ??SampleApp_ProcessEvent_8 & 0xFFFF
    304            }
    305            
    306            if ( events & SAMPLEAPP_SEND_PERIODIC_MSG_EVT )//发送周期消息事件
   \                     ??SampleApp_ProcessEvent_0:
   \   0000BB   EE           MOV     A,R6
   \   0000BC   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000BE   5050         JNC     ??SampleApp_ProcessEvent_9
    307            {
    308                USER_MAYBE_BUTTERY_MSG();
   \   0000C0                ; Setup parameters for call to function USER_MAYBE_BUTTERY_MSG
   \   0000C0   12....       LCALL   ??USER_MAYBE_BUTTERY_MSG?relay
    309                SampleApp_SendPeriodicMessage();
   \   0000C3                ; Setup parameters for call to function SampleApp_SendPeriodicMessage
   \   0000C3   12....       LCALL   ??SampleApp_SendPeriodicMessage?relay
    310          
    311                osal_start_timerEx( SampleApp_TaskID, SAMPLEAPP_SEND_PERIODIC_MSG_EVT,
    312                                        (55000+ 30*(osal_rand() & 0x00FF)) );
   \   0000C6                ; Setup parameters for call to function osal_rand
   \   0000C6   12....       LCALL   ??osal_rand?relay
   \   0000C9   8A..         MOV     ?V0 + 6,R2
   \   0000CB   8B..         MOV     ?V0 + 7,R3
   \   0000CD   A8..         MOV     R0,?V0 + 6
   \   0000CF   A9..         MOV     R1,?V0 + 7
   \   0000D1                ; Setup parameters for call to function osal_start_timerEx
   \   0000D1   E5..         MOV     A,?V0 + 6
   \   0000D3   54FF         ANL     A,#0xff
   \   0000D5   F8           MOV     R0,A
   \   0000D6   E5..         MOV     A,?V0 + 7
   \   0000D8   5400         ANL     A,#0x0
   \   0000DA   F9           MOV     R1,A
   \   0000DB   E8           MOV     A,R0
   \   0000DC   75F01E       MOV     B,#0x1e
   \   0000DF   A4           MUL     AB
   \   0000E0   C8           XCH     A,R0
   \   0000E1   AAF0         MOV     R2,B
   \   0000E3   75F000       MOV     B,#0x0
   \   0000E6   A4           MUL     AB
   \   0000E7   2A           ADD     A,R2
   \   0000E8   FA           MOV     R2,A
   \   0000E9   75F01E       MOV     B,#0x1e
   \   0000EC   E9           MOV     A,R1
   \   0000ED   A4           MUL     AB
   \   0000EE   2A           ADD     A,R2
   \   0000EF   F9           MOV     R1,A
   \   0000F0   E8           MOV     A,R0
   \   0000F1   24D8         ADD     A,#-0x28
   \   0000F3   FC           MOV     R4,A
   \   0000F4   E9           MOV     A,R1
   \   0000F5   34D6         ADDC    A,#-0x2a
   \   0000F7   FD           MOV     R5,A
   \   0000F8   7A01         MOV     R2,#0x1
   \   0000FA   7B00         MOV     R3,#0x0
   \   0000FC   90....       MOV     DPTR,#SampleApp_TaskID
   \   0000FF   E0           MOVX    A,@DPTR
   \   000100   F9           MOV     R1,A
   \   000101   12....       LCALL   ??osal_start_timerEx?relay
   \   000104   E9           MOV     A,R1
    313             
    314              return (events ^ SAMPLEAPP_SEND_PERIODIC_MSG_EVT);
   \   000105   EE           MOV     A,R6
   \   000106   6401         XRL     A,#0x1
   \   000108   FA           MOV     R2,A
   \   000109   EF           MOV     A,R7
   \   00010A   6400         XRL     A,#0x0
   \   00010C   FB           MOV     R3,A
   \   00010D   02....       LJMP    ??SampleApp_ProcessEvent_8 & 0xFFFF
    315            }
    316            
    317             
    318          
    319            
    320            if ( events & SAMPLEAPP_SEND_NWKADDR_EVT )
   \                     ??SampleApp_ProcessEvent_9:
   \   000110   EE           MOV     A,R6
   \   000111   5404         ANL     A,#0x4
   \   000113   6028         JZ      ??SampleApp_ProcessEvent_10
    321            {
    322               SampleApp_SendNwkaddrMessage(JOIN_ROLE,DEVICE_ID);
   \   000115                ; Setup parameters for call to function SampleApp_SendNwkaddrMessage
   \   000115   90....       MOV     DPTR,#DEVICE_ID
   \   000118   E0           MOVX    A,@DPTR
   \   000119   FA           MOV     R2,A
   \   00011A   90....       MOV     DPTR,#JOIN_ROLE
   \   00011D   E0           MOVX    A,@DPTR
   \   00011E   F9           MOV     R1,A
   \   00011F   12....       LCALL   ??SampleApp_SendNwkaddrMessage?relay
    323               osal_start_timerEx( SampleApp_TaskID, OS_TEST_EVT,20000); 
   \   000122                ; Setup parameters for call to function osal_start_timerEx
   \   000122   7C20         MOV     R4,#0x20
   \   000124   7D4E         MOV     R5,#0x4e
   \   000126   7A08         MOV     R2,#0x8
   \   000128   7B00         MOV     R3,#0x0
   \   00012A   90....       MOV     DPTR,#SampleApp_TaskID
   \   00012D   E0           MOVX    A,@DPTR
   \   00012E   F9           MOV     R1,A
   \   00012F   12....       LCALL   ??osal_start_timerEx?relay
   \   000132   E9           MOV     A,R1
    324          
    325              return ( events ^ SAMPLEAPP_SEND_NWKADDR_EVT);
   \   000133   EE           MOV     A,R6
   \   000134   6404         XRL     A,#0x4
   \   000136   FA           MOV     R2,A
   \   000137   EF           MOV     A,R7
   \   000138   6400         XRL     A,#0x0
   \   00013A   FB           MOV     R3,A
   \   00013B   8074         SJMP    ??SampleApp_ProcessEvent_8
    326            }
    327            
    328             if ( events & OS_TEST_EVT )
   \                     ??SampleApp_ProcessEvent_10:
   \   00013D   EE           MOV     A,R6
   \   00013E   5408         ANL     A,#0x8
   \   000140   6018         JZ      ??SampleApp_ProcessEvent_11
    329            {
    330                USER_SET_NOMAL_POLL_TIME();  
   \   000142                ; Setup parameters for call to function USER_SET_NOMAL_POLL_TIME
   \   000142   12....       LCALL   ??USER_SET_NOMAL_POLL_TIME?relay
    331                APP_OS_DEAL_WITH(NORMAL_POLL_TIME); 
   \   000145                ; Setup parameters for call to function APP_OS_DEAL_WITH
   \   000145   90....       MOV     DPTR,#NORMAL_POLL_TIME
   \   000148   E0           MOVX    A,@DPTR
   \   000149   FA           MOV     R2,A
   \   00014A   A3           INC     DPTR
   \   00014B   E0           MOVX    A,@DPTR
   \   00014C   FB           MOV     R3,A
   \   00014D   12....       LCALL   ??APP_OS_DEAL_WITH?relay
    332                 return ( events ^ OS_TEST_EVT);
   \   000150   EE           MOV     A,R6
   \   000151   6408         XRL     A,#0x8
   \   000153   FA           MOV     R2,A
   \   000154   EF           MOV     A,R7
   \   000155   6400         XRL     A,#0x0
   \   000157   FB           MOV     R3,A
   \   000158   8057         SJMP    ??SampleApp_ProcessEvent_8
    333            }
    334               
    335            
    336          
    337              if ( events & SAMPLEAPP_SEND_RS_EVT )
   \                     ??SampleApp_ProcessEvent_11:
   \   00015A   EE           MOV     A,R6
   \   00015B   5400         ANL     A,#0x0
   \   00015D   F8           MOV     R0,A
   \   00015E   EF           MOV     A,R7
   \   00015F   5440         ANL     A,#0x40
   \   000161   F9           MOV     R1,A
   \   000162   E8           MOV     A,R0
   \   000163   49           ORL     A,R1
   \   000164   6023         JZ      ??SampleApp_ProcessEvent_12
    338            {
    339          
    340              USER_SET_RS_MSG();//设置RS数据
   \   000166                ; Setup parameters for call to function USER_SET_RS_MSG
   \   000166   12....       LCALL   ??USER_SET_RS_MSG?relay
    341              sampleAPP_sendRS_periodMessage(JOIN_ROLE,DEVICE_ID,RS_LEN,RS_STR);
   \   000169                ; Setup parameters for call to function sampleAPP_sendRS_periodMessage
   \   000169   7C..         MOV     R4,#RS_STR & 0xff
   \   00016B   7D..         MOV     R5,#(RS_STR >> 8) & 0xff
   \   00016D   90....       MOV     DPTR,#RS_LEN
   \   000170   E0           MOVX    A,@DPTR
   \   000171   FB           MOV     R3,A
   \   000172   90....       MOV     DPTR,#DEVICE_ID
   \   000175   E0           MOVX    A,@DPTR
   \   000176   FA           MOV     R2,A
   \   000177   90....       MOV     DPTR,#JOIN_ROLE
   \   00017A   E0           MOVX    A,@DPTR
   \   00017B   F9           MOV     R1,A
   \   00017C   12....       LCALL   ??sampleAPP_sendRS_periodMessage?relay
    342              return ( events ^ SAMPLEAPP_SEND_RS_EVT);
   \   00017F   EE           MOV     A,R6
   \   000180   6400         XRL     A,#0x0
   \   000182   FA           MOV     R2,A
   \   000183   EF           MOV     A,R7
   \   000184   6440         XRL     A,#0x40
   \   000186   FB           MOV     R3,A
   \   000187   8028         SJMP    ??SampleApp_ProcessEvent_8
    343            }
    344            
    345             
    346            
    347                if ( events & NEW_JOIN_ROLE_EVT )
   \                     ??SampleApp_ProcessEvent_12:
   \   000189   EE           MOV     A,R6
   \   00018A   5420         ANL     A,#0x20
   \   00018C   600D         JZ      ??SampleApp_ProcessEvent_13
    348            {
    349                 APP_JOIN_START_EVT();
   \   00018E                ; Setup parameters for call to function APP_JOIN_START_EVT
   \   00018E   12....       LCALL   ??APP_JOIN_START_EVT?relay
    350               return ( events ^ NEW_JOIN_ROLE_EVT);
   \   000191   EE           MOV     A,R6
   \   000192   6420         XRL     A,#0x20
   \   000194   FA           MOV     R2,A
   \   000195   EF           MOV     A,R7
   \   000196   6400         XRL     A,#0x0
   \   000198   FB           MOV     R3,A
   \   000199   8016         SJMP    ??SampleApp_ProcessEvent_8
    351              
    352            }
    353            
    354          
    355          if ( events & SAMPLEAPP_RESTORE_EVT )
   \                     ??SampleApp_ProcessEvent_13:
   \   00019B   EE           MOV     A,R6
   \   00019C   5410         ANL     A,#0x10
   \   00019E   600D         JZ      ??SampleApp_ProcessEvent_14
    356            {
    357                Change_Net_Set();
   \   0001A0                ; Setup parameters for call to function Change_Net_Set
   \   0001A0   12....       LCALL   ??Change_Net_Set?relay
    358              
    359              return ( events ^ SAMPLEAPP_RESTORE_EVT);
   \   0001A3   EE           MOV     A,R6
   \   0001A4   6410         XRL     A,#0x10
   \   0001A6   FA           MOV     R2,A
   \   0001A7   EF           MOV     A,R7
   \   0001A8   6400         XRL     A,#0x0
   \   0001AA   FB           MOV     R3,A
   \   0001AB   8004         SJMP    ??SampleApp_ProcessEvent_8
    360            }
    361            
    362           
    363            return 0;
   \                     ??SampleApp_ProcessEvent_14:
   \   0001AD   7A00         MOV     R2,#0x0
   \   0001AF   7B00         MOV     R3,#0x0
   \                     ??SampleApp_ProcessEvent_8:
   \   0001B1   7F08         MOV     R7,#0x8
   \   0001B3   02....       LJMP    ?BANKED_LEAVE_XDATA
    364          }
    365          
    366          
    367          
    368          
    369          
    370          
    371          /*********************************************************************
    372           * LOCAL FUNCTIONS
    373           */
    374          
    375          /*********************************************************************
    376           * @fn      SampleApp_MessageMSGCB
    377           *
    378           * @brief   Data message processor callback.  This function processes
    379           *          any incoming data - probably from other devices.  So, based
    380           *          on cluster ID, perform the intended action.
    381           *
    382           * @param   none
    383           *
    384           * @return  none
    385           */
    386          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    387          void SampleApp_MessageMSGCB( afIncomingMSGPacket_t *pkt )
   \                     SampleApp_MessageMSGCB:
    388          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    389            //uint16 flashTime;
    390            switch ( pkt->clusterId )
   \   000009   8E82         MOV     DPL,R6
   \   00000B   8F83         MOV     DPH,R7
   \   00000D   A3           INC     DPTR
   \   00000E   A3           INC     DPTR
   \   00000F   A3           INC     DPTR
   \   000010   A3           INC     DPTR
   \   000011   E0           MOVX    A,@DPTR
   \   000012   F5..         MOV     ?V0 + 0,A
   \   000014   A3           INC     DPTR
   \   000015   E0           MOVX    A,@DPTR
   \   000016   F5..         MOV     ?V0 + 1,A
   \   000018   78..         MOV     R0,#?V0 + 0
   \   00001A   12....       LCALL   ?US_SWITCH_DENSE
   \                     `?<Jumptable for SampleApp_MessageMSGCB>_0`:
   \   00001D   0200         DW        2
   \   00001F   02           DB        2
   \   000020   ....         DW        ??SampleApp_MessageMSGCB_0
   \   000022   ....         DW        ??SampleApp_MessageMSGCB_1
   \   000024   ....         DW        ??SampleApp_MessageMSGCB_0
   \   000026   ....         DW        ??SampleApp_MessageMSGCB_2
    391            {
    392           
    393              case SAMPLEAPP_COMMAND_CLUSTERID:
    394          
    395                 #if defined (CR2_DATA_NODETECT)
    396               // if(DEEP_POLL_FLAG==0)//非深度POLL的时候取消报警 2014 11 29 所有时刻接受命令都禁止中断一下
    397                { 
    398                 CR2_DATA_NODETECT_MSG();
    399                }     
    400               #endif
    401                
    402                SampleApp_ProcessCommandMessage(pkt);
   \                     ??SampleApp_MessageMSGCB_2:
   \   000028                ; Setup parameters for call to function SampleApp_ProcessCommandMessage
   \   000028   EE           MOV     A,R6
   \   000029   FA           MOV     R2,A
   \   00002A   EF           MOV     A,R7
   \   00002B   FB           MOV     R3,A
   \   00002C   12....       LCALL   ??SampleApp_ProcessCommandMessage?relay
    403                break;  
   \   00002F   8047         SJMP    ??SampleApp_MessageMSGCB_0
    404                
    405                
    406                case SAMPLEAPP_FLASH_CLUSTERID:
    407          
    408                 OS_FLAG=APP_ENDDEVICE_ACK(pkt->cmd.Data[0],pkt->cmd.Data[1],pkt->cmd.Data[2]);
   \                     ??SampleApp_MessageMSGCB_1:
   \   000031                ; Setup parameters for call to function APP_ENDDEVICE_ACK
   \   000031   EE           MOV     A,R6
   \   000032   2422         ADD     A,#0x22
   \   000034   F582         MOV     DPL,A
   \   000036   EF           MOV     A,R7
   \   000037   3400         ADDC    A,#0x0
   \   000039   F583         MOV     DPH,A
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   F8           MOV     R0,A
   \   00003D   A3           INC     DPTR
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F583         MOV     DPH,A
   \   000041   8882         MOV     DPL,R0
   \   000043   A3           INC     DPTR
   \   000044   A3           INC     DPTR
   \   000045   E0           MOVX    A,@DPTR
   \   000046   FB           MOV     R3,A
   \   000047   EE           MOV     A,R6
   \   000048   2422         ADD     A,#0x22
   \   00004A   F582         MOV     DPL,A
   \   00004C   EF           MOV     A,R7
   \   00004D   3400         ADDC    A,#0x0
   \   00004F   F583         MOV     DPH,A
   \   000051   E0           MOVX    A,@DPTR
   \   000052   F8           MOV     R0,A
   \   000053   A3           INC     DPTR
   \   000054   E0           MOVX    A,@DPTR
   \   000055   F583         MOV     DPH,A
   \   000057   8882         MOV     DPL,R0
   \   000059   A3           INC     DPTR
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   FA           MOV     R2,A
   \   00005C   EE           MOV     A,R6
   \   00005D   2422         ADD     A,#0x22
   \   00005F   F582         MOV     DPL,A
   \   000061   EF           MOV     A,R7
   \   000062   3400         ADDC    A,#0x0
   \   000064   F583         MOV     DPH,A
   \   000066   E0           MOVX    A,@DPTR
   \   000067   F8           MOV     R0,A
   \   000068   A3           INC     DPTR
   \   000069   E0           MOVX    A,@DPTR
   \   00006A   F583         MOV     DPH,A
   \   00006C   8882         MOV     DPL,R0
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   F9           MOV     R1,A
   \   000070   12....       LCALL   ??APP_ENDDEVICE_ACK?relay
   \   000073   E9           MOV     A,R1
   \   000074   90....       MOV     DPTR,#OS_FLAG
   \   000077   F0           MOVX    @DPTR,A
    409                
    410             break; 
    411                
    412              
    413            default:break;
    414              
    415            }
    416          }
   \                     ??SampleApp_MessageMSGCB_0:
   \   000078   7F02         MOV     R7,#0x2
   \   00007A   02....       LJMP    ?BANKED_LEAVE_XDATA
    417          
    418          
    419          
    420          
    421          
    422          /*********************************************************************
    423           * @fn      SampleApp_ProcessCommandMessage
    424           *
    425           * @brief   Prcoess the (single) message command from the coordinataor.
    426           *
    427           * @param   pkt
    428           *
    429           * @return  none
    430           */
    431          /*0 1 2 3 4 5 6  7  8    9 10  11  12   13   14 ...*/
    432          /*_ _ _ / C / U  U  D   A    T    A ...*/
    433          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    434          void SampleApp_ProcessCommandMessage(afIncomingMSGPacket_t *pkt)
   \                     SampleApp_ProcessCommandMessage:
    435          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 41
   \   000005   74D7         MOV     A,#-0x29
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
    436             uint8 str[30];
    437          
    438          
    439            uint8 active_count=0;
   \   00000E   75..00       MOV     ?V0 + 1,#0x0
    440            uint8 SET_str[10];
    441            
    442             uint8 *Sample_Cmd_shorAddr;
    443              Sample_Cmd_shorAddr=SampleApp_GetShortAddr();
   \   000011                ; Setup parameters for call to function SampleApp_GetShortAddr
   \   000011   12....       LCALL   ??SampleApp_GetShortAddr?relay
   \   000014   8A..         MOV     ?V0 + 4,R2
   \   000016   8B..         MOV     ?V0 + 5,R3
   \   000018   85....       MOV     ?V0 + 2,?V0 + 4
   \   00001B   85....       MOV     ?V0 + 3,?V0 + 5
    444              SHORT_ADRESS[0]=*Sample_Cmd_shorAddr++;
   \   00001E   85..82       MOV     DPL,?V0 + 2
   \   000021   85..83       MOV     DPH,?V0 + 3
   \   000024   E0           MOVX    A,@DPTR
   \   000025   90....       MOV     DPTR,#SHORT_ADRESS
   \   000028   F0           MOVX    @DPTR,A
   \   000029   85..82       MOV     DPL,?V0 + 2
   \   00002C   85..83       MOV     DPH,?V0 + 3
   \   00002F   A3           INC     DPTR
   \   000030   8582..       MOV     ?V0 + 2,DPL
   \   000033   8583..       MOV     ?V0 + 3,DPH
    445              SHORT_ADRESS[1]=*Sample_Cmd_shorAddr++;
   \   000036   85..82       MOV     DPL,?V0 + 2
   \   000039   85..83       MOV     DPH,?V0 + 3
   \   00003C   E0           MOVX    A,@DPTR
   \   00003D   90....       MOV     DPTR,#SHORT_ADRESS + 1
   \   000040   F0           MOVX    @DPTR,A
   \   000041   85..82       MOV     DPL,?V0 + 2
   \   000044   85..83       MOV     DPH,?V0 + 3
   \   000047   A3           INC     DPTR
   \   000048   8582..       MOV     ?V0 + 2,DPL
   \   00004B   8583..       MOV     ?V0 + 3,DPH
    446              SHORT_ADRESS[2]=*Sample_Cmd_shorAddr++;
   \   00004E   85..82       MOV     DPL,?V0 + 2
   \   000051   85..83       MOV     DPH,?V0 + 3
   \   000054   E0           MOVX    A,@DPTR
   \   000055   90....       MOV     DPTR,#SHORT_ADRESS + 2
   \   000058   F0           MOVX    @DPTR,A
   \   000059   85..82       MOV     DPL,?V0 + 2
   \   00005C   85..83       MOV     DPH,?V0 + 3
   \   00005F   A3           INC     DPTR
   \   000060   8582..       MOV     ?V0 + 2,DPL
   \   000063   8583..       MOV     ?V0 + 3,DPH
    447              SHORT_ADRESS[3]=*Sample_Cmd_shorAddr;
   \   000066   85..82       MOV     DPL,?V0 + 2
   \   000069   85..83       MOV     DPH,?V0 + 3
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   90....       MOV     DPTR,#SHORT_ADRESS + 3
   \   000070   F0           MOVX    @DPTR,A
    448              osal_mem_free( shortddr_mem );
   \   000071                ; Setup parameters for call to function osal_mem_free
   \   000071   90....       MOV     DPTR,#shortddr_mem
   \   000074   E0           MOVX    A,@DPTR
   \   000075   FA           MOV     R2,A
   \   000076   A3           INC     DPTR
   \   000077   E0           MOVX    A,@DPTR
   \   000078   FB           MOV     R3,A
   \   000079   12....       LCALL   ??osal_mem_free?relay
    449            
    450            for(uint8 i=0;i<4;i++)
   \   00007C   7800         MOV     R0,#0x0
   \                     ??SampleApp_ProcessCommandMessage_0:
   \   00007E   E8           MOV     A,R0
   \   00007F   C3           CLR     C
   \   000080   9404         SUBB    A,#0x4
   \   000082   5030         JNC     ??SampleApp_ProcessCommandMessage_1
    451            {
    452             str[i] = SHORT_ADRESS[i];
   \   000084   88..         MOV     ?V0 + 4,R0
   \   000086   75..00       MOV     ?V0 + 5,#0x0
   \   000089   74..         MOV     A,#SHORT_ADRESS & 0xff
   \   00008B   25..         ADD     A,?V0 + 4
   \   00008D   F582         MOV     DPL,A
   \   00008F   74..         MOV     A,#(SHORT_ADRESS >> 8) & 0xff
   \   000091   35..         ADDC    A,?V0 + 5
   \   000093   F583         MOV     DPH,A
   \   000095   E0           MOVX    A,@DPTR
   \   000096   C0E0         PUSH    A
   \   000098   88..         MOV     ?V0 + 4,R0
   \   00009A   75..00       MOV     ?V0 + 5,#0x0
   \   00009D   740B         MOV     A,#0xb
   \   00009F   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A2   E582         MOV     A,DPL
   \   0000A4   25..         ADD     A,?V0 + 4
   \   0000A6   F582         MOV     DPL,A
   \   0000A8   E583         MOV     A,DPH
   \   0000AA   35..         ADDC    A,?V0 + 5
   \   0000AC   F583         MOV     DPH,A
   \   0000AE   D0E0         POP     A
   \   0000B0   F0           MOVX    @DPTR,A
    453            }
   \   0000B1   08           INC     R0
   \   0000B2   80CA         SJMP    ??SampleApp_ProcessCommandMessage_0
    454            str[4]='/';
   \                     ??SampleApp_ProcessCommandMessage_1:
   \   0000B4   740F         MOV     A,#0xf
   \   0000B6   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B9   742F         MOV     A,#0x2f
   \   0000BB   F0           MOVX    @DPTR,A
    455            str[5]='C';
   \   0000BC   7410         MOV     A,#0x10
   \   0000BE   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C1   7443         MOV     A,#0x43
   \   0000C3   F0           MOVX    @DPTR,A
    456            str[6]='/';
   \   0000C4   7411         MOV     A,#0x11
   \   0000C6   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C9   742F         MOV     A,#0x2f
   \   0000CB   F0           MOVX    @DPTR,A
    457            
    458          
    459             str[7]=pkt->cmd.Data[6];//处理设备发送类型
   \   0000CC   EE           MOV     A,R6
   \   0000CD   2422         ADD     A,#0x22
   \   0000CF   F582         MOV     DPL,A
   \   0000D1   EF           MOV     A,R7
   \   0000D2   3400         ADDC    A,#0x0
   \   0000D4   F583         MOV     DPH,A
   \   0000D6   E0           MOVX    A,@DPTR
   \   0000D7   F8           MOV     R0,A
   \   0000D8   A3           INC     DPTR
   \   0000D9   E0           MOVX    A,@DPTR
   \   0000DA   F583         MOV     DPH,A
   \   0000DC   8882         MOV     DPL,R0
   \   0000DE   A3           INC     DPTR
   \   0000DF   A3           INC     DPTR
   \   0000E0   A3           INC     DPTR
   \   0000E1   A3           INC     DPTR
   \   0000E2   A3           INC     DPTR
   \   0000E3   A3           INC     DPTR
   \   0000E4   E0           MOVX    A,@DPTR
   \   0000E5   C0E0         PUSH    A
   \   0000E7   7412         MOV     A,#0x12
   \   0000E9   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EC   D0E0         POP     A
   \   0000EE   F0           MOVX    @DPTR,A
    460             Sent_t=str[7];
   \   0000EF   7412         MOV     A,#0x12
   \   0000F1   12....       LCALL   ?XSTACK_DISP0_8
   \   0000F4   E0           MOVX    A,@DPTR
   \   0000F5   90....       MOV     DPTR,#Sent_t
   \   0000F8   F0           MOVX    @DPTR,A
    461                
    462            SET_str[0] = str[0];
   \   0000F9   740B         MOV     A,#0xb
   \   0000FB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000FE   E0           MOVX    A,@DPTR
   \   0000FF   C0E0         PUSH    A
   \   000101   7401         MOV     A,#0x1
   \   000103   12....       LCALL   ?XSTACK_DISP0_8
   \   000106   D0E0         POP     A
   \   000108   F0           MOVX    @DPTR,A
    463            SET_str[1] = str[1];
   \   000109   740C         MOV     A,#0xc
   \   00010B   12....       LCALL   ?XSTACK_DISP0_8
   \   00010E   E0           MOVX    A,@DPTR
   \   00010F   C0E0         PUSH    A
   \   000111   7402         MOV     A,#0x2
   \   000113   12....       LCALL   ?XSTACK_DISP0_8
   \   000116   D0E0         POP     A
   \   000118   F0           MOVX    @DPTR,A
    464            SET_str[2] = str[2];
   \   000119   740D         MOV     A,#0xd
   \   00011B   12....       LCALL   ?XSTACK_DISP0_8
   \   00011E   E0           MOVX    A,@DPTR
   \   00011F   C0E0         PUSH    A
   \   000121   7403         MOV     A,#0x3
   \   000123   12....       LCALL   ?XSTACK_DISP0_8
   \   000126   D0E0         POP     A
   \   000128   F0           MOVX    @DPTR,A
    465            SET_str[3] = str[3];
   \   000129   740E         MOV     A,#0xe
   \   00012B   12....       LCALL   ?XSTACK_DISP0_8
   \   00012E   E0           MOVX    A,@DPTR
   \   00012F   C0E0         PUSH    A
   \   000131   7404         MOV     A,#0x4
   \   000133   12....       LCALL   ?XSTACK_DISP0_8
   \   000136   D0E0         POP     A
   \   000138   F0           MOVX    @DPTR,A
    466            SET_str[4] = pkt->cmd.Data[8];
   \   000139   EE           MOV     A,R6
   \   00013A   2422         ADD     A,#0x22
   \   00013C   F582         MOV     DPL,A
   \   00013E   EF           MOV     A,R7
   \   00013F   3400         ADDC    A,#0x0
   \   000141   F583         MOV     DPH,A
   \   000143   E0           MOVX    A,@DPTR
   \   000144   F8           MOV     R0,A
   \   000145   A3           INC     DPTR
   \   000146   E0           MOVX    A,@DPTR
   \   000147   F583         MOV     DPH,A
   \   000149   8882         MOV     DPL,R0
   \   00014B   A3           INC     DPTR
   \   00014C   A3           INC     DPTR
   \   00014D   A3           INC     DPTR
   \   00014E   A3           INC     DPTR
   \   00014F   A3           INC     DPTR
   \   000150   A3           INC     DPTR
   \   000151   A3           INC     DPTR
   \   000152   A3           INC     DPTR
   \   000153   E0           MOVX    A,@DPTR
   \   000154   C0E0         PUSH    A
   \   000156   7405         MOV     A,#0x5
   \   000158   12....       LCALL   ?XSTACK_DISP0_8
   \   00015B   D0E0         POP     A
   \   00015D   F0           MOVX    @DPTR,A
    467            SET_str[5] = pkt->cmd.Data[13];
   \   00015E   EE           MOV     A,R6
   \   00015F   2422         ADD     A,#0x22
   \   000161   F582         MOV     DPL,A
   \   000163   EF           MOV     A,R7
   \   000164   3400         ADDC    A,#0x0
   \   000166   F583         MOV     DPH,A
   \   000168   E0           MOVX    A,@DPTR
   \   000169   240D         ADD     A,#0xd
   \   00016B   F8           MOV     R0,A
   \   00016C   A3           INC     DPTR
   \   00016D   E0           MOVX    A,@DPTR
   \   00016E   3400         ADDC    A,#0x0
   \   000170   F9           MOV     R1,A
   \   000171   8882         MOV     DPL,R0
   \   000173   8983         MOV     DPH,R1
   \   000175   E0           MOVX    A,@DPTR
   \   000176   C0E0         PUSH    A
   \   000178   7406         MOV     A,#0x6
   \   00017A   12....       LCALL   ?XSTACK_DISP0_8
   \   00017D   D0E0         POP     A
   \   00017F   F0           MOVX    @DPTR,A
    468            SET_str[6] = pkt->cmd.Data[14];
   \   000180   EE           MOV     A,R6
   \   000181   2422         ADD     A,#0x22
   \   000183   F582         MOV     DPL,A
   \   000185   EF           MOV     A,R7
   \   000186   3400         ADDC    A,#0x0
   \   000188   F583         MOV     DPH,A
   \   00018A   E0           MOVX    A,@DPTR
   \   00018B   240E         ADD     A,#0xe
   \   00018D   F8           MOV     R0,A
   \   00018E   A3           INC     DPTR
   \   00018F   E0           MOVX    A,@DPTR
   \   000190   3400         ADDC    A,#0x0
   \   000192   F9           MOV     R1,A
   \   000193   8882         MOV     DPL,R0
   \   000195   8983         MOV     DPH,R1
   \   000197   E0           MOVX    A,@DPTR
   \   000198   C0E0         PUSH    A
   \   00019A   7407         MOV     A,#0x7
   \   00019C   12....       LCALL   ?XSTACK_DISP0_8
   \   00019F   D0E0         POP     A
   \   0001A1   F0           MOVX    @DPTR,A
    469            SET_str[7] = pkt->cmd.Data[15];
   \   0001A2   EE           MOV     A,R6
   \   0001A3   2422         ADD     A,#0x22
   \   0001A5   F582         MOV     DPL,A
   \   0001A7   EF           MOV     A,R7
   \   0001A8   3400         ADDC    A,#0x0
   \   0001AA   F583         MOV     DPH,A
   \   0001AC   E0           MOVX    A,@DPTR
   \   0001AD   240F         ADD     A,#0xf
   \   0001AF   F8           MOV     R0,A
   \   0001B0   A3           INC     DPTR
   \   0001B1   E0           MOVX    A,@DPTR
   \   0001B2   3400         ADDC    A,#0x0
   \   0001B4   F9           MOV     R1,A
   \   0001B5   8882         MOV     DPL,R0
   \   0001B7   8983         MOV     DPH,R1
   \   0001B9   E0           MOVX    A,@DPTR
   \   0001BA   C0E0         PUSH    A
   \   0001BC   7408         MOV     A,#0x8
   \   0001BE   12....       LCALL   ?XSTACK_DISP0_8
   \   0001C1   D0E0         POP     A
   \   0001C3   F0           MOVX    @DPTR,A
    470            SET_str[8] = pkt->cmd.Data[16];
   \   0001C4   EE           MOV     A,R6
   \   0001C5   2422         ADD     A,#0x22
   \   0001C7   F582         MOV     DPL,A
   \   0001C9   EF           MOV     A,R7
   \   0001CA   3400         ADDC    A,#0x0
   \   0001CC   F583         MOV     DPH,A
   \   0001CE   E0           MOVX    A,@DPTR
   \   0001CF   2410         ADD     A,#0x10
   \   0001D1   F8           MOV     R0,A
   \   0001D2   A3           INC     DPTR
   \   0001D3   E0           MOVX    A,@DPTR
   \   0001D4   3400         ADDC    A,#0x0
   \   0001D6   F9           MOV     R1,A
   \   0001D7   8882         MOV     DPL,R0
   \   0001D9   8983         MOV     DPH,R1
   \   0001DB   E0           MOVX    A,@DPTR
   \   0001DC   C0E0         PUSH    A
   \   0001DE   7409         MOV     A,#0x9
   \   0001E0   12....       LCALL   ?XSTACK_DISP0_8
   \   0001E3   D0E0         POP     A
   \   0001E5   F0           MOVX    @DPTR,A
    471            SET_str[9] = ABS(pkt->rssi);
   \   0001E6   EE           MOV     A,R6
   \   0001E7   2418         ADD     A,#0x18
   \   0001E9   F582         MOV     DPL,A
   \   0001EB   EF           MOV     A,R7
   \   0001EC   3400         ADDC    A,#0x0
   \   0001EE   F583         MOV     DPH,A
   \   0001F0   E0           MOVX    A,@DPTR
   \   0001F1   C3           CLR     C
   \   0001F2   9400         SUBB    A,#0x0
   \   0001F4   A2D2         MOV     C,0xD0 /* PSW */.2
   \   0001F6   65D0         XRL     A,PSW
   \   0001F8   33           RLC     A
   \   0001F9   5016         JNC     ??SampleApp_ProcessCommandMessage_2
   \   0001FB   EE           MOV     A,R6
   \   0001FC   2418         ADD     A,#0x18
   \   0001FE   F582         MOV     DPL,A
   \   000200   EF           MOV     A,R7
   \   000201   3400         ADDC    A,#0x0
   \   000203   F583         MOV     DPH,A
   \   000205   E0           MOVX    A,@DPTR
   \   000206   F4           CPL     A
   \   000207   04           INC     A
   \   000208   85..82       MOV     DPL,?XSP + 0
   \   00020B   85..83       MOV     DPH,?XSP + 1
   \   00020E   F0           MOVX    @DPTR,A
   \   00020F   8012         SJMP    ??SampleApp_ProcessCommandMessage_3
   \                     ??SampleApp_ProcessCommandMessage_2:
   \   000211   EE           MOV     A,R6
   \   000212   2418         ADD     A,#0x18
   \   000214   F582         MOV     DPL,A
   \   000216   EF           MOV     A,R7
   \   000217   3400         ADDC    A,#0x0
   \   000219   F583         MOV     DPH,A
   \   00021B   E0           MOVX    A,@DPTR
   \   00021C   85..82       MOV     DPL,?XSP + 0
   \   00021F   85..83       MOV     DPH,?XSP + 1
   \   000222   F0           MOVX    @DPTR,A
   \                     ??SampleApp_ProcessCommandMessage_3:
   \   000223   85..82       MOV     DPL,?XSP + 0
   \   000226   85..83       MOV     DPH,?XSP + 1
   \   000229   E0           MOVX    A,@DPTR
   \   00022A   C0E0         PUSH    A
   \   00022C   740A         MOV     A,#0xa
   \   00022E   12....       LCALL   ?XSTACK_DISP0_8
   \   000231   D0E0         POP     A
   \   000233   F0           MOVX    @DPTR,A
    472            
    473            APP_NORMAL_COMMAND(SET_str); 
   \   000234                ; Setup parameters for call to function APP_NORMAL_COMMAND
   \   000234   7401         MOV     A,#0x1
   \   000236   12....       LCALL   ?XSTACK_DISP0_8
   \   000239   AA82         MOV     R2,DPL
   \   00023B   AB83         MOV     R3,DPH
   \   00023D   12....       LCALL   ??APP_NORMAL_COMMAND?relay
    474             
    475               //处理设备命令类  窗帘控制器
    476             if(pkt->cmd.Data[8]==DEFINED_CONTROL_CHAR)
   \   000240   EE           MOV     A,R6
   \   000241   2422         ADD     A,#0x22
   \   000243   F582         MOV     DPL,A
   \   000245   EF           MOV     A,R7
   \   000246   3400         ADDC    A,#0x0
   \   000248   F583         MOV     DPH,A
   \   00024A   E0           MOVX    A,@DPTR
   \   00024B   F8           MOV     R0,A
   \   00024C   A3           INC     DPTR
   \   00024D   E0           MOVX    A,@DPTR
   \   00024E   F583         MOV     DPH,A
   \   000250   8882         MOV     DPL,R0
   \   000252   A3           INC     DPTR
   \   000253   A3           INC     DPTR
   \   000254   A3           INC     DPTR
   \   000255   A3           INC     DPTR
   \   000256   A3           INC     DPTR
   \   000257   A3           INC     DPTR
   \   000258   A3           INC     DPTR
   \   000259   A3           INC     DPTR
   \   00025A   E0           MOVX    A,@DPTR
   \   00025B   F8           MOV     R0,A
   \   00025C   90....       MOV     DPTR,#DEFINED_CONTROL_CHAR
   \   00025F   E0           MOVX    A,@DPTR
   \   000260   68           XRL     A,R0
   \   000261   6003         JZ      $+5
   \   000263   02....       LJMP    ??SampleApp_ProcessCommandMessage_4 & 0xFFFF
    477             {
    478            
    479              active_count = USER_APP_COMMAND(&pkt->cmd.Data[13],&str[9]);
   \   000266                ; Setup parameters for call to function USER_APP_COMMAND
   \   000266   7414         MOV     A,#0x14
   \   000268   12....       LCALL   ?XSTACK_DISP0_8
   \   00026B   AC82         MOV     R4,DPL
   \   00026D   AD83         MOV     R5,DPH
   \   00026F   EE           MOV     A,R6
   \   000270   2422         ADD     A,#0x22
   \   000272   F582         MOV     DPL,A
   \   000274   EF           MOV     A,R7
   \   000275   3400         ADDC    A,#0x0
   \   000277   F583         MOV     DPH,A
   \   000279   E0           MOVX    A,@DPTR
   \   00027A   240D         ADD     A,#0xd
   \   00027C   FA           MOV     R2,A
   \   00027D   A3           INC     DPTR
   \   00027E   E0           MOVX    A,@DPTR
   \   00027F   3400         ADDC    A,#0x0
   \   000281   FB           MOV     R3,A
   \   000282   12....       LCALL   ??USER_APP_COMMAND?relay
   \   000285   E9           MOV     A,R1
   \   000286   F5..         MOV     ?V0 + 1,A
    480              str[8]='U';//单次返回
   \   000288   7413         MOV     A,#0x13
   \   00028A   12....       LCALL   ?XSTACK_DISP0_8
   \   00028D   7455         MOV     A,#0x55
   \   00028F   F0           MOVX    @DPTR,A
    481              SampleApp_SPI_SendCommand_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   000290   90....       MOV     DPTR,#SampleApp_SPI_SendCommand_DstAddr + 8
   \   000293   7402         MOV     A,#0x2
   \   000295   F0           MOVX    @DPTR,A
    482              SampleApp_SPI_SendCommand_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;
   \   000296   90....       MOV     DPTR,#SampleApp_SPI_SendCommand_DstAddr + 9
   \   000299   7414         MOV     A,#0x14
   \   00029B   F0           MOVX    @DPTR,A
    483              SampleApp_SPI_SendCommand_DstAddr.addr.shortAddr = pkt->srcAddr.addr.shortAddr;//发送给来的设备
   \   00029C   8E82         MOV     DPL,R6
   \   00029E   8F83         MOV     DPH,R7
   \   0002A0   A3           INC     DPTR
   \   0002A1   A3           INC     DPTR
   \   0002A2   A3           INC     DPTR
   \   0002A3   A3           INC     DPTR
   \   0002A4   A3           INC     DPTR
   \   0002A5   A3           INC     DPTR
   \   0002A6   E0           MOVX    A,@DPTR
   \   0002A7   F8           MOV     R0,A
   \   0002A8   A3           INC     DPTR
   \   0002A9   E0           MOVX    A,@DPTR
   \   0002AA   F9           MOV     R1,A
   \   0002AB   90....       MOV     DPTR,#SampleApp_SPI_SendCommand_DstAddr
   \   0002AE   E8           MOV     A,R0
   \   0002AF   F0           MOVX    @DPTR,A
   \   0002B0   A3           INC     DPTR
   \   0002B1   E9           MOV     A,R1
   \   0002B2   F0           MOVX    @DPTR,A
    484          
    485              if ( AF_DataRequest( &SampleApp_SPI_SendCommand_DstAddr,
    486                                   (endPointDesc_t *)&SampleApp_epDesc,
    487                                    SAMPLEAPP_COMMAND_CLUSTERID, //终端传过去，协调器处理了
    488                                    active_count, str,
    489                                    &SampleApp_TransID, 
    490                                    AF_DISCV_ROUTE, 
    491                                    AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   0002B3                ; Setup parameters for call to function AF_DataRequest
   \   0002B3   75..0F       MOV     ?V0 + 0,#0xf
   \   0002B6   78..         MOV     R0,#?V0 + 0
   \   0002B8   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0002BB   75....       MOV     ?V0 + 4,#SampleApp_TransID & 0xff
   \   0002BE   75....       MOV     ?V0 + 5,#(SampleApp_TransID >> 8) & 0xff
   \   0002C1   78..         MOV     R0,#?V0 + 4
   \   0002C3   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0002C6   740E         MOV     A,#0xe
   \   0002C8   12....       LCALL   ?XSTACK_DISP0_8
   \   0002CB   8582..       MOV     ?V0 + 4,DPL
   \   0002CE   8583..       MOV     ?V0 + 5,DPH
   \   0002D1   78..         MOV     R0,#?V0 + 4
   \   0002D3   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0002D6   85....       MOV     ?V0 + 0,?V0 + 1
   \   0002D9   85....       MOV     ?V0 + 4,?V0 + 0
   \   0002DC   75..00       MOV     ?V0 + 5,#0x0
   \   0002DF   78..         MOV     R0,#?V0 + 4
   \   0002E1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0002E4   75..04       MOV     ?V0 + 4,#0x4
   \   0002E7   75..00       MOV     ?V0 + 5,#0x0
   \   0002EA   78..         MOV     R0,#?V0 + 4
   \   0002EC   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0002EF   7920         MOV     R1,#0x20
   \   0002F1   7C..         MOV     R4,#SampleApp_epDesc & 0xff
   \   0002F3   7D..         MOV     R5,#(SampleApp_epDesc >> 8) & 0xff
   \   0002F5   7A..         MOV     R2,#SampleApp_SPI_SendCommand_DstAddr & 0xff
   \   0002F7   7B..         MOV     R3,#(SampleApp_SPI_SendCommand_DstAddr >> 8) & 0xff
   \   0002F9   12....       LCALL   ??AF_DataRequest?relay
   \   0002FC   7409         MOV     A,#0x9
   \   0002FE   12....       LCALL   ?DEALLOC_XSTACK8
   \   000301   E9           MOV     A,R1
   \   000302   85..82       MOV     DPL,?XSP + 0
   \   000305   85..83       MOV     DPH,?XSP + 1
   \   000308   F0           MOVX    @DPTR,A
   \   000309   02....       LJMP    ??SampleApp_ProcessCommandMessage_5 & 0xFFFF
    492              {
    493                
    494               }
    495              else
    496               {
    497                 
    498               }
    499               
    500                 /* 
    501               
    502              str[9]='/';
    503          
    504             CmdType = pkt->cmd.Data[13];//窗帘设备命令类型 学习 使用
    505             IRCodeIndex = (pkt->cmd.Data[14]- '0')*100 +
    506                           (pkt->cmd.Data[15]- '0')*10 +
    507                           (pkt->cmd.Data[16]- '0');      //编码序号
    508             if('1' == CmdType)		//'1' 表示学习
    509             {
    510               irCodeRx(IRCodeIndex);
    511            //   changePollRate();
    512             }
    513             else if('2' == CmdType)	//'2' 表示使用
    514             {   
    515               irCodeTx(IRCodeIndex);
    516             //  changePollRate();
    517             }
    518            
    519             str[10] = CmdType - '0';//数据回填
    520             str[12] = IRCodeIndex;//数据回填
    521             str[11] = IRCodeIndex >> 8;
    522          
    523          
    524              if ( AF_DataRequest( &SampleApp_SPI_SendCommand_DstAddr,
    525                                   (endPointDesc_t *)&SampleApp_epDesc,
    526                                    SAMPLEAPP_COMMAND_CLUSTERID, //终端传过去，协调器处理了
    527                                    13, str,
    528                                    &SampleApp_TransID, 
    529                                    AF_DISCV_ROUTE, 
    530                                    AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
    531              {
    532                
    533               }
    534              else
    535               {
    536                 
    537               }
    538               */
    539               
    540             }
    541           
    542           
    543              else if(pkt->cmd.Data[8]=='L')//v:118
   \                     ??SampleApp_ProcessCommandMessage_4:
   \   00030C   EE           MOV     A,R6
   \   00030D   2422         ADD     A,#0x22
   \   00030F   F582         MOV     DPL,A
   \   000311   EF           MOV     A,R7
   \   000312   3400         ADDC    A,#0x0
   \   000314   F583         MOV     DPH,A
   \   000316   E0           MOVX    A,@DPTR
   \   000317   F8           MOV     R0,A
   \   000318   A3           INC     DPTR
   \   000319   E0           MOVX    A,@DPTR
   \   00031A   F583         MOV     DPH,A
   \   00031C   8882         MOV     DPL,R0
   \   00031E   A3           INC     DPTR
   \   00031F   A3           INC     DPTR
   \   000320   A3           INC     DPTR
   \   000321   A3           INC     DPTR
   \   000322   A3           INC     DPTR
   \   000323   A3           INC     DPTR
   \   000324   A3           INC     DPTR
   \   000325   A3           INC     DPTR
   \   000326   E0           MOVX    A,@DPTR
   \   000327   644C         XRL     A,#0x4c
   \   000329   7073         JNZ     ??SampleApp_ProcessCommandMessage_6
    544           {
    545            uint8 blink_count=0;
   \   00032B   75..00       MOV     ?V0 + 0,#0x0
    546            blink_count = (pkt->cmd.Data[13]-0x30)*100 + (pkt->cmd.Data[14]-0x30)*10 + (pkt->cmd.Data[15]-0x30);
   \   00032E   EE           MOV     A,R6
   \   00032F   2422         ADD     A,#0x22
   \   000331   F582         MOV     DPL,A
   \   000333   EF           MOV     A,R7
   \   000334   3400         ADDC    A,#0x0
   \   000336   F583         MOV     DPH,A
   \   000338   E0           MOVX    A,@DPTR
   \   000339   240F         ADD     A,#0xf
   \   00033B   F8           MOV     R0,A
   \   00033C   A3           INC     DPTR
   \   00033D   E0           MOVX    A,@DPTR
   \   00033E   3400         ADDC    A,#0x0
   \   000340   F9           MOV     R1,A
   \   000341   8882         MOV     DPL,R0
   \   000343   8983         MOV     DPH,R1
   \   000345   C082         PUSH    DPL
   \   000347   C083         PUSH    DPH
   \   000349   75F00A       MOV     B,#0xa
   \   00034C   EE           MOV     A,R6
   \   00034D   2422         ADD     A,#0x22
   \   00034F   F582         MOV     DPL,A
   \   000351   EF           MOV     A,R7
   \   000352   3400         ADDC    A,#0x0
   \   000354   F583         MOV     DPH,A
   \   000356   E0           MOVX    A,@DPTR
   \   000357   240E         ADD     A,#0xe
   \   000359   F8           MOV     R0,A
   \   00035A   A3           INC     DPTR
   \   00035B   E0           MOVX    A,@DPTR
   \   00035C   3400         ADDC    A,#0x0
   \   00035E   F9           MOV     R1,A
   \   00035F   8882         MOV     DPL,R0
   \   000361   8983         MOV     DPH,R1
   \   000363   E0           MOVX    A,@DPTR
   \   000364   A4           MUL     AB
   \   000365   FA           MOV     R2,A
   \   000366   75F064       MOV     B,#0x64
   \   000369   EE           MOV     A,R6
   \   00036A   2422         ADD     A,#0x22
   \   00036C   F582         MOV     DPL,A
   \   00036E   EF           MOV     A,R7
   \   00036F   3400         ADDC    A,#0x0
   \   000371   F583         MOV     DPH,A
   \   000373   E0           MOVX    A,@DPTR
   \   000374   240D         ADD     A,#0xd
   \   000376   F8           MOV     R0,A
   \   000377   A3           INC     DPTR
   \   000378   E0           MOVX    A,@DPTR
   \   000379   3400         ADDC    A,#0x0
   \   00037B   F9           MOV     R1,A
   \   00037C   8882         MOV     DPL,R0
   \   00037E   8983         MOV     DPH,R1
   \   000380   E0           MOVX    A,@DPTR
   \   000381   A4           MUL     AB
   \   000382   2A           ADD     A,R2
   \   000383   D083         POP     DPH
   \   000385   D082         POP     DPL
   \   000387   F8           MOV     R0,A
   \   000388   E0           MOVX    A,@DPTR
   \   000389   28           ADD     A,R0
   \   00038A   2430         ADD     A,#0x30
   \   00038C   F5..         MOV     ?V0 + 0,A
    547            HalLedBlink ( HAL_LED_2, blink_count, 50, 800 );
   \   00038E                ; Setup parameters for call to function HalLedBlink
   \   00038E   7C20         MOV     R4,#0x20
   \   000390   7D03         MOV     R5,#0x3
   \   000392   7B32         MOV     R3,#0x32
   \   000394   AA..         MOV     R2,?V0 + 0
   \   000396   7902         MOV     R1,#0x2
   \   000398   12....       LCALL   ??HalLedBlink?relay
   \   00039B   02....       LJMP    ??SampleApp_ProcessCommandMessage_5 & 0xFFFF
    548          
    549           }
    550            else if(pkt->cmd.Data[8]=='O')
   \                     ??SampleApp_ProcessCommandMessage_6:
   \   00039E   EE           MOV     A,R6
   \   00039F   2422         ADD     A,#0x22
   \   0003A1   F582         MOV     DPL,A
   \   0003A3   EF           MOV     A,R7
   \   0003A4   3400         ADDC    A,#0x0
   \   0003A6   F583         MOV     DPH,A
   \   0003A8   E0           MOVX    A,@DPTR
   \   0003A9   F8           MOV     R0,A
   \   0003AA   A3           INC     DPTR
   \   0003AB   E0           MOVX    A,@DPTR
   \   0003AC   F583         MOV     DPH,A
   \   0003AE   8882         MOV     DPL,R0
   \   0003B0   A3           INC     DPTR
   \   0003B1   A3           INC     DPTR
   \   0003B2   A3           INC     DPTR
   \   0003B3   A3           INC     DPTR
   \   0003B4   A3           INC     DPTR
   \   0003B5   A3           INC     DPTR
   \   0003B6   A3           INC     DPTR
   \   0003B7   A3           INC     DPTR
   \   0003B8   E0           MOVX    A,@DPTR
   \   0003B9   644F         XRL     A,#0x4f
   \   0003BB   6003         JZ      $+5
   \   0003BD   02....       LJMP    ??SampleApp_ProcessCommandMessage_7 & 0xFFFF
    551            {
    552              
    553                 uint8 *SET_str;
    554                 uint8 sent_flag = 0;
   \   0003C0   75..00       MOV     ?V0 + 0,#0x0
    555                 
    556                 HalLedBlink ( HAL_LED_1, 1, 50, 1000 );
   \   0003C3                ; Setup parameters for call to function HalLedBlink
   \   0003C3   7CE8         MOV     R4,#-0x18
   \   0003C5   7D03         MOV     R5,#0x3
   \   0003C7   7B32         MOV     R3,#0x32
   \   0003C9   7A01         MOV     R2,#0x1
   \   0003CB   7901         MOV     R1,#0x1
   \   0003CD   12....       LCALL   ??HalLedBlink?relay
    557                 if((pkt->cmd.Data[13]-'0') ==  1)
   \   0003D0   EE           MOV     A,R6
   \   0003D1   2422         ADD     A,#0x22
   \   0003D3   F582         MOV     DPL,A
   \   0003D5   EF           MOV     A,R7
   \   0003D6   3400         ADDC    A,#0x0
   \   0003D8   F583         MOV     DPH,A
   \   0003DA   E0           MOVX    A,@DPTR
   \   0003DB   240D         ADD     A,#0xd
   \   0003DD   F8           MOV     R0,A
   \   0003DE   A3           INC     DPTR
   \   0003DF   E0           MOVX    A,@DPTR
   \   0003E0   3400         ADDC    A,#0x0
   \   0003E2   F9           MOV     R1,A
   \   0003E3   8882         MOV     DPL,R0
   \   0003E5   8983         MOV     DPH,R1
   \   0003E7   E0           MOVX    A,@DPTR
   \   0003E8   F8           MOV     R0,A
   \   0003E9   7900         MOV     R1,#0x0
   \   0003EB   24D0         ADD     A,#-0x30
   \   0003ED   F8           MOV     R0,A
   \   0003EE   E9           MOV     A,R1
   \   0003EF   34FF         ADDC    A,#-0x1
   \   0003F1   F9           MOV     R1,A
   \   0003F2   7401         MOV     A,#0x1
   \   0003F4   68           XRL     A,R0
   \   0003F5   7003         JNZ     ??SampleApp_ProcessCommandMessage_8
   \   0003F7   7400         MOV     A,#0x0
   \   0003F9   69           XRL     A,R1
   \                     ??SampleApp_ProcessCommandMessage_8:
   \   0003FA   6003         JZ      $+5
   \   0003FC   02....       LJMP    ??SampleApp_ProcessCommandMessage_9 & 0xFFFF
    558                 {
    559                   pollrate_time = 100*(pkt->cmd.Data[14]-'0')+10*(pkt->cmd.Data[15]-'0')+(pkt->cmd.Data[16]-'0');
   \   0003FF   EE           MOV     A,R6
   \   000400   2422         ADD     A,#0x22
   \   000402   F582         MOV     DPL,A
   \   000404   EF           MOV     A,R7
   \   000405   3400         ADDC    A,#0x0
   \   000407   F583         MOV     DPH,A
   \   000409   E0           MOVX    A,@DPTR
   \   00040A   240E         ADD     A,#0xe
   \   00040C   F8           MOV     R0,A
   \   00040D   A3           INC     DPTR
   \   00040E   E0           MOVX    A,@DPTR
   \   00040F   3400         ADDC    A,#0x0
   \   000411   F9           MOV     R1,A
   \   000412   8882         MOV     DPL,R0
   \   000414   8983         MOV     DPH,R1
   \   000416   E0           MOVX    A,@DPTR
   \   000417   F8           MOV     R0,A
   \   000418   7900         MOV     R1,#0x0
   \   00041A   E8           MOV     A,R0
   \   00041B   75F064       MOV     B,#0x64
   \   00041E   A4           MUL     AB
   \   00041F   C8           XCH     A,R0
   \   000420   AAF0         MOV     R2,B
   \   000422   75F000       MOV     B,#0x0
   \   000425   A4           MUL     AB
   \   000426   2A           ADD     A,R2
   \   000427   FA           MOV     R2,A
   \   000428   75F064       MOV     B,#0x64
   \   00042B   E9           MOV     A,R1
   \   00042C   A4           MUL     AB
   \   00042D   2A           ADD     A,R2
   \   00042E   F9           MOV     R1,A
   \   00042F   EE           MOV     A,R6
   \   000430   2422         ADD     A,#0x22
   \   000432   F582         MOV     DPL,A
   \   000434   EF           MOV     A,R7
   \   000435   3400         ADDC    A,#0x0
   \   000437   F583         MOV     DPH,A
   \   000439   E0           MOVX    A,@DPTR
   \   00043A   240F         ADD     A,#0xf
   \   00043C   FA           MOV     R2,A
   \   00043D   A3           INC     DPTR
   \   00043E   E0           MOVX    A,@DPTR
   \   00043F   3400         ADDC    A,#0x0
   \   000441   FB           MOV     R3,A
   \   000442   8A82         MOV     DPL,R2
   \   000444   8B83         MOV     DPH,R3
   \   000446   E0           MOVX    A,@DPTR
   \   000447   FA           MOV     R2,A
   \   000448   7B00         MOV     R3,#0x0
   \   00044A   EA           MOV     A,R2
   \   00044B   75F00A       MOV     B,#0xa
   \   00044E   A4           MUL     AB
   \   00044F   CA           XCH     A,R2
   \   000450   ACF0         MOV     R4,B
   \   000452   75F000       MOV     B,#0x0
   \   000455   A4           MUL     AB
   \   000456   2C           ADD     A,R4
   \   000457   FC           MOV     R4,A
   \   000458   75F00A       MOV     B,#0xa
   \   00045B   EB           MOV     A,R3
   \   00045C   A4           MUL     AB
   \   00045D   2C           ADD     A,R4
   \   00045E   FB           MOV     R3,A
   \   00045F   E8           MOV     A,R0
   \   000460   2A           ADD     A,R2
   \   000461   F8           MOV     R0,A
   \   000462   E9           MOV     A,R1
   \   000463   3B           ADDC    A,R3
   \   000464   F9           MOV     R1,A
   \   000465   EE           MOV     A,R6
   \   000466   2422         ADD     A,#0x22
   \   000468   F582         MOV     DPL,A
   \   00046A   EF           MOV     A,R7
   \   00046B   3400         ADDC    A,#0x0
   \   00046D   F583         MOV     DPH,A
   \   00046F   E0           MOVX    A,@DPTR
   \   000470   2410         ADD     A,#0x10
   \   000472   FA           MOV     R2,A
   \   000473   A3           INC     DPTR
   \   000474   E0           MOVX    A,@DPTR
   \   000475   3400         ADDC    A,#0x0
   \   000477   FB           MOV     R3,A
   \   000478   8A82         MOV     DPL,R2
   \   00047A   8B83         MOV     DPH,R3
   \   00047C   E0           MOVX    A,@DPTR
   \   00047D   FA           MOV     R2,A
   \   00047E   7B00         MOV     R3,#0x0
   \   000480   E8           MOV     A,R0
   \   000481   2A           ADD     A,R2
   \   000482   F8           MOV     R0,A
   \   000483   E9           MOV     A,R1
   \   000484   3B           ADDC    A,R3
   \   000485   F9           MOV     R1,A
   \   000486   E8           MOV     A,R0
   \   000487   2430         ADD     A,#0x30
   \   000489   F8           MOV     R0,A
   \   00048A   E9           MOV     A,R1
   \   00048B   34EB         ADDC    A,#-0x15
   \   00048D   F9           MOV     R1,A
   \   00048E   90....       MOV     DPTR,#pollrate_time
   \   000491   E8           MOV     A,R0
   \   000492   F0           MOVX    @DPTR,A
   \   000493   A3           INC     DPTR
   \   000494   E9           MOV     A,R1
   \   000495   F0           MOVX    @DPTR,A
    560                   if(pollrate_time > 120 )
   \   000496   90....       MOV     DPTR,#pollrate_time
   \   000499   C3           CLR     C
   \   00049A   E0           MOVX    A,@DPTR
   \   00049B   9479         SUBB    A,#0x79
   \   00049D   A3           INC     DPTR
   \   00049E   E0           MOVX    A,@DPTR
   \   00049F   9400         SUBB    A,#0x0
   \   0004A1   400C         JC      ??SampleApp_ProcessCommandMessage_10
    561                   {
    562                     pollrate_time = 120;
   \   0004A3   90....       MOV     DPTR,#pollrate_time
   \   0004A6   7478         MOV     A,#0x78
   \   0004A8   F0           MOVX    @DPTR,A
   \   0004A9   A3           INC     DPTR
   \   0004AA   7400         MOV     A,#0x0
   \   0004AC   F0           MOVX    @DPTR,A
   \   0004AD   8016         SJMP    ??SampleApp_ProcessCommandMessage_11
    563                   }
    564                   else if(pollrate_time == 0)
   \                     ??SampleApp_ProcessCommandMessage_10:
   \   0004AF   90....       MOV     DPTR,#pollrate_time
   \   0004B2   E0           MOVX    A,@DPTR
   \   0004B3   F8           MOV     R0,A
   \   0004B4   A3           INC     DPTR
   \   0004B5   E0           MOVX    A,@DPTR
   \   0004B6   F9           MOV     R1,A
   \   0004B7   E8           MOV     A,R0
   \   0004B8   49           ORL     A,R1
   \   0004B9   700A         JNZ     ??SampleApp_ProcessCommandMessage_11
    565                   {
    566                     pollrate_time = 1;
   \   0004BB   90....       MOV     DPTR,#pollrate_time
   \   0004BE   7401         MOV     A,#0x1
   \   0004C0   F0           MOVX    @DPTR,A
   \   0004C1   A3           INC     DPTR
   \   0004C2   7400         MOV     A,#0x0
   \   0004C4   F0           MOVX    @DPTR,A
    567                   }
    568                   
    569                   if(POLLRATE_TIME_VALUE!=pollrate_time)
   \                     ??SampleApp_ProcessCommandMessage_11:
   \   0004C5   90....       MOV     DPTR,#POLLRATE_TIME_VALUE
   \   0004C8   E0           MOVX    A,@DPTR
   \   0004C9   F8           MOV     R0,A
   \   0004CA   7900         MOV     R1,#0x0
   \   0004CC   90....       MOV     DPTR,#pollrate_time
   \   0004CF   E0           MOVX    A,@DPTR
   \   0004D0   68           XRL     A,R0
   \   0004D1   7003         JNZ     ??SampleApp_ProcessCommandMessage_12
   \   0004D3   A3           INC     DPTR
   \   0004D4   E0           MOVX    A,@DPTR
   \   0004D5   69           XRL     A,R1
   \                     ??SampleApp_ProcessCommandMessage_12:
   \   0004D6   6054         JZ      ??SampleApp_ProcessCommandMessage_13
    570                   { 
    571                     POLLRATE_TIME_VALUE = (uint8)pollrate_time;
   \   0004D8   90....       MOV     DPTR,#pollrate_time
   \   0004DB   E0           MOVX    A,@DPTR
   \   0004DC   F8           MOV     R0,A
   \   0004DD   A3           INC     DPTR
   \   0004DE   E0           MOVX    A,@DPTR
   \   0004DF   F9           MOV     R1,A
   \   0004E0   E8           MOV     A,R0
   \   0004E1   90....       MOV     DPTR,#POLLRATE_TIME_VALUE
   \   0004E4   F0           MOVX    @DPTR,A
    572                     osal_nv_write( ZCD_NV_POLLRATE_TIME, 0, 1, &POLLRATE_TIME_VALUE );  
   \   0004E5                ; Setup parameters for call to function osal_nv_write
   \   0004E5   75....       MOV     ?V0 + 6,#POLLRATE_TIME_VALUE & 0xff
   \   0004E8   75....       MOV     ?V0 + 7,#(POLLRATE_TIME_VALUE >> 8) & 0xff
   \   0004EB   78..         MOV     R0,#?V0 + 6
   \   0004ED   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0004F0   75..01       MOV     ?V0 + 6,#0x1
   \   0004F3   75..00       MOV     ?V0 + 7,#0x0
   \   0004F6   78..         MOV     R0,#?V0 + 6
   \   0004F8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0004FB   7C00         MOV     R4,#0x0
   \   0004FD   7D00         MOV     R5,#0x0
   \   0004FF   7A18         MOV     R2,#0x18
   \   000501   7B04         MOV     R3,#0x4
   \   000503   12....       LCALL   ??osal_nv_write?relay
   \   000506   7404         MOV     A,#0x4
   \   000508   12....       LCALL   ?DEALLOC_XSTACK8
   \   00050B   E9           MOV     A,R1
    573                     //pollrate_time = pollrate_time * 500;
    574                     NLME_SetPollRate( pollrate_time * 500 ); 
   \   00050C                ; Setup parameters for call to function NLME_SetPollRate
   \   00050C   90....       MOV     DPTR,#pollrate_time
   \   00050F   E0           MOVX    A,@DPTR
   \   000510   FA           MOV     R2,A
   \   000511   A3           INC     DPTR
   \   000512   E0           MOVX    A,@DPTR
   \   000513   FB           MOV     R3,A
   \   000514   EA           MOV     A,R2
   \   000515   75F0F4       MOV     B,#-0xc
   \   000518   A4           MUL     AB
   \   000519   CA           XCH     A,R2
   \   00051A   A8F0         MOV     R0,B
   \   00051C   75F001       MOV     B,#0x1
   \   00051F   A4           MUL     AB
   \   000520   28           ADD     A,R0
   \   000521   F8           MOV     R0,A
   \   000522   75F0F4       MOV     B,#-0xc
   \   000525   EB           MOV     A,R3
   \   000526   A4           MUL     AB
   \   000527   28           ADD     A,R0
   \   000528   FB           MOV     R3,A
   \   000529   12....       LCALL   ??NLME_SetPollRate?relay
    575                   }
    576                   //else
    577                   //pollrate_time = pollrate_time * 500;
    578                   sent_flag = 1;
   \                     ??SampleApp_ProcessCommandMessage_13:
   \   00052C   75..01       MOV     ?V0 + 0,#0x1
   \   00052F   802F         SJMP    ??SampleApp_ProcessCommandMessage_14
    579                 }
    580                 else if((pkt->cmd.Data[13]-'0') ==  2)
   \                     ??SampleApp_ProcessCommandMessage_9:
   \   000531   EE           MOV     A,R6
   \   000532   2422         ADD     A,#0x22
   \   000534   F582         MOV     DPL,A
   \   000536   EF           MOV     A,R7
   \   000537   3400         ADDC    A,#0x0
   \   000539   F583         MOV     DPH,A
   \   00053B   E0           MOVX    A,@DPTR
   \   00053C   240D         ADD     A,#0xd
   \   00053E   F8           MOV     R0,A
   \   00053F   A3           INC     DPTR
   \   000540   E0           MOVX    A,@DPTR
   \   000541   3400         ADDC    A,#0x0
   \   000543   F9           MOV     R1,A
   \   000544   8882         MOV     DPL,R0
   \   000546   8983         MOV     DPH,R1
   \   000548   E0           MOVX    A,@DPTR
   \   000549   F8           MOV     R0,A
   \   00054A   7900         MOV     R1,#0x0
   \   00054C   24D0         ADD     A,#-0x30
   \   00054E   F8           MOV     R0,A
   \   00054F   E9           MOV     A,R1
   \   000550   34FF         ADDC    A,#-0x1
   \   000552   F9           MOV     R1,A
   \   000553   7402         MOV     A,#0x2
   \   000555   68           XRL     A,R0
   \   000556   7003         JNZ     ??SampleApp_ProcessCommandMessage_15
   \   000558   7400         MOV     A,#0x0
   \   00055A   69           XRL     A,R1
   \                     ??SampleApp_ProcessCommandMessage_15:
   \   00055B   7003         JNZ     ??SampleApp_ProcessCommandMessage_14
    581                 {
    582                   //osal_nv_item_init( ZCD_NV_POLLRATE_TIME, 1, &POLLRATE_TIME_VALUE );  
    583                   //osal_nv_read( ZCD_NV_POLLRATE_TIME, 0, 1, &POLLRATE_TIME_VALUE );
    584                   //if((POLLRATE_TIME_VALUE!=0)&&(POLLRATE_TIME_VALUE!=255))
    585                   //pollrate_time = POLLRATE_TIME_VALUE * 500; 
    586                   //else
    587                   //pollrate_time = 2000; // default 2S
    588                   sent_flag = 1;
   \   00055D   75..01       MOV     ?V0 + 0,#0x1
    589                 }
    590                 
    591                 if(sent_flag)
   \                     ??SampleApp_ProcessCommandMessage_14:
   \   000560   E5..         MOV     A,?V0 + 0
   \   000562   7003         JNZ     $+5
   \   000564   02....       LJMP    ??SampleApp_ProcessCommandMessage_5 & 0xFFFF
    592                 {
    593                   
    594                   pollrate_time = POLLRATE_TIME_VALUE * 500;
   \   000567   90....       MOV     DPTR,#POLLRATE_TIME_VALUE
   \   00056A   E0           MOVX    A,@DPTR
   \   00056B   F8           MOV     R0,A
   \   00056C   7900         MOV     R1,#0x0
   \   00056E   E8           MOV     A,R0
   \   00056F   75F0F4       MOV     B,#-0xc
   \   000572   A4           MUL     AB
   \   000573   C8           XCH     A,R0
   \   000574   AAF0         MOV     R2,B
   \   000576   75F001       MOV     B,#0x1
   \   000579   A4           MUL     AB
   \   00057A   2A           ADD     A,R2
   \   00057B   FA           MOV     R2,A
   \   00057C   75F0F4       MOV     B,#-0xc
   \   00057F   E9           MOV     A,R1
   \   000580   A4           MUL     AB
   \   000581   2A           ADD     A,R2
   \   000582   F9           MOV     R1,A
   \   000583   90....       MOV     DPTR,#pollrate_time
   \   000586   E8           MOV     A,R0
   \   000587   F0           MOVX    @DPTR,A
   \   000588   A3           INC     DPTR
   \   000589   E9           MOV     A,R1
   \   00058A   F0           MOVX    @DPTR,A
    595                   
    596                   SET_str=osal_mem_alloc(13);
   \   00058B                ; Setup parameters for call to function osal_mem_alloc
   \   00058B   7A0D         MOV     R2,#0xd
   \   00058D   7B00         MOV     R3,#0x0
   \   00058F   12....       LCALL   ??osal_mem_alloc?relay
   \   000592   8A..         MOV     ?V0 + 6,R2
   \   000594   8B..         MOV     ?V0 + 7,R3
   \   000596   85....       MOV     ?V0 + 4,?V0 + 6
   \   000599   85....       MOV     ?V0 + 5,?V0 + 7
    597                   SET_str[0]=str[0];
   \   00059C   740B         MOV     A,#0xb
   \   00059E   12....       LCALL   ?XSTACK_DISP0_8
   \   0005A1   E0           MOVX    A,@DPTR
   \   0005A2   85..82       MOV     DPL,?V0 + 4
   \   0005A5   85..83       MOV     DPH,?V0 + 5
   \   0005A8   F0           MOVX    @DPTR,A
    598                   SET_str[1]=str[1];
   \   0005A9   740C         MOV     A,#0xc
   \   0005AB   12....       LCALL   ?XSTACK_DISP0_8
   \   0005AE   E0           MOVX    A,@DPTR
   \   0005AF   85..82       MOV     DPL,?V0 + 4
   \   0005B2   85..83       MOV     DPH,?V0 + 5
   \   0005B5   A3           INC     DPTR
   \   0005B6   F0           MOVX    @DPTR,A
    599                   SET_str[2]=str[2];
   \   0005B7   740D         MOV     A,#0xd
   \   0005B9   12....       LCALL   ?XSTACK_DISP0_8
   \   0005BC   E0           MOVX    A,@DPTR
   \   0005BD   85..82       MOV     DPL,?V0 + 4
   \   0005C0   85..83       MOV     DPH,?V0 + 5
   \   0005C3   A3           INC     DPTR
   \   0005C4   A3           INC     DPTR
   \   0005C5   F0           MOVX    @DPTR,A
    600                   SET_str[3]=str[3];
   \   0005C6   740E         MOV     A,#0xe
   \   0005C8   12....       LCALL   ?XSTACK_DISP0_8
   \   0005CB   E0           MOVX    A,@DPTR
   \   0005CC   85..82       MOV     DPL,?V0 + 4
   \   0005CF   85..83       MOV     DPH,?V0 + 5
   \   0005D2   A3           INC     DPTR
   \   0005D3   A3           INC     DPTR
   \   0005D4   A3           INC     DPTR
   \   0005D5   F0           MOVX    @DPTR,A
    601                   SET_str[4]='/';
   \   0005D6   85..82       MOV     DPL,?V0 + 4
   \   0005D9   85..83       MOV     DPH,?V0 + 5
   \   0005DC   A3           INC     DPTR
   \   0005DD   A3           INC     DPTR
   \   0005DE   A3           INC     DPTR
   \   0005DF   A3           INC     DPTR
   \   0005E0   742F         MOV     A,#0x2f
   \   0005E2   F0           MOVX    @DPTR,A
    602                   SET_str[5]='C';
   \   0005E3   85..82       MOV     DPL,?V0 + 4
   \   0005E6   85..83       MOV     DPH,?V0 + 5
   \   0005E9   A3           INC     DPTR
   \   0005EA   A3           INC     DPTR
   \   0005EB   A3           INC     DPTR
   \   0005EC   A3           INC     DPTR
   \   0005ED   A3           INC     DPTR
   \   0005EE   7443         MOV     A,#0x43
   \   0005F0   F0           MOVX    @DPTR,A
    603                   SET_str[6]='/';
   \   0005F1   85..82       MOV     DPL,?V0 + 4
   \   0005F4   85..83       MOV     DPH,?V0 + 5
   \   0005F7   A3           INC     DPTR
   \   0005F8   A3           INC     DPTR
   \   0005F9   A3           INC     DPTR
   \   0005FA   A3           INC     DPTR
   \   0005FB   A3           INC     DPTR
   \   0005FC   A3           INC     DPTR
   \   0005FD   742F         MOV     A,#0x2f
   \   0005FF   F0           MOVX    @DPTR,A
    604                   SET_str[7]='U';
   \   000600   85..82       MOV     DPL,?V0 + 4
   \   000603   85..83       MOV     DPH,?V0 + 5
   \   000606   A3           INC     DPTR
   \   000607   A3           INC     DPTR
   \   000608   A3           INC     DPTR
   \   000609   A3           INC     DPTR
   \   00060A   A3           INC     DPTR
   \   00060B   A3           INC     DPTR
   \   00060C   A3           INC     DPTR
   \   00060D   7455         MOV     A,#0x55
   \   00060F   F0           MOVX    @DPTR,A
    605                   SET_str[8]='U';
   \   000610   85..82       MOV     DPL,?V0 + 4
   \   000613   85..83       MOV     DPH,?V0 + 5
   \   000616   A3           INC     DPTR
   \   000617   A3           INC     DPTR
   \   000618   A3           INC     DPTR
   \   000619   A3           INC     DPTR
   \   00061A   A3           INC     DPTR
   \   00061B   A3           INC     DPTR
   \   00061C   A3           INC     DPTR
   \   00061D   A3           INC     DPTR
   \   00061E   7455         MOV     A,#0x55
   \   000620   F0           MOVX    @DPTR,A
    606                   SET_str[9]=0xA0;
   \   000621   85..82       MOV     DPL,?V0 + 4
   \   000624   85..83       MOV     DPH,?V0 + 5
   \   000627   A3           INC     DPTR
   \   000628   A3           INC     DPTR
   \   000629   A3           INC     DPTR
   \   00062A   A3           INC     DPTR
   \   00062B   A3           INC     DPTR
   \   00062C   A3           INC     DPTR
   \   00062D   A3           INC     DPTR
   \   00062E   A3           INC     DPTR
   \   00062F   A3           INC     DPTR
   \   000630   74A0         MOV     A,#-0x60
   \   000632   F0           MOVX    @DPTR,A
    607                   SET_str[10]=0x22;
   \   000633   85..82       MOV     DPL,?V0 + 4
   \   000636   85..83       MOV     DPH,?V0 + 5
   \   000639   A3           INC     DPTR
   \   00063A   A3           INC     DPTR
   \   00063B   A3           INC     DPTR
   \   00063C   A3           INC     DPTR
   \   00063D   A3           INC     DPTR
   \   00063E   A3           INC     DPTR
   \   00063F   A3           INC     DPTR
   \   000640   A3           INC     DPTR
   \   000641   A3           INC     DPTR
   \   000642   A3           INC     DPTR
   \   000643   7422         MOV     A,#0x22
   \   000645   F0           MOVX    @DPTR,A
    608                   SET_str[11]=pollrate_time/256;//get the rssi
   \   000646   90....       MOV     DPTR,#pollrate_time
   \   000649   E0           MOVX    A,@DPTR
   \   00064A   F8           MOV     R0,A
   \   00064B   A3           INC     DPTR
   \   00064C   E0           MOVX    A,@DPTR
   \   00064D   F9           MOV     R1,A
   \   00064E   E4           CLR     A
   \   00064F   E9           MOV     A,R1
   \   000650   F8           MOV     R0,A
   \   000651   C0E0         PUSH    A
   \   000653   E5..         MOV     A,?V0 + 4
   \   000655   240B         ADD     A,#0xb
   \   000657   F582         MOV     DPL,A
   \   000659   E5..         MOV     A,?V0 + 5
   \   00065B   3400         ADDC    A,#0x0
   \   00065D   F583         MOV     DPH,A
   \   00065F   D0E0         POP     A
   \   000661   F0           MOVX    @DPTR,A
    609                   SET_str[12]=pollrate_time%256;//get the rssi
   \   000662   90....       MOV     DPTR,#pollrate_time
   \   000665   E0           MOVX    A,@DPTR
   \   000666   F8           MOV     R0,A
   \   000667   A3           INC     DPTR
   \   000668   E0           MOVX    A,@DPTR
   \   000669   F9           MOV     R1,A
   \   00066A   7A00         MOV     R2,#0x0
   \   00066C   7B01         MOV     R3,#0x1
   \   00066E   12....       LCALL   ?US_DIV_MOD
   \   000671   EA           MOV     A,R2
   \   000672   C0E0         PUSH    A
   \   000674   E5..         MOV     A,?V0 + 4
   \   000676   240C         ADD     A,#0xc
   \   000678   F582         MOV     DPL,A
   \   00067A   E5..         MOV     A,?V0 + 5
   \   00067C   3400         ADDC    A,#0x0
   \   00067E   F583         MOV     DPH,A
   \   000680   D0E0         POP     A
   \   000682   F0           MOVX    @DPTR,A
    610                   
    611                   SampleApp_SPI_SendCommand_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   000683   90....       MOV     DPTR,#SampleApp_SPI_SendCommand_DstAddr + 8
   \   000686   7402         MOV     A,#0x2
   \   000688   F0           MOVX    @DPTR,A
    612                   SampleApp_SPI_SendCommand_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;
   \   000689   90....       MOV     DPTR,#SampleApp_SPI_SendCommand_DstAddr + 9
   \   00068C   7414         MOV     A,#0x14
   \   00068E   F0           MOVX    @DPTR,A
    613                   // SampleApp_SPI_SendCommand_DstAddr.addr.shortAddr = 0X0000;
    614                   SampleApp_SPI_SendCommand_DstAddr.addr.shortAddr = pkt->srcAddr.addr.shortAddr;//发送给来的设备
   \   00068F   8E82         MOV     DPL,R6
   \   000691   8F83         MOV     DPH,R7
   \   000693   A3           INC     DPTR
   \   000694   A3           INC     DPTR
   \   000695   A3           INC     DPTR
   \   000696   A3           INC     DPTR
   \   000697   A3           INC     DPTR
   \   000698   A3           INC     DPTR
   \   000699   E0           MOVX    A,@DPTR
   \   00069A   F8           MOV     R0,A
   \   00069B   A3           INC     DPTR
   \   00069C   E0           MOVX    A,@DPTR
   \   00069D   F9           MOV     R1,A
   \   00069E   90....       MOV     DPTR,#SampleApp_SPI_SendCommand_DstAddr
   \   0006A1   E8           MOV     A,R0
   \   0006A2   F0           MOVX    @DPTR,A
   \   0006A3   A3           INC     DPTR
   \   0006A4   E9           MOV     A,R1
   \   0006A5   F0           MOVX    @DPTR,A
    615                   
    616                   if ( AF_DataRequest( &SampleApp_SPI_SendCommand_DstAddr,
    617                                       (endPointDesc_t *)&SampleApp_epDesc,
    618                                       SAMPLEAPP_COMMAND_CLUSTERID, //终端传过去，协调器处理了
    619                                       13, SET_str,
    620                                       &SampleApp_TransID, 
    621                                       AF_DISCV_ROUTE, 
    622                                       AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   0006A6                ; Setup parameters for call to function AF_DataRequest
   \   0006A6   75..0F       MOV     ?V0 + 6,#0xf
   \   0006A9   78..         MOV     R0,#?V0 + 6
   \   0006AB   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0006AE   75....       MOV     ?V0 + 6,#SampleApp_TransID & 0xff
   \   0006B1   75....       MOV     ?V0 + 7,#(SampleApp_TransID >> 8) & 0xff
   \   0006B4   78..         MOV     R0,#?V0 + 6
   \   0006B6   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0006B9   78..         MOV     R0,#?V0 + 4
   \   0006BB   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0006BE   75..0D       MOV     ?V0 + 6,#0xd
   \   0006C1   75..00       MOV     ?V0 + 7,#0x0
   \   0006C4   78..         MOV     R0,#?V0 + 6
   \   0006C6   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0006C9   75..04       MOV     ?V0 + 6,#0x4
   \   0006CC   75..00       MOV     ?V0 + 7,#0x0
   \   0006CF   78..         MOV     R0,#?V0 + 6
   \   0006D1   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0006D4   7920         MOV     R1,#0x20
   \   0006D6   7C..         MOV     R4,#SampleApp_epDesc & 0xff
   \   0006D8   7D..         MOV     R5,#(SampleApp_epDesc >> 8) & 0xff
   \   0006DA   7A..         MOV     R2,#SampleApp_SPI_SendCommand_DstAddr & 0xff
   \   0006DC   7B..         MOV     R3,#(SampleApp_SPI_SendCommand_DstAddr >> 8) & 0xff
   \   0006DE   12....       LCALL   ??AF_DataRequest?relay
   \   0006E1   7409         MOV     A,#0x9
   \   0006E3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0006E6   E9           MOV     A,R1
   \   0006E7   7009         JNZ     ??SampleApp_ProcessCommandMessage_16
    623                   {
    624                     osal_mem_free(SET_str);
   \   0006E9                ; Setup parameters for call to function osal_mem_free
   \   0006E9   AA..         MOV     R2,?V0 + 4
   \   0006EB   AB..         MOV     R3,?V0 + 5
   \   0006ED   12....       LCALL   ??osal_mem_free?relay
   \   0006F0   8039         SJMP    ??SampleApp_ProcessCommandMessage_5
    625                   }
    626                   else
    627                   {
    628                     osal_mem_free(SET_str);
   \                     ??SampleApp_ProcessCommandMessage_16:
   \   0006F2                ; Setup parameters for call to function osal_mem_free
   \   0006F2   AA..         MOV     R2,?V0 + 4
   \   0006F4   AB..         MOV     R3,?V0 + 5
   \   0006F6   12....       LCALL   ??osal_mem_free?relay
   \   0006F9   8030         SJMP    ??SampleApp_ProcessCommandMessage_5
    629                   }  
    630                 }
    631               
    632            }
    633           else if(pkt->cmd.Data[8]==82)//R:86 刷新设备列表 特殊处理，直接按一定格式上报
   \                     ??SampleApp_ProcessCommandMessage_7:
   \   0006FB   EE           MOV     A,R6
   \   0006FC   2422         ADD     A,#0x22
   \   0006FE   F582         MOV     DPL,A
   \   000700   EF           MOV     A,R7
   \   000701   3400         ADDC    A,#0x0
   \   000703   F583         MOV     DPH,A
   \   000705   E0           MOVX    A,@DPTR
   \   000706   F8           MOV     R0,A
   \   000707   A3           INC     DPTR
   \   000708   E0           MOVX    A,@DPTR
   \   000709   F583         MOV     DPH,A
   \   00070B   8882         MOV     DPL,R0
   \   00070D   A3           INC     DPTR
   \   00070E   A3           INC     DPTR
   \   00070F   A3           INC     DPTR
   \   000710   A3           INC     DPTR
   \   000711   A3           INC     DPTR
   \   000712   A3           INC     DPTR
   \   000713   A3           INC     DPTR
   \   000714   A3           INC     DPTR
   \   000715   E0           MOVX    A,@DPTR
   \   000716   6452         XRL     A,#0x52
   \   000718   7011         JNZ     ??SampleApp_ProcessCommandMessage_5
    634           {
    635          
    636             osal_start_timerEx( SampleApp_TaskID, SAMPLEAPP_SEND_RS_EVT,100);
   \   00071A                ; Setup parameters for call to function osal_start_timerEx
   \   00071A   7C64         MOV     R4,#0x64
   \   00071C   7D00         MOV     R5,#0x0
   \   00071E   7A00         MOV     R2,#0x0
   \   000720   7B40         MOV     R3,#0x40
   \   000722   90....       MOV     DPTR,#SampleApp_TaskID
   \   000725   E0           MOVX    A,@DPTR
   \   000726   F9           MOV     R1,A
   \   000727   12....       LCALL   ??osal_start_timerEx?relay
   \   00072A   E9           MOV     A,R1
    637             
    638           }
    639          }
   \                     ??SampleApp_ProcessCommandMessage_5:
   \   00072B   7429         MOV     A,#0x29
   \   00072D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000730   7F08         MOV     R7,#0x8
   \   000732   02....       LJMP    ?BANKED_LEAVE_XDATA
    640          
    641          
    642          
    643          
    644          /*
    645          void Delay_1u(uint32 microSecs) 
    646          {
    647            while(microSecs--)
    648            {
    649              //32 NOPs == 1 usecs 
    650              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    651              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    652              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    653              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    654              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    655              asm("nop"); asm("nop"); asm("nop"); asm("nop"); asm("nop");
    656              asm("nop"); asm("nop");
    657            }
    658          }
    659          
    660          */
    661          
    662          
    663          void SampleApp_PermitJoin(uint8 permit_time);

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    664          void SampleApp_PermitJoin(uint8 permit_time)
   \                     SampleApp_PermitJoin:
    665          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
    666              zAddrType_t dstAddr;
    667           if( (devState==DEV_END_DEVICE) || (devState==DEV_ROUTER) )
   \   00000C   90....       MOV     DPTR,#devState
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   6406         XRL     A,#0x6
   \   000012   6008         JZ      ??SampleApp_PermitJoin_0
   \   000014   90....       MOV     DPTR,#devState
   \   000017   E0           MOVX    A,@DPTR
   \   000018   6407         XRL     A,#0x7
   \   00001A   7051         JNZ     ??SampleApp_PermitJoin_1
    668                {
    669                  if(permit_time>0)
   \                     ??SampleApp_PermitJoin_0:
   \   00001C   EE           MOV     A,R6
   \   00001D   C3           CLR     C
   \   00001E   9401         SUBB    A,#0x1
   \   000020   400F         JC      ??SampleApp_PermitJoin_2
    670                  HalLedBlink ( HAL_LED_1, 1, 50, 600 );//应许
   \   000022                ; Setup parameters for call to function HalLedBlink
   \   000022   7C58         MOV     R4,#0x58
   \   000024   7D02         MOV     R5,#0x2
   \   000026   7B32         MOV     R3,#0x32
   \   000028   7A01         MOV     R2,#0x1
   \   00002A   7901         MOV     R1,#0x1
   \   00002C   12....       LCALL   ??HalLedBlink?relay
   \   00002F   800D         SJMP    ??SampleApp_PermitJoin_3
    671                  else
    672                   HalLedBlink ( HAL_LED_1, 2, 50, 600 );//应许  
   \                     ??SampleApp_PermitJoin_2:
   \   000031                ; Setup parameters for call to function HalLedBlink
   \   000031   7C58         MOV     R4,#0x58
   \   000033   7D02         MOV     R5,#0x2
   \   000035   7B32         MOV     R3,#0x32
   \   000037   7A02         MOV     R2,#0x2
   \   000039   7901         MOV     R1,#0x1
   \   00003B   12....       LCALL   ??HalLedBlink?relay
    673                  NLME_PermitJoiningRequest(permit_time);
   \                     ??SampleApp_PermitJoin_3:
   \   00003E                ; Setup parameters for call to function NLME_PermitJoiningRequest
   \   00003E   EE           MOV     A,R6
   \   00003F   F9           MOV     R1,A
   \   000040   12....       LCALL   ??NLME_PermitJoiningRequest?relay
   \   000043   E9           MOV     A,R1
    674                  dstAddr.addrMode = AddrBroadcast;
   \   000044   7408         MOV     A,#0x8
   \   000046   12....       LCALL   ?XSTACK_DISP0_8
   \   000049   740F         MOV     A,#0xf
   \   00004B   F0           MOVX    @DPTR,A
    675                  dstAddr.addr.shortAddr = 0XFFFC;   // Coordinator makes the match
   \   00004C   85..82       MOV     DPL,?XSP + 0
   \   00004F   85..83       MOV     DPH,?XSP + 1
   \   000052   74FC         MOV     A,#-0x4
   \   000054   F0           MOVX    @DPTR,A
   \   000055   A3           INC     DPTR
   \   000056   74FF         MOV     A,#-0x1
   \   000058   F0           MOVX    @DPTR,A
    676                  ZDP_MgmtPermitJoinReq( &dstAddr, permit_time, 0, 0);
   \   000059                ; Setup parameters for call to function ZDP_MgmtPermitJoinReq
   \   000059   7D00         MOV     R5,#0x0
   \   00005B   7C00         MOV     R4,#0x0
   \   00005D   EE           MOV     A,R6
   \   00005E   F9           MOV     R1,A
   \   00005F   85..82       MOV     DPL,?XSP + 0
   \   000062   85..83       MOV     DPH,?XSP + 1
   \   000065   AA82         MOV     R2,DPL
   \   000067   AB83         MOV     R3,DPH
   \   000069   12....       LCALL   ??ZDP_MgmtPermitJoinReq?relay
   \   00006C   E9           MOV     A,R1
    677                }
    678          }
   \                     ??SampleApp_PermitJoin_1:
   \   00006D   7409         MOV     A,#0x9
   \   00006F   12....       LCALL   ?DEALLOC_XSTACK8
   \   000072   7F01         MOV     R7,#0x1
   \   000074   02....       LJMP    ?BANKED_LEAVE_XDATA
    679          
    680          
    681          void SampleApp_send_in_binding_req(uint8 endpoint,uint16 *bindingINClusters,uint8 in_len);

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    682          void SampleApp_send_in_binding_req(uint8 endpoint,uint16 *bindingINClusters,uint8 in_len)
   \                     SampleApp_send_in_binding_req:
    683          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
   \   00000C   8A..         MOV     ?V0 + 0,R2
   \   00000E   8B..         MOV     ?V0 + 1,R3
   \   000010   EC           MOV     A,R4
   \   000011   FF           MOV     R7,A
    684            zAddrType_t dstAddr;
    685           if((devState == DEV_END_DEVICE) || (devState == DEV_ROUTER)) 
   \   000012   90....       MOV     DPTR,#devState
   \   000015   E0           MOVX    A,@DPTR
   \   000016   6406         XRL     A,#0x6
   \   000018   6008         JZ      ??SampleApp_send_in_binding_req_0
   \   00001A   90....       MOV     DPTR,#devState
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   6407         XRL     A,#0x7
   \   000020   7075         JNZ     ??SampleApp_send_in_binding_req_1
    686                      {
    687                              HalLedBlink ( HAL_LED_1, 1, 50, 1000 );
   \                     ??SampleApp_send_in_binding_req_0:
   \   000022                ; Setup parameters for call to function HalLedBlink
   \   000022   7CE8         MOV     R4,#-0x18
   \   000024   7D03         MOV     R5,#0x3
   \   000026   7B32         MOV     R3,#0x32
   \   000028   7A01         MOV     R2,#0x1
   \   00002A   7901         MOV     R1,#0x1
   \   00002C   12....       LCALL   ??HalLedBlink?relay
    688                              dstAddr.addrMode = afAddr16Bit;
   \   00002F   7408         MOV     A,#0x8
   \   000031   12....       LCALL   ?XSTACK_DISP0_8
   \   000034   7402         MOV     A,#0x2
   \   000036   F0           MOVX    @DPTR,A
    689                              dstAddr.addr.shortAddr = 0;   
   \   000037   85..82       MOV     DPL,?XSP + 0
   \   00003A   85..83       MOV     DPH,?XSP + 1
   \   00003D   7400         MOV     A,#0x0
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   A3           INC     DPTR
   \   000041   7400         MOV     A,#0x0
   \   000043   F0           MOVX    @DPTR,A
    690                              ZDP_EndDeviceBindReq( &dstAddr,
    691                                                                      NLME_GetShortAddr(),
    692                                                                      endpoint,
    693                                                                      0x0F08,in_len,
    694                                                                      bindingINClusters,   // No incoming clusters to bind   0, NULL
    695                                                                      0, NULL, FALSE );
   \   000044                ; Setup parameters for call to function ZDP_EndDeviceBindReq
   \   000044   75..00       MOV     ?V0 + 2,#0x0
   \   000047   78..         MOV     R0,#?V0 + 2
   \   000049   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00004C   E4           CLR     A
   \   00004D   F5..         MOV     ?V0 + 2,A
   \   00004F   F5..         MOV     ?V0 + 3,A
   \   000051   78..         MOV     R0,#?V0 + 2
   \   000053   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000056   75..00       MOV     ?V0 + 2,#0x0
   \   000059   78..         MOV     R0,#?V0 + 2
   \   00005B   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00005E   78..         MOV     R0,#?V0 + 0
   \   000060   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000063   EF           MOV     A,R7
   \   000064   F5..         MOV     ?V0 + 2,A
   \   000066   78..         MOV     R0,#?V0 + 2
   \   000068   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00006B   75..08       MOV     ?V0 + 2,#0x8
   \   00006E   75..0F       MOV     ?V0 + 3,#0xf
   \   000071   78..         MOV     R0,#?V0 + 2
   \   000073   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000076   EE           MOV     A,R6
   \   000077   F9           MOV     R1,A
   \   000078   E9           MOV     A,R1
   \   000079   FE           MOV     R6,A
   \   00007A   F9           MOV     R1,A
   \   00007B                ; Setup parameters for call to function NLME_GetShortAddr
   \   00007B   12....       LCALL   ??NLME_GetShortAddr?relay
   \   00007E   EA           MOV     A,R2
   \   00007F   FC           MOV     R4,A
   \   000080   EB           MOV     A,R3
   \   000081   FD           MOV     R5,A
   \   000082   EE           MOV     A,R6
   \   000083   F9           MOV     R1,A
   \   000084   FE           MOV     R6,A
   \   000085   7409         MOV     A,#0x9
   \   000087   12....       LCALL   ?XSTACK_DISP0_8
   \   00008A   AA82         MOV     R2,DPL
   \   00008C   AB83         MOV     R3,DPH
   \   00008E   12....       LCALL   ??ZDP_EndDeviceBindReq?relay
   \   000091   7409         MOV     A,#0x9
   \   000093   12....       LCALL   ?DEALLOC_XSTACK8
   \   000096   E9           MOV     A,R1
    696                      }
    697          }
   \                     ??SampleApp_send_in_binding_req_1:
   \   000097   7409         MOV     A,#0x9
   \   000099   12....       LCALL   ?DEALLOC_XSTACK8
   \   00009C   7F04         MOV     R7,#0x4
   \   00009E   02....       LJMP    ?BANKED_LEAVE_XDATA
    698          
    699          
    700          void SampleApp_send_out_binding_req(uint8 endpoint,uint16 *bindingOUTClusters,uint8 out_len);

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    701          void SampleApp_send_out_binding_req(uint8 endpoint,uint16 *bindingOUTClusters,uint8 out_len)
   \                     SampleApp_send_out_binding_req:
    702          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
   \   00000C   8A..         MOV     ?V0 + 0,R2
   \   00000E   8B..         MOV     ?V0 + 1,R3
   \   000010   EC           MOV     A,R4
   \   000011   FF           MOV     R7,A
    703            zAddrType_t dstAddr;
    704           if((devState == DEV_END_DEVICE) || (devState == DEV_ROUTER)) 
   \   000012   90....       MOV     DPTR,#devState
   \   000015   E0           MOVX    A,@DPTR
   \   000016   6406         XRL     A,#0x6
   \   000018   6008         JZ      ??SampleApp_send_out_binding_req_0
   \   00001A   90....       MOV     DPTR,#devState
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   6407         XRL     A,#0x7
   \   000020   7075         JNZ     ??SampleApp_send_out_binding_req_1
    705                      {
    706                              HalLedBlink ( HAL_LED_1, 1, 50, 1000 );
   \                     ??SampleApp_send_out_binding_req_0:
   \   000022                ; Setup parameters for call to function HalLedBlink
   \   000022   7CE8         MOV     R4,#-0x18
   \   000024   7D03         MOV     R5,#0x3
   \   000026   7B32         MOV     R3,#0x32
   \   000028   7A01         MOV     R2,#0x1
   \   00002A   7901         MOV     R1,#0x1
   \   00002C   12....       LCALL   ??HalLedBlink?relay
    707                              dstAddr.addrMode = afAddr16Bit;
   \   00002F   7408         MOV     A,#0x8
   \   000031   12....       LCALL   ?XSTACK_DISP0_8
   \   000034   7402         MOV     A,#0x2
   \   000036   F0           MOVX    @DPTR,A
    708                              dstAddr.addr.shortAddr = 0;   
   \   000037   85..82       MOV     DPL,?XSP + 0
   \   00003A   85..83       MOV     DPH,?XSP + 1
   \   00003D   7400         MOV     A,#0x0
   \   00003F   F0           MOVX    @DPTR,A
   \   000040   A3           INC     DPTR
   \   000041   7400         MOV     A,#0x0
   \   000043   F0           MOVX    @DPTR,A
    709                              ZDP_EndDeviceBindReq( &dstAddr,
    710                                                                      NLME_GetShortAddr(),
    711                                                                      endpoint,
    712                                                                      0x0F08,0,
    713                                                                      NULL,
    714                                                                      out_len, bindingOUTClusters, FALSE );
   \   000044                ; Setup parameters for call to function ZDP_EndDeviceBindReq
   \   000044   75..00       MOV     ?V0 + 2,#0x0
   \   000047   78..         MOV     R0,#?V0 + 2
   \   000049   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00004C   78..         MOV     R0,#?V0 + 0
   \   00004E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000051   EF           MOV     A,R7
   \   000052   F5..         MOV     ?V0 + 2,A
   \   000054   78..         MOV     R0,#?V0 + 2
   \   000056   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000059   E4           CLR     A
   \   00005A   F5..         MOV     ?V0 + 2,A
   \   00005C   F5..         MOV     ?V0 + 3,A
   \   00005E   78..         MOV     R0,#?V0 + 2
   \   000060   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000063   75..00       MOV     ?V0 + 2,#0x0
   \   000066   78..         MOV     R0,#?V0 + 2
   \   000068   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00006B   75..08       MOV     ?V0 + 2,#0x8
   \   00006E   75..0F       MOV     ?V0 + 3,#0xf
   \   000071   78..         MOV     R0,#?V0 + 2
   \   000073   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000076   EE           MOV     A,R6
   \   000077   F9           MOV     R1,A
   \   000078   E9           MOV     A,R1
   \   000079   FE           MOV     R6,A
   \   00007A   F9           MOV     R1,A
   \   00007B                ; Setup parameters for call to function NLME_GetShortAddr
   \   00007B   12....       LCALL   ??NLME_GetShortAddr?relay
   \   00007E   EA           MOV     A,R2
   \   00007F   FC           MOV     R4,A
   \   000080   EB           MOV     A,R3
   \   000081   FD           MOV     R5,A
   \   000082   EE           MOV     A,R6
   \   000083   F9           MOV     R1,A
   \   000084   FE           MOV     R6,A
   \   000085   7409         MOV     A,#0x9
   \   000087   12....       LCALL   ?XSTACK_DISP0_8
   \   00008A   AA82         MOV     R2,DPL
   \   00008C   AB83         MOV     R3,DPH
   \   00008E   12....       LCALL   ??ZDP_EndDeviceBindReq?relay
   \   000091   7409         MOV     A,#0x9
   \   000093   12....       LCALL   ?DEALLOC_XSTACK8
   \   000096   E9           MOV     A,R1
    715                      }
    716          }
   \                     ??SampleApp_send_out_binding_req_1:
   \   000097   7409         MOV     A,#0x9
   \   000099   12....       LCALL   ?DEALLOC_XSTACK8
   \   00009C   7F04         MOV     R7,#0x4
   \   00009E   02....       LJMP    ?BANKED_LEAVE_XDATA
    717          
    718          
    719          
    720          
    721          void USER_SEND_ADD_STR(uint8 *str);

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    722          void USER_SEND_ADD_STR(uint8 *str)
   \                     USER_SEND_ADD_STR:
    723          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    724            for(uint8 i=0;i<4;i++)
   \   000005   7800         MOV     R0,#0x0
   \                     ??USER_SEND_ADD_STR_0:
   \   000007   E8           MOV     A,R0
   \   000008   C3           CLR     C
   \   000009   9404         SUBB    A,#0x4
   \   00000B   5029         JNC     ??USER_SEND_ADD_STR_1
    725            {
    726             str[i] = SHORT_ADRESS[i];
   \   00000D   88..         MOV     ?V0 + 0,R0
   \   00000F   75..00       MOV     ?V0 + 1,#0x0
   \   000012   74..         MOV     A,#SHORT_ADRESS & 0xff
   \   000014   25..         ADD     A,?V0 + 0
   \   000016   F582         MOV     DPL,A
   \   000018   74..         MOV     A,#(SHORT_ADRESS >> 8) & 0xff
   \   00001A   35..         ADDC    A,?V0 + 1
   \   00001C   F583         MOV     DPH,A
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   C0E0         PUSH    A
   \   000021   88..         MOV     ?V0 + 0,R0
   \   000023   75..00       MOV     ?V0 + 1,#0x0
   \   000026   EA           MOV     A,R2
   \   000027   25..         ADD     A,?V0 + 0
   \   000029   F582         MOV     DPL,A
   \   00002B   EB           MOV     A,R3
   \   00002C   35..         ADDC    A,?V0 + 1
   \   00002E   F583         MOV     DPH,A
   \   000030   D0E0         POP     A
   \   000032   F0           MOVX    @DPTR,A
    727            }
   \   000033   08           INC     R0
   \   000034   80D1         SJMP    ??USER_SEND_ADD_STR_0
    728            for(uint8 j=0;j<5;j++)
   \                     ??USER_SEND_ADD_STR_1:
   \   000036   7800         MOV     R0,#0x0
   \                     ??USER_SEND_ADD_STR_2:
   \   000038   E8           MOV     A,R0
   \   000039   C3           CLR     C
   \   00003A   9405         SUBB    A,#0x5
   \   00003C   5019         JNC     ??USER_SEND_ADD_STR_3
    729            {
    730             str[4+j] = '/';
   \   00003E   88..         MOV     ?V0 + 0,R0
   \   000040   75..00       MOV     ?V0 + 1,#0x0
   \   000043   EA           MOV     A,R2
   \   000044   25..         ADD     A,?V0 + 0
   \   000046   F582         MOV     DPL,A
   \   000048   EB           MOV     A,R3
   \   000049   35..         ADDC    A,?V0 + 1
   \   00004B   F583         MOV     DPH,A
   \   00004D   A3           INC     DPTR
   \   00004E   A3           INC     DPTR
   \   00004F   A3           INC     DPTR
   \   000050   A3           INC     DPTR
   \   000051   742F         MOV     A,#0x2f
   \   000053   F0           MOVX    @DPTR,A
    731            }
   \   000054   08           INC     R0
   \   000055   80E1         SJMP    ??USER_SEND_ADD_STR_2
    732          }
   \                     ??USER_SEND_ADD_STR_3:
   \   000057   7F02         MOV     R7,#0x2
   \   000059   02....       LJMP    ?BANKED_LEAVE_XDATA
    733          
    734          
    735          void USER_APP_SEND_IN(uint8 count,uint8 *str);

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    736          void USER_APP_SEND_IN(uint8 count,uint8 *str)
   \                     USER_APP_SEND_IN:
    737          {  
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   8A..         MOV     ?V0 + 2,R2
   \   000009   8B..         MOV     ?V0 + 3,R3
    738          
    739            SampleApp_SPI_SendCommand_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   00000B   90....       MOV     DPTR,#SampleApp_SPI_SendCommand_DstAddr + 8
   \   00000E   7402         MOV     A,#0x2
   \   000010   F0           MOVX    @DPTR,A
    740            SampleApp_SPI_SendCommand_DstAddr.endPoint = SAMPLEAPP_ENDPOINT;
   \   000011   90....       MOV     DPTR,#SampleApp_SPI_SendCommand_DstAddr + 9
   \   000014   7414         MOV     A,#0x14
   \   000016   F0           MOVX    @DPTR,A
    741            SampleApp_SPI_SendCommand_DstAddr.addr.shortAddr = 0X0000;
   \   000017   90....       MOV     DPTR,#SampleApp_SPI_SendCommand_DstAddr
   \   00001A   7400         MOV     A,#0x0
   \   00001C   F0           MOVX    @DPTR,A
   \   00001D   A3           INC     DPTR
   \   00001E   7400         MOV     A,#0x0
   \   000020   F0           MOVX    @DPTR,A
    742              
    743              if ( AF_DataRequest( &SampleApp_SPI_SendCommand_DstAddr,
    744                                   (endPointDesc_t *)&SampleApp_epDesc,
    745                                    SAMPLEAPP_COMMAND_CLUSTERID, //终端传过去，协调器处理了
    746                                    count, str,
    747                                    &SampleApp_TransID, 
    748                                    AF_DISCV_ROUTE, 
    749                                    AF_DEFAULT_RADIUS ) == afStatus_SUCCESS )
   \   000021                ; Setup parameters for call to function AF_DataRequest
   \   000021   75..0F       MOV     ?V0 + 0,#0xf
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000029   75....       MOV     ?V0 + 0,#SampleApp_TransID & 0xff
   \   00002C   75....       MOV     ?V0 + 1,#(SampleApp_TransID >> 8) & 0xff
   \   00002F   78..         MOV     R0,#?V0 + 0
   \   000031   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000034   78..         MOV     R0,#?V0 + 2
   \   000036   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000039   8E..         MOV     ?V0 + 0,R6
   \   00003B   75..00       MOV     ?V0 + 1,#0x0
   \   00003E   78..         MOV     R0,#?V0 + 0
   \   000040   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000043   75..04       MOV     ?V0 + 0,#0x4
   \   000046   75..00       MOV     ?V0 + 1,#0x0
   \   000049   78..         MOV     R0,#?V0 + 0
   \   00004B   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00004E   7920         MOV     R1,#0x20
   \   000050   7C..         MOV     R4,#SampleApp_epDesc & 0xff
   \   000052   7D..         MOV     R5,#(SampleApp_epDesc >> 8) & 0xff
   \   000054   7A..         MOV     R2,#SampleApp_SPI_SendCommand_DstAddr & 0xff
   \   000056   7B..         MOV     R3,#(SampleApp_SPI_SendCommand_DstAddr >> 8) & 0xff
   \   000058   12....       LCALL   ??AF_DataRequest?relay
   \   00005B   7409         MOV     A,#0x9
   \   00005D   12....       LCALL   ?DEALLOC_XSTACK8
   \   000060   E9           MOV     A,R1
    750              {
    751                
    752              }
    753              else
    754              {
    755                
    756              }   
    757          
    758          }
   \   000061   7F04         MOV     R7,#0x4
   \   000063   02....       LJMP    ?BANKED_LEAVE_XDATA
    759          
    760          void HalKeyHoldCheck(void);

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    761          void HalKeyHoldCheck(void)
   \                     HalKeyHoldCheck:
    762          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    763            uint8 keys = 0;
   \   000005   7E00         MOV     R6,#0x0
    764            keys |= HAL_KEY_SW_8;
   \   000007   D3           SETB    C
   \   000008   EE           MOV     A,R6
   \   000009   92E7         MOV     0xE0 /* A   */.7,C
   \   00000B   FE           MOV     R6,A
    765            if(!(READ_NETKEY()))
   \   00000C                ; Setup parameters for call to function READ_NETKEY
   \   00000C   12....       LCALL   ??READ_NETKEY?relay
   \   00000F   E9           MOV     A,R1
   \   000010   702D         JNZ     ??HalKeyHoldCheck_0
    766            {
    767          	key_hold_flag = 1;//长按有效。  key_double_flag 表示按键按下的次数
   \   000012   90....       MOV     DPTR,#key_hold_flag
   \   000015   7401         MOV     A,#0x1
   \   000017   F0           MOVX    @DPTR,A
    768          	if (keys && (pHalKeyProcessFunction))
   \   000018   EE           MOV     A,R6
   \   000019   6024         JZ      ??HalKeyHoldCheck_0
   \   00001B   90....       MOV     DPTR,#pHalKeyProcessFunction
   \   00001E   E0           MOVX    A,@DPTR
   \   00001F   F8           MOV     R0,A
   \   000020   A3           INC     DPTR
   \   000021   E0           MOVX    A,@DPTR
   \   000022   F9           MOV     R1,A
   \   000023   E8           MOV     A,R0
   \   000024   49           ORL     A,R1
   \   000025   6018         JZ      ??HalKeyHoldCheck_0
    769          	{
    770          	  (pHalKeyProcessFunction) (keys, HAL_KEY_STATE_NORMAL);
   \   000027                ; Setup parameters for indirect call
   \   000027   7A00         MOV     R2,#0x0
   \   000029   EE           MOV     A,R6
   \   00002A   F9           MOV     R1,A
   \   00002B   90....       MOV     DPTR,#pHalKeyProcessFunction
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   F8           MOV     R0,A
   \   000030   A3           INC     DPTR
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F583         MOV     DPH,A
   \   000034   8882         MOV     DPL,R0
   \   000036   12....       LCALL   ?CALL_IND
    771          	  // key_ISR_FLAG=0;
    772          	  KEY_NET_ISR_FLAG=0;
   \   000039   90....       MOV     DPTR,#KEY_NET_ISR_FLAG
   \   00003C   7400         MOV     A,#0x0
   \   00003E   F0           MOVX    @DPTR,A
    773          	}
    774            }
    775            key_holdtime_waiting_flag = 0;	//清除等待长按时间标志
   \                     ??HalKeyHoldCheck_0:
   \   00003F   90....       MOV     DPTR,#key_holdtime_waiting_flag
   \   000042   7400         MOV     A,#0x0
   \   000044   F0           MOVX    @DPTR,A
    776            KEY_NET_ISR_FLAG=0;
   \   000045   90....       MOV     DPTR,#KEY_NET_ISR_FLAG
   \   000048   7400         MOV     A,#0x0
   \   00004A   F0           MOVX    @DPTR,A
    777          }
   \   00004B   7F01         MOV     R7,#0x1
   \   00004D   02....       LJMP    ?BANKED_LEAVE_XDATA
    778          
    779          void HalKeyMultiClickCheck(void);

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    780          void HalKeyMultiClickCheck(void)
   \                     HalKeyMultiClickCheck:
    781          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
    782            uint8 keys = 0;
   \   000005   7E00         MOV     R6,#0x0
    783            
    784            keys |= HAL_KEY_SW_8;
   \   000007   D3           SETB    C
   \   000008   EE           MOV     A,R6
   \   000009   92E7         MOV     0xE0 /* A   */.7,C
   \   00000B   FE           MOV     R6,A
    785            key_double_flag=KEY_NET_ISR_FLAG;//将几次按键值赋给状态
   \   00000C   90....       MOV     DPTR,#KEY_NET_ISR_FLAG
   \   00000F   E0           MOVX    A,@DPTR
   \   000010   90....       MOV     DPTR,#key_double_flag
   \   000013   F0           MOVX    @DPTR,A
    786            if(1 == key_double_flag)
   \   000014   90....       MOV     DPTR,#key_double_flag
   \   000017   E0           MOVX    A,@DPTR
   \   000018   6401         XRL     A,#0x1
   \   00001A   7060         JNZ     ??HalKeyMultiClickCheck_0
    787            {
    788          	if((READ_NETKEY()))
   \   00001C                ; Setup parameters for call to function READ_NETKEY
   \   00001C   12....       LCALL   ??READ_NETKEY?relay
   \   00001F   E9           MOV     A,R1
   \   000020   602F         JZ      ??HalKeyMultiClickCheck_1
    789          	{
    790          	  key_hold_flag = 0;
   \   000022   90....       MOV     DPTR,#key_hold_flag
   \   000025   7400         MOV     A,#0x0
   \   000027   F0           MOVX    @DPTR,A
    791          	  if (keys && (pHalKeyProcessFunction))
   \   000028   EE           MOV     A,R6
   \   000029   607E         JZ      ??HalKeyMultiClickCheck_2
   \   00002B   90....       MOV     DPTR,#pHalKeyProcessFunction
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   F8           MOV     R0,A
   \   000030   A3           INC     DPTR
   \   000031   E0           MOVX    A,@DPTR
   \   000032   F9           MOV     R1,A
   \   000033   E8           MOV     A,R0
   \   000034   49           ORL     A,R1
   \   000035   6072         JZ      ??HalKeyMultiClickCheck_2
    792          	  {
    793          		(pHalKeyProcessFunction) (keys, HAL_KEY_STATE_NORMAL);
   \   000037                ; Setup parameters for indirect call
   \   000037   7A00         MOV     R2,#0x0
   \   000039   EE           MOV     A,R6
   \   00003A   F9           MOV     R1,A
   \   00003B   90....       MOV     DPTR,#pHalKeyProcessFunction
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F8           MOV     R0,A
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   F583         MOV     DPH,A
   \   000044   8882         MOV     DPL,R0
   \   000046   12....       LCALL   ?CALL_IND
    794          
    795          		KEY_NET_ISR_FLAG=0;
   \   000049   90....       MOV     DPTR,#KEY_NET_ISR_FLAG
   \   00004C   7400         MOV     A,#0x0
   \   00004E   F0           MOVX    @DPTR,A
   \   00004F   8058         SJMP    ??HalKeyMultiClickCheck_2
    796          	  }
    797          	  
    798          	}
    799          	else
    800          	{
    801          	(pHalKeyProcessFunction) (keys, HAL_KEY_STATE_NORMAL);
   \                     ??HalKeyMultiClickCheck_1:
   \   000051                ; Setup parameters for indirect call
   \   000051   7A00         MOV     R2,#0x0
   \   000053   EE           MOV     A,R6
   \   000054   F9           MOV     R1,A
   \   000055   90....       MOV     DPTR,#pHalKeyProcessFunction
   \   000058   E0           MOVX    A,@DPTR
   \   000059   F8           MOV     R0,A
   \   00005A   A3           INC     DPTR
   \   00005B   E0           MOVX    A,@DPTR
   \   00005C   F583         MOV     DPH,A
   \   00005E   8882         MOV     DPL,R0
   \   000060   12....       LCALL   ?CALL_IND
    802          	 	osal_start_timerEx (Hal_TaskID, HAL_KEY_HOLD_EVENT, HAL_KEY_HOLD_VALUE);//长按时间（10s）达到以后进入相应的处理事件
   \   000063                ; Setup parameters for call to function osal_start_timerEx
   \   000063   7CB8         MOV     R4,#-0x48
   \   000065   7D24         MOV     R5,#0x24
   \   000067   7A40         MOV     R2,#0x40
   \   000069   7B00         MOV     R3,#0x0
   \   00006B   90....       MOV     DPTR,#Hal_TaskID
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   F9           MOV     R1,A
   \   000070   12....       LCALL   ??osal_start_timerEx?relay
   \   000073   E9           MOV     A,R1
    803          		key_holdtime_waiting_flag = 1;
   \   000074   90....       MOV     DPTR,#key_holdtime_waiting_flag
   \   000077   7401         MOV     A,#0x1
   \   000079   F0           MOVX    @DPTR,A
   \   00007A   802D         SJMP    ??HalKeyMultiClickCheck_2
    804          	}
    805            }
    806            else
    807            {
    808          	
    809          	key_hold_flag = 0;//长按无效。  key_double_flag 表示按键按下的次数
   \                     ??HalKeyMultiClickCheck_0:
   \   00007C   90....       MOV     DPTR,#key_hold_flag
   \   00007F   7400         MOV     A,#0x0
   \   000081   F0           MOVX    @DPTR,A
    810          	if (keys && (pHalKeyProcessFunction))
   \   000082   EE           MOV     A,R6
   \   000083   6024         JZ      ??HalKeyMultiClickCheck_2
   \   000085   90....       MOV     DPTR,#pHalKeyProcessFunction
   \   000088   E0           MOVX    A,@DPTR
   \   000089   F8           MOV     R0,A
   \   00008A   A3           INC     DPTR
   \   00008B   E0           MOVX    A,@DPTR
   \   00008C   F9           MOV     R1,A
   \   00008D   E8           MOV     A,R0
   \   00008E   49           ORL     A,R1
   \   00008F   6018         JZ      ??HalKeyMultiClickCheck_2
    811          	{
    812          	  (pHalKeyProcessFunction) (keys, HAL_KEY_STATE_NORMAL);
   \   000091                ; Setup parameters for indirect call
   \   000091   7A00         MOV     R2,#0x0
   \   000093   EE           MOV     A,R6
   \   000094   F9           MOV     R1,A
   \   000095   90....       MOV     DPTR,#pHalKeyProcessFunction
   \   000098   E0           MOVX    A,@DPTR
   \   000099   F8           MOV     R0,A
   \   00009A   A3           INC     DPTR
   \   00009B   E0           MOVX    A,@DPTR
   \   00009C   F583         MOV     DPH,A
   \   00009E   8882         MOV     DPL,R0
   \   0000A0   12....       LCALL   ?CALL_IND
    813          	  // key_ISR_FLAG=0;
    814          	  KEY_NET_ISR_FLAG=0;
   \   0000A3   90....       MOV     DPTR,#KEY_NET_ISR_FLAG
   \   0000A6   7400         MOV     A,#0x0
   \   0000A8   F0           MOVX    @DPTR,A
    815          	}
    816            }
    817            
    818          }
   \                     ??HalKeyMultiClickCheck_2:
   \   0000A9   7F01         MOV     R7,#0x1
   \   0000AB   02....       LJMP    ?BANKED_LEAVE_XDATA
    819          
    820          
    821          
    822          
    823          // ADC definitions for CC2430 from the hal_adc.c file
    824          #define HAL_ADC_REF_125V    0x00    /* Internal 1.25V Reference */
    825          #define HAL_ADC_DEC_064     0x00    /* Decimate by 64 : 8-bit resolution */
    826          #define HAL_ADC_DEC_128     0x10    /* Decimate by 128 : 10-bit resolution */
    827          #define HAL_ADC_DEC_512     0x30    /* Decimate by 512 : 14-bit resolution */
    828          #define HAL_ADC_CHN_VDD3    0x0f    /* Input channel: VDD/3 */
    829          #define HAL_ADC_CHN_TEMP    0x0e    /* Temperature sensor */
    830          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    831          uint16 myApp_ReadBattery( void )
   \                     myApp_ReadBattery:
    832          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
    833          
    834          #if defined (HAL_MCU_CC2430) || defined (HAL_MCU_CC2530)
    835          
    836            uint32 value;
    837            //uint32 value;
    838          
    839            /* Clear ADC interrupt flag */
    840            ADCIF = 0;
   \   000005   C28D         CLR     0x88.5
    841          
    842            ADCCON3 = (HAL_ADC_REF_125V | HAL_ADC_DEC_128 | HAL_ADC_CHN_VDD3);
   \   000007   75B61F       MOV     0xb6,#0x1f
    843          // ADCCON3 = (HAL_ADC_REF_125V | HAL_ADC_DEC_512 | HAL_ADC_CHN_VDD3);
    844            
    845            /* Wait for the conversion to finish */
    846            while ( !ADCIF );
   \                     ??myApp_ReadBattery_0:
   \   00000A   A28D         MOV     C,0x88.5
   \   00000C   50FC         JNC     ??myApp_ReadBattery_0
    847          
    848            /* Get the result */
    849            value = ADCL;
   \   00000E   E5BA         MOV     A,0xba
   \   000010   F8           MOV     R0,A
   \   000011   E4           CLR     A
   \   000012   F9           MOV     R1,A
   \   000013   FA           MOV     R2,A
   \   000014   FB           MOV     R3,A
   \   000015   88..         MOV     ?V0 + 4,R0
   \   000017   89..         MOV     ?V0 + 5,R1
   \   000019   8A..         MOV     ?V0 + 6,R2
   \   00001B   8B..         MOV     ?V0 + 7,R3
    850            value |= ((uint16) ADCH) << 8;
   \   00001D   E5BB         MOV     A,0xbb
   \   00001F   F5..         MOV     ?V0 + 0,A
   \   000021   75..00       MOV     ?V0 + 1,#0x0
   \   000024   E4           CLR     A
   \   000025   C5..         XCH     A,?V0 + 0
   \   000027   F5..         MOV     ?V0 + 1,A
   \   000029   E4           CLR     A
   \   00002A   F5..         MOV     ?V0 + 2,A
   \   00002C   F5..         MOV     ?V0 + 3,A
   \   00002E   78..         MOV     R0,#?V0 + 4
   \   000030   79..         MOV     R1,#?V0 + 0
   \   000032   12....       LCALL   ?L_IOR
    851          
    852            /*
    853             * value now contains measurement of Vdd/3
    854             * 0 indicates 0V and 32767 indicates 1.25V
    855             * voltage = (value*3*1.25)/32767 volts
    856             * we will multiply by this by 10 to allow units of 0.1 volts
    857             */
    858          
    859            
    860            value = value >> 6;   // divide first by 2^6
   \   000035   7406         MOV     A,#0x6
   \   000037   78..         MOV     R0,#?V0 + 4
   \   000039   12....       LCALL   ?UL_SHR
    861            
    862           // value = value >> 2;  
    863            
    864           // xx *1.15*3>10 
    865            //value = (uint16)(value * 34.5);//1.15V*30
    866            
    867            value = (uint32)(value * 345);//1.15V*300
   \   00003C   90....       MOV     DPTR,#__Constant_159
   \   00003F   78..         MOV     R0,#?V0 + 0
   \   000041   12....       LCALL   ?L_MOV_X
   \   000044   78..         MOV     R0,#?V0 + 4
   \   000046   79..         MOV     R1,#?V0 + 0
   \   000048   12....       LCALL   ?L_MUL
    868            
    869          
    870            //value = value >> 13;   
    871            value = value >> 9;   
   \   00004B   7409         MOV     A,#0x9
   \   00004D   78..         MOV     R0,#?V0 + 4
   \   00004F   12....       LCALL   ?UL_SHR
    872            // /512
    873            // ...and later by 2^9...to prevent overflow during multiplication
    874          
    875            return (uint16)value;
   \   000052   AA..         MOV     R2,?V0 + 4
   \   000054   AB..         MOV     R3,?V0 + 5
   \   000056   7F08         MOV     R7,#0x8
   \   000058   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   00005B                REQUIRE _A_TCON
   \   00005B                REQUIRE ADCCON3
   \   00005B                REQUIRE ADCL
   \   00005B                REQUIRE ADCH
    876          
    877          #endif    // CC2430 or CC2530
    878          
    879          #if defined HAL_MCU_MSP430
    880          
    881            uint16 value;
    882          
    883          /*
    884            There are more than MSP430 board now. Idealy, ADC read should be called
    885          */
    886          #if defined (HAL_BOARD_F5438)
    887          
    888            value = HalAdcRead (HAL_ADC_CHANNEL_VDD, HAL_ADC_RESOLUTION_14);
    889            value = value * 50;
    890            value = value / 4096;
    891          
    892          #else
    893          
    894            ADC12CTL0 = ADC12ON+SHT0_2+REFON;             // Turn on and set up ADC12
    895            ADC12CTL1 = SHP;                              // Use sampling timer
    896            ADC12MCTL0 = SREF_1+INCH_11;                  // Vr+=Vref+
    897          
    898            ADC12CTL0 |= ENC | ADC12SC;                   // Start conversion
    899            while ((ADC12IFG & BIT0)==0);
    900          
    901            value = ADC12MEM0;
    902          
    903            /*
    904             * value now contains measurement of AVcc/2
    905             * value is in range 0 to 4095 indicating voltage from 0 to 1.5V
    906             * voltage = (value*2*1.5)/4095 volts
    907             * we will multiply by this by 10 to allow units of 0.1 volts
    908             */
    909          
    910            value = value >> 1;     // value is now in range of 0 to 2048
    911            value = value * 30;
    912            value = value >> 11;
    913          
    914          #endif
    915          
    916            return ( value );
    917          
    918          #endif // MSP430
    919          
    920          
    921          
    922          }

   \                                 In  segment XDATA_ROM_C, align 1
   \                     __Constant_159:
   \   000000   59010000     DD 345

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_MessageMSGCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_MessageMSGCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_ProcessCommandMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_ProcessCommandMessage

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_PermitJoin?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_PermitJoin

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_send_in_binding_req?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_send_in_binding_req

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_send_out_binding_req?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_send_out_binding_req

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_SEND_ADD_STR?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_SEND_ADD_STR

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_APP_SEND_IN?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_APP_SEND_IN

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalKeyHoldCheck?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalKeyHoldCheck

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??HalKeyMultiClickCheck?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    HalKeyMultiClickCheck

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??myApp_ReadBattery?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    myApp_ReadBattery

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     HalKeyHoldCheck                    0      0      9
       -> READ_NETKEY                   0      0     18
     HalKeyMultiClickCheck              0      0      9
       -> READ_NETKEY                   0      0     18
       -> osal_start_timerEx            0      0     18
     SampleApp_Init                     0      0      9
       -> afRegister                    0      0     18
       -> APP_JOIN_INIT                 0      0     18
     SampleApp_MessageMSGCB             0      0     26
       -> SampleApp_ProcessCommandMessage
                                        0      0     20
       -> APP_ENDDEVICE_ACK             0      0     20
     SampleApp_PermitJoin               0      0     18
       -> HalLedBlink                   0      0     36
       -> HalLedBlink                   0      0     36
       -> NLME_PermitJoiningRequest     0      0     36
       -> ZDP_MgmtPermitJoinReq         0      0     36
     SampleApp_ProcessCommandMessage
                                        2      0     76
       -> SampleApp_GetShortAddr        0      0    114
       -> osal_mem_free                 0      0    114
       -> APP_NORMAL_COMMAND            0      0    114
       -> USER_APP_COMMAND              0      0    114
       -> AF_DataRequest                0      0    132
       -> HalLedBlink                   0      0    114
       -> HalLedBlink                   0      0    114
       -> osal_nv_write                 0      0    122
       -> NLME_SetPollRate              0      0    114
       -> osal_mem_alloc                0      0    114
       -> AF_DataRequest                0      0    132
       -> osal_mem_free                 0      0    114
       -> osal_mem_free                 0      0    114
       -> osal_start_timerEx            0      0    114
     SampleApp_ProcessEvent             0      0     16
       -> osal_msg_receive              0      0     32
       -> SampleApp_MessageMSGCB        0      0     32
       -> ZDO_ACK_DEAL_WITH             0      0     32
       -> APP_JOIN_DEAL_WITH            0      0     32
       -> USER_APP_JOIN_MSG             0      0     32
       -> osal_msg_deallocate           0      0     32
       -> osal_msg_receive              0      0     32
       -> USER_MAYBE_BUTTERY_MSG        0      0     32
       -> SampleApp_SendPeriodicMessage
                                        0      0     32
       -> osal_rand                     0      0     32
       -> osal_start_timerEx            0      0     32
       -> SampleApp_SendNwkaddrMessage
                                        0      0     32
       -> osal_start_timerEx            0      0     32
       -> USER_SET_NOMAL_POLL_TIME      0      0     32
       -> APP_OS_DEAL_WITH              0      0     32
       -> USER_SET_RS_MSG               0      0     32
       -> sampleAPP_sendRS_periodMessage
                                        0      0     32
       -> APP_JOIN_START_EVT            0      0     32
       -> Change_Net_Set                0      0     32
     SampleApp_send_in_binding_req      0      0     30
       -> HalLedBlink                   0      0     42
       -> NLME_GetShortAddr             0      0     60
       -> ZDP_EndDeviceBindReq          0      0     60
     SampleApp_send_out_binding_req     0      0     30
       -> HalLedBlink                   0      0     42
       -> NLME_GetShortAddr             0      0     60
       -> ZDP_EndDeviceBindReq          0      0     60
     USER_APP_SEND_IN                   0      0     21
       -> AF_DataRequest                0      0     42
     USER_SEND_ADD_STR                  1      0     10
     myApp_ReadBattery                  0      0     16


   Segment part sizes:

     Function/Label                          Bytes
     --------------                          -----
     _A_TCON                                    1
     ADCCON3                                    1
     ADCL                                       1
     ADCH                                       1
     Command_t                                  1
     Sent_t                                     1
     SampleApp_NwkState                         1
     SampleApp_ClusterList                     26
     SampleApp_SimpleDesc                      12
     SampleApp_Periodic_DstAddr                12
     SampleApp_Flash_DstAddr                   12
     SampleApp_SPI_SendData_DstAddr            12
     SampleApp_SPI_SendCommand_DstAddr
                                               12
     SampleApp_Addr_SendData_DstAddr
                                               12
     SampleApp_annce_req_DstAddr               12
     pollrate_time                              2
     ERROR_COUNT                                1
     SampleApp_Init                            96
     SampleApp_ProcessEvent                   438
     SampleApp_MessageMSGCB                   125
     SampleApp_ProcessCommandMessage
                                             1845
     SampleApp_PermitJoin                     119
     SampleApp_send_in_binding_req            161
     SampleApp_send_out_binding_req           161
     USER_SEND_ADD_STR                         92
     USER_APP_SEND_IN                         102
     HalKeyHoldCheck                           80
     HalKeyMultiClickCheck                    174
     myApp_ReadBattery                         91
     __Constant_159                             4
     ??SampleApp_Init?relay                     6
     ??SampleApp_ProcessEvent?relay             6
     ??SampleApp_MessageMSGCB?relay             6
     ??SampleApp_ProcessCommandMessage?relay    6
     ??SampleApp_PermitJoin?relay               6
     ??SampleApp_send_in_binding_req?relay      6
     ??SampleApp_send_out_binding_req?relay     6
     ??USER_SEND_ADD_STR?relay                  6
     ??USER_APP_SEND_IN?relay                   6
     ??HalKeyHoldCheck?relay                    6
     ??HalKeyMultiClickCheck?relay              6
     ??myApp_ReadBattery?relay                  6

 
 3 484 bytes in segment BANKED_CODE
    72 bytes in segment BANK_RELAYS
     4 bytes in segment SFR_AN
    42 bytes in segment XDATA_ROM_C
    78 bytes in segment XDATA_Z
 
 3 556 bytes of CODE  memory
    38 bytes of CONST memory (+ 4 bytes shared)
     0 bytes of DATA  memory (+ 4 bytes shared)
    78 bytes of XDATA memory

Errors: none
Warnings: none
