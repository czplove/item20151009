###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         12/Dec/2014  00:51:38 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\Source\IRR_enddevice\IRR_STUDY #
#                          _User_app.c                                        #
#    Command line       =  -f "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\z #
#                          stack\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC #
#                          2530DB\f8wEndev.cfg" (-DCPU32MHZ                   #
#                          -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3         #
#                          -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3) -f          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\Tools\CC253 #
#                          0DB\f8wConfig.cfg" (-DZIGBEEPRO -DSECURE=1         #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=60            #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=30           #
#                          -DNWK_MAX_BINDING_ENTRIES=1                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 -DASSERT_RESET         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=8000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=1000)  #
#                          -DREJOIN_POLL_RATE=440 "D:\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\Source #
#                          \IRR_enddevice\IRR_STUDY_User_app.c" -D NV_INIT    #
#                          -D NV_RESTORE -D HOLD_AUTO_START -D MT_TASK -D     #
#                          xMT_APP_FUNC -D MT_SYS_FUNC -D MT_ZDO_FUNC -D      #
#                          xMT_ZDO_MGMT -D ISR_KEYINTERRUPT -D POWER_SAVING   #
#                          -D LONG_POLL_TIMES -D HAVE_TEST_FUN -D             #
#                          RESUME_TIME_TEST -D IRR_ED -D M_V332 -lC           #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\IRR_ED_device\List\" #
#                           -lA "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects #
#                          \zstack\Samples\SampleApp\CC2530DB\IRR_ED_device\L #
#                          ist\" --diag_suppress Pe001,Pa010 -o               #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\IRR_ED_device\Obj\"  #
#                          -e --no_cse --no_unroll --no_inline                #
#                          --no_code_motion --no_tbaa --debug --core=plain    #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I "D:\RE_1_2_0_FORMAL_APP(25 #
#                          1)-14-12-8\Projects\zstack\Samples\SampleApp\CC253 #
#                          0DB\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Proj #
#                          ects\zstack\Samples\SampleApp\CC2530DB\..\Source\" #
#                           -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\ #
#                          zstack\Samples\SampleApp\CC2530DB\..\Source\rssi_t #
#                          est\h\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Pr #
#                          ojects\zstack\Samples\SampleApp\CC2530DB\..\Source #
#                          \IRR_enddevice\" -I "D:\RE_1_2_0_FORMAL_APP(251)-1 #
#                          4-12-8\Projects\zstack\Samples\SampleApp\CC2530DB\ #
#                          ..\..\..\ZMain\TI2530DB\" -I                       #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\hal\include\" -I "D:\RE_1_2_0_FORMAL_APP(251 #
#                          )-14-12-8\Projects\zstack\Samples\SampleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\hal\target\CC2530EB\" #
#                           -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\ #
#                          zstack\Samples\SampleApp\CC2530DB\..\..\..\..\..\C #
#                          omponents\mac\include\" -I                         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\high_level\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\low_level\srf04\" -I                     #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mac\low_level\srf04\single_chip\" -I         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\mt\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8 #
#                          \Projects\zstack\Samples\SampleApp\CC2530DB\..\..\ #
#                          ..\..\..\Components\osal\include\" -I              #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\services\saddr\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\services\sdata\" -I                          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\af\" -I "D:\RE_1_2_0_FORMAL_APP(251)-1 #
#                          4-12-8\Projects\zstack\Samples\SampleApp\CC2530DB\ #
#                          ..\..\..\..\..\Components\stack\nwk\" -I           #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\sapi\" -I "D:\RE_1_2_0_FORMAL_APP(251) #
#                          -14-12-8\Projects\zstack\Samples\SampleApp\CC2530D #
#                          B\..\..\..\..\..\Components\stack\sec\" -I         #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\stack\sys\" -I "D:\RE_1_2_0_FORMAL_APP(251)- #
#                          14-12-8\Projects\zstack\Samples\SampleApp\CC2530DB #
#                          \..\..\..\..\..\Components\stack\zdo\" -I          #
#                          "D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zsta #
#                          ck\Samples\SampleApp\CC2530DB\..\..\..\..\..\Compo #
#                          nents\zmac\" -I "D:\RE_1_2_0_FORMAL_APP(251)-14-12 #
#                          -8\Projects\zstack\Samples\SampleApp\CC2530DB\..\. #
#                          .\..\..\..\Components\zmac\f8w\" -On               #
#                          --require_prototypes                               #
#    List file          =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\CC2530DB\IRR_ED_device\List\IR #
#                          R_STUDY_User_app.lst                               #
#    Object file        =  D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstac #
#                          k\Samples\SampleApp\CC2530DB\IRR_ED_device\Obj\IRR #
#                          _STUDY_User_app.r51                                #
#                                                                             #
#                                                                             #
###############################################################################

D:\RE_1_2_0_FORMAL_APP(251)-14-12-8\Projects\zstack\Samples\SampleApp\Source\IRR_enddevice\IRR_STUDY_User_app.c
      1          /**************************************************************************************************
      2            Filename:       SampleApp.c
      3            Revised:        $Date: 2007-10-27 17:16:54 -0700 (Sat, 27 Oct 2007) $
      4            Revision:       $Revision: 15793 $
      5          
      6            Description:    Sample Application (no Profile).
      7          
      8          
      9            Copyright 2007 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED AS IS?WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41            This application isn't intended to do anything useful, it is
     42            intended to be a simple example of an application's structure.
     43          
     44            This application sends it's messages either as broadcast or
     45            broadcast filtered group messages.  The other (more normal)
     46            message addressing is unicast.  Most of the other sample
     47            applications are written to support the unicast message model.
     48          
     49            Key control:
     50              SW1:  Sends a flash command to all devices in Group 1.
     51              SW2:  Adds/Removes (toggles) this device in and out
     52                    of Group 1.  This will enable and disable the
     53                    reception of the flash command.
     54          *********************************************************************/
     55          
     56          /*********************************************************************
     57           * INCLUDES
     58           */
     59          
     60          
     61          
     62          
     63          #include "OSAL.h"
     64          #include "ZGlobals.h"
     65          #include "AF.h"
     66          #include "aps_groups.h"
     67          #include "ZDApp.h"
     68          #include "device.h"
     69          #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0x80
   \   union <unnamed> volatile __sfr _A_P0
   \                     _A_P0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x89
   \   unsigned char volatile __sfr P0IFG
   \                     P0IFG:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x8a
   \   unsigned char volatile __sfr P1IFG
   \                     P1IFG:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x8d
   \   unsigned char volatile __sfr P1IEN
   \                     P1IEN:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xa8
   \   union <unnamed> volatile __sfr _A_IEN0
   \                     _A_IEN0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xab
   \   unsigned char volatile __sfr P0IEN
   \                     P0IEN:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     70          #include "MT_UART.h"
     71          #include "mac_rx.h"
     72          
     73          /* HAL */
     74          #include "hal_led.h"
     75          #include "hal_key.h"
     76          #include "OSAL_Nv.h"
     77          
     78          #include "AddrMgr.h"
     79          #include "nwk_util.h"
     80          #include "ZDObject.h"
     81          #include "ZDO_LIB.h"
     82          #include "common_device.h"
     83          #include "IO_config.h"
     84          #include "OSAL_PwrMgr.h"
     85          
     86          #if defined(IRR_ED)
     87          #include "IRR.h"
     88          #include "m25p16.h"
     89          
     90          #endif
     91          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     92          uint8 UserApp_TaskID;
   \                     UserApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     93          uint8 RS_LEN=0;
   \                     RS_LEN:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     94          uint8 RS_STR[10];
   \                     RS_STR:
   \   000000                DS 10
   \   00000A                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     95          uint8 SHORT_ADRESS[4];
   \                     SHORT_ADRESS:
   \   000000                DS 4
   \   000004                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     96          uint8 USER_DATA_LEN=0;
   \                     USER_DATA_LEN:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     97          uint8 USER_DATA_TYPE=0;
   \                     USER_DATA_TYPE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     98          uint8 *USER_DATA_STR;
   \                     USER_DATA_STR:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
     99          
    100          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    101          uint8 DEVICE_ID;
   \                     DEVICE_ID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    102          uint8 DEFINED_CONTROL_CHAR;
   \                     DEFINED_CONTROL_CHAR:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    103          uint8 JOIN_ROLE;
   \                     JOIN_ROLE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    104          uint16 NORMAL_POLL_TIME=7000;
   \                     NORMAL_POLL_TIME:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for NORMAL_POLL_TIME>`
   \   000002                REQUIRE __INIT_XDATA_I
    105          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    106          uint8 DEEP_POLL_FLAG;
   \                     DEEP_POLL_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    107          uint8 FRONT_ALARM_FLAG=0;
   \                     FRONT_ALARM_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    108          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    109          uint16 active_battery_voltage=0;
   \                     active_battery_voltage:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    110          uint8 CASH_TIME_FLAG=0;
   \                     CASH_TIME_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    111          uint8 HIGH_BUTTERY_FLAG = 0; //大于2.9V
   \                     HIGH_BUTTERY_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    112          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    113          uint8 LOW_POWER_MODE=0;  // 低于2.5V ，进入放电模式
   \                     LOW_POWER_MODE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    114          uint16 Heart_mesg_count;  
   \                     Heart_mesg_count:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    115          uint8 poll_count=0;    //
   \                     poll_count:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    116          uint8 Hour_count=0;
   \                     Hour_count:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    117          uint8 more_detect_low_power_flag=0;
   \                     more_detect_low_power_flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    118          uint8 BUTTERY_LOW_FLAG=0;
   \                     BUTTERY_LOW_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    119          uint8 BUTTERY_ALARM_BIT=0;
   \                     BUTTERY_ALARM_BIT:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    120          uint8 POLLRATE_TIME_VALUE = 0;
   \                     POLLRATE_TIME_VALUE:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    121          
    122          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    123          uint8   CR2_DATA_NODETECT_FLAG = 0; //设置标记位，发送数据的时候禁止中断
   \                     CR2_DATA_NODETECT_FLAG:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
    124          void CR2_DATA_NODETECT_MSG(void);
    125             
    126          
    127          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    128          uint8 forever_forbiten_flag=0;
   \                     forever_forbiten_flag:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    129          cId_t bindingINClusters[1];
   \                     bindingINClusters:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
    130          
    131          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    132              	uint8 CmdType;  //命令类型： '1' 学习，'2' 使用
   \                     CmdType:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
    133          	uint16 IRCodeIndex;   //
   \                     IRCodeIndex:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_I, align 1, keep-with-next
    134          uint8 longPollRateFlag = 1;
   \                     longPollRateFlag:
   \   000000                DS 1
   \   000001                REQUIRE `?<Initializer for longPollRateFlag>`
   \   000001                REQUIRE __INIT_XDATA_I
    135          
    136          uint8 USER_APP_COMMAND(uint8 *user_app_data,uint8 *str); 
    137          void USER_APP_JOIN_MSG(void);
    138          void SampleApp_ProcessBINDINGMessage(afIncomingMSGPacket_t *pkt);
    139          void SampleAPP_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg );
    140          
    141          void User_APP_Drive_init(void);
    142          void SampleApp_HandleKeys( uint8 shift, uint8 keys );//本用户应用按键函数
    143          void USER_SET_RS_MSG(void);//设置RS数据
    144          
    145          void USER_AFTER_RS_MSG(void);
    146          
    147          void USER_ZDO_JOINING_MSG(void); //ZDO层入网的时候处理函数 就是闪烁灯
    148          uint8 READ_NETKEY(void); //读取入网状态按键的状态传递到应用层
    149          void LED_CHANGE(uint8 Position,uint8 Mode);// 设置LED函数
    150          
    151          void changePollRate(void);
    152          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    153          void UserApp_Init( uint8 task_id )
   \                     UserApp_Init:
    154          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
    155          
    156            UserApp_TaskID = task_id;
   \   000007   EE           MOV     A,R6
   \   000008   90....       MOV     DPTR,#UserApp_TaskID
   \   00000B   F0           MOVX    @DPTR,A
    157            
    158            RegisterForKeys(task_id);
   \   00000C                ; Setup parameters for call to function RegisterForKeys
   \   00000C   EE           MOV     A,R6
   \   00000D   F9           MOV     R1,A
   \   00000E   12....       LCALL   ??RegisterForKeys?relay
   \   000011   E9           MOV     A,R1
    159            
    160            User_APP_Drive_init();
   \   000012                ; Setup parameters for call to function User_APP_Drive_init
   \   000012   12....       LCALL   ??User_APP_Drive_init?relay
    161          
    162          }
   \   000015   7F01         MOV     R7,#0x1
   \   000017   02....       LJMP    ?BANKED_LEAVE_XDATA
    163          
    164          /*********************************************************************
    165           * @fn      SampleApp_ProcessEvent
    166           *
    167           * @brief   Generic Application Task event processor.  This function
    168           *          is called to process all events for the task.  Events
    169           *          include timers, messages and any other user defined events.
    170           *
    171           * @param   task_id  - The OSAL assigned task ID.
    172           * @param   events - events to process.  This is a bit map and can
    173           *                   contain more than one event.
    174           *
    175           * @return  none
    176           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    177          uint16 UserApp_ProcessEvent( uint8 task_id, uint16 events )
   \                     UserApp_ProcessEvent:
    178          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 2,R1
   \   000007   EA           MOV     A,R2
   \   000008   FE           MOV     R6,A
   \   000009   EB           MOV     A,R3
   \   00000A   FF           MOV     R7,A
    179            afIncomingMSGPacket_t *MSGpkt;
    180           
    181            if ( events & SYS_EVENT_MSG )
   \   00000B   EE           MOV     A,R6
   \   00000C   5400         ANL     A,#0x0
   \   00000E   F8           MOV     R0,A
   \   00000F   EF           MOV     A,R7
   \   000010   5480         ANL     A,#0x80
   \   000012   F9           MOV     R1,A
   \   000013   E8           MOV     A,R0
   \   000014   49           ORL     A,R1
   \   000015   606F         JZ      ??UserApp_ProcessEvent_0
    182            {
    183              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( UserApp_TaskID );
   \   000017                ; Setup parameters for call to function osal_msg_receive
   \   000017   90....       MOV     DPTR,#UserApp_TaskID
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   F9           MOV     R1,A
   \   00001C   12....       LCALL   ??osal_msg_receive?relay
   \   00001F   8A..         MOV     ?V0 + 4,R2
   \   000021   8B..         MOV     ?V0 + 5,R3
   \   000023   85....       MOV     ?V0 + 0,?V0 + 4
   \   000026   85....       MOV     ?V0 + 1,?V0 + 5
    184              while ( MSGpkt )                                           
   \                     ??UserApp_ProcessEvent_1:
   \   000029   E5..         MOV     A,?V0 + 0
   \   00002B   45..         ORL     A,?V0 + 1
   \   00002D   604C         JZ      ??UserApp_ProcessEvent_2
    185              {                                                                     
    186                switch ( MSGpkt->hdr.event )
   \   00002F   85..82       MOV     DPL,?V0 + 0
   \   000032   85..83       MOV     DPH,?V0 + 1
   \   000035   E0           MOVX    A,@DPTR
   \   000036   2440         ADD     A,#0x40
   \   000038   600D         JZ      ??UserApp_ProcessEvent_3
   \   00003A   24ED         ADD     A,#-0x13
   \   00003C   7021         JNZ     ??UserApp_ProcessEvent_4
    187                {
    188                  
    189                   
    190                   case ZDO_CB_MSG:
    191                    SampleAPP_ProcessZDOMsgs( (zdoIncomingMsg_t *)MSGpkt );
   \   00003E                ; Setup parameters for call to function SampleAPP_ProcessZDOMsgs
   \   00003E   AA..         MOV     R2,?V0 + 0
   \   000040   AB..         MOV     R3,?V0 + 1
   \   000042   12....       LCALL   ??SampleAPP_ProcessZDOMsgs?relay
    192                    break; 
   \   000045   8018         SJMP    ??UserApp_ProcessEvent_4
    193                    
    194                  case KEY_CHANGE:      
    195                    SampleApp_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
   \                     ??UserApp_ProcessEvent_3:
   \   000047                ; Setup parameters for call to function SampleApp_HandleKeys
   \   000047   85..82       MOV     DPL,?V0 + 0
   \   00004A   85..83       MOV     DPH,?V0 + 1
   \   00004D   A3           INC     DPTR
   \   00004E   A3           INC     DPTR
   \   00004F   A3           INC     DPTR
   \   000050   E0           MOVX    A,@DPTR
   \   000051   FA           MOV     R2,A
   \   000052   85..82       MOV     DPL,?V0 + 0
   \   000055   85..83       MOV     DPH,?V0 + 1
   \   000058   A3           INC     DPTR
   \   000059   A3           INC     DPTR
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   F9           MOV     R1,A
   \   00005C   12....       LCALL   ??SampleApp_HandleKeys?relay
    196                    break;                                             
    197          
    198                  default:
    199                    break;
    200                }
    201          
    202                // Release the memory
    203                //释放消息占用的内存
    204                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??UserApp_ProcessEvent_4:
   \   00005F                ; Setup parameters for call to function osal_msg_deallocate
   \   00005F   AA..         MOV     R2,?V0 + 0
   \   000061   AB..         MOV     R3,?V0 + 1
   \   000063   12....       LCALL   ??osal_msg_deallocate?relay
   \   000066   E9           MOV     A,R1
    205          
    206                // Next - if one is available
    207                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( UserApp_TaskID );
   \   000067                ; Setup parameters for call to function osal_msg_receive
   \   000067   90....       MOV     DPTR,#UserApp_TaskID
   \   00006A   E0           MOVX    A,@DPTR
   \   00006B   F9           MOV     R1,A
   \   00006C   12....       LCALL   ??osal_msg_receive?relay
   \   00006F   8A..         MOV     ?V0 + 4,R2
   \   000071   8B..         MOV     ?V0 + 5,R3
   \   000073   85....       MOV     ?V0 + 0,?V0 + 4
   \   000076   85....       MOV     ?V0 + 1,?V0 + 5
   \   000079   80AE         SJMP    ??UserApp_ProcessEvent_1
    208              }//end： while ( MSGpkt )
    209          
    210              return (events ^ SYS_EVENT_MSG);
   \                     ??UserApp_ProcessEvent_2:
   \   00007B   EE           MOV     A,R6
   \   00007C   6400         XRL     A,#0x0
   \   00007E   FA           MOV     R2,A
   \   00007F   EF           MOV     A,R7
   \   000080   6480         XRL     A,#0x80
   \   000082   FB           MOV     R3,A
   \   000083   02....       LJMP    ??UserApp_ProcessEvent_5 & 0xFFFF
    211            }
    212            
    213            
    214           //用户自行添加事件
    215           //test
    216            if ( events & USER_TEST_EVT )
   \                     ??UserApp_ProcessEvent_0:
   \   000086   EE           MOV     A,R6
   \   000087   A2E0         MOV     C,0xE0 /* A   */.0
   \   000089   5026         JNC     ??UserApp_ProcessEvent_6
    217            {
    218              HAL_TOGGLE_LED1();
   \   00008B   A290         MOV     C,0x90.0
   \   00008D   5004         JNC     ??UserApp_ProcessEvent_7
   \   00008F   C290         CLR     0x90.0
   \   000091   8002         SJMP    ??UserApp_ProcessEvent_8
   \                     ??UserApp_ProcessEvent_7:
   \   000093   D290         SETB    0x90.0
    219                osal_start_timerEx( UserApp_TaskID, USER_TEST_EVT,10000);
   \                     ??UserApp_ProcessEvent_8:
   \   000095                ; Setup parameters for call to function osal_start_timerEx
   \   000095   7C10         MOV     R4,#0x10
   \   000097   7D27         MOV     R5,#0x27
   \   000099   7A01         MOV     R2,#0x1
   \   00009B   7B00         MOV     R3,#0x0
   \   00009D   90....       MOV     DPTR,#UserApp_TaskID
   \   0000A0   E0           MOVX    A,@DPTR
   \   0000A1   F9           MOV     R1,A
   \   0000A2   12....       LCALL   ??osal_start_timerEx?relay
   \   0000A5   E9           MOV     A,R1
    220              
    221               return (events ^ USER_TEST_EVT );
   \   0000A6   EE           MOV     A,R6
   \   0000A7   6401         XRL     A,#0x1
   \   0000A9   FA           MOV     R2,A
   \   0000AA   EF           MOV     A,R7
   \   0000AB   6400         XRL     A,#0x0
   \   0000AD   FB           MOV     R3,A
   \   0000AE   02....       LJMP    ??UserApp_ProcessEvent_5 & 0xFFFF
    222            } 
    223            
    224            if ( events & SAMPLEAPP_SEND_LOWBUTTERY_EVT )
   \                     ??UserApp_ProcessEvent_6:
   \   0000B1   EE           MOV     A,R6
   \   0000B2   5404         ANL     A,#0x4
   \   0000B4   6014         JZ      ??UserApp_ProcessEvent_9
    225            {
    226            
    227              BUTTERY_LOW_FLAG =1;
   \   0000B6   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   0000B9   7401         MOV     A,#0x1
   \   0000BB   F0           MOVX    @DPTR,A
    228              SampleApp_SendInMessage();
   \   0000BC                ; Setup parameters for call to function SampleApp_SendInMessage
   \   0000BC   12....       LCALL   ??SampleApp_SendInMessage?relay
    229              
    230             return ( events ^ SAMPLEAPP_SEND_LOWBUTTERY_EVT);
   \   0000BF   EE           MOV     A,R6
   \   0000C0   6404         XRL     A,#0x4
   \   0000C2   FA           MOV     R2,A
   \   0000C3   EF           MOV     A,R7
   \   0000C4   6400         XRL     A,#0x0
   \   0000C6   FB           MOV     R3,A
   \   0000C7   02....       LJMP    ??UserApp_ProcessEvent_5 & 0xFFFF
    231            }
    232            
    233             if ( events & SAMPLEAPP_SEND_NBJC_EVT )
   \                     ??UserApp_ProcessEvent_9:
   \   0000CA   EE           MOV     A,R6
   \   0000CB   5408         ANL     A,#0x8
   \   0000CD   7003         JNZ     $+5
   \   0000CF   02....       LJMP    ??UserApp_ProcessEvent_10 & 0xFFFF
    234            {
    235                  active_battery_voltage=myApp_ReadBattery();
   \   0000D2                ; Setup parameters for call to function myApp_ReadBattery
   \   0000D2   12....       LCALL   ??myApp_ReadBattery?relay
   \   0000D5   90....       MOV     DPTR,#active_battery_voltage
   \   0000D8   EA           MOV     A,R2
   \   0000D9   F0           MOVX    @DPTR,A
   \   0000DA   A3           INC     DPTR
   \   0000DB   EB           MOV     A,R3
   \   0000DC   F0           MOVX    @DPTR,A
    236                //  BUTTERY_LOW_FLAG =1;
    237               //   SampleApp_SendInMessage();
    238                   if(active_battery_voltage<=245)
   \   0000DD   90....       MOV     DPTR,#active_battery_voltage
   \   0000E0   C3           CLR     C
   \   0000E1   E0           MOVX    A,@DPTR
   \   0000E2   94F6         SUBB    A,#-0xa
   \   0000E4   A3           INC     DPTR
   \   0000E5   E0           MOVX    A,@DPTR
   \   0000E6   9400         SUBB    A,#0x0
   \   0000E8   5055         JNC     ??UserApp_ProcessEvent_11
    239                    {
    240                      P0IEN &=~BV(4);
   \   0000EA   53ABEF       ANL     0xab,#0xef
    241                      P1IEN &=~BV(5);
   \   0000ED   538DDF       ANL     0x8d,#0xdf
    242                      forever_forbiten_flag=1;
   \   0000F0   90....       MOV     DPTR,#forever_forbiten_flag
   \   0000F3   7401         MOV     A,#0x1
   \   0000F5   F0           MOVX    @DPTR,A
    243                      
    244                 
    245                      more_detect_low_power_flag++;
   \   0000F6   90....       MOV     DPTR,#more_detect_low_power_flag
   \   0000F9   E0           MOVX    A,@DPTR
   \   0000FA   2401         ADD     A,#0x1
   \   0000FC   F0           MOVX    @DPTR,A
    246                      if(more_detect_low_power_flag>=3)
   \   0000FD   90....       MOV     DPTR,#more_detect_low_power_flag
   \   000100   E0           MOVX    A,@DPTR
   \   000101   C3           CLR     C
   \   000102   9403         SUBB    A,#0x3
   \   000104   4026         JC      ??UserApp_ProcessEvent_12
    247                      {
    248                      LOW_POWER_MODE=1;
   \   000106   90....       MOV     DPTR,#LOW_POWER_MODE
   \   000109   7401         MOV     A,#0x1
   \   00010B   F0           MOVX    @DPTR,A
    249                      osal_start_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_LOWBUTTERY_EVT,60000 );
   \   00010C                ; Setup parameters for call to function osal_start_timerEx
   \   00010C   7C60         MOV     R4,#0x60
   \   00010E   7DEA         MOV     R5,#-0x16
   \   000110   7A04         MOV     R2,#0x4
   \   000112   7B00         MOV     R3,#0x0
   \   000114   90....       MOV     DPTR,#UserApp_TaskID
   \   000117   E0           MOVX    A,@DPTR
   \   000118   F9           MOV     R1,A
   \   000119   12....       LCALL   ??osal_start_timerEx?relay
   \   00011C   E9           MOV     A,R1
    250                      osal_stop_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_NBJC_EVT);   
   \   00011D                ; Setup parameters for call to function osal_stop_timerEx
   \   00011D   7A08         MOV     R2,#0x8
   \   00011F   7B00         MOV     R3,#0x0
   \   000121   90....       MOV     DPTR,#UserApp_TaskID
   \   000124   E0           MOVX    A,@DPTR
   \   000125   F9           MOV     R1,A
   \   000126   12....       LCALL   ??osal_stop_timerEx?relay
   \   000129   E9           MOV     A,R1
   \   00012A   8024         SJMP    ??UserApp_ProcessEvent_13
    251                      }
    252                      else
    253                      {
    254             
    255          
    256                      osal_start_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_NBJC_EVT,3000 );   
   \                     ??UserApp_ProcessEvent_12:
   \   00012C                ; Setup parameters for call to function osal_start_timerEx
   \   00012C   7CB8         MOV     R4,#-0x48
   \   00012E   7D0B         MOV     R5,#0xb
   \   000130   7A08         MOV     R2,#0x8
   \   000132   7B00         MOV     R3,#0x0
   \   000134   90....       MOV     DPTR,#UserApp_TaskID
   \   000137   E0           MOVX    A,@DPTR
   \   000138   F9           MOV     R1,A
   \   000139   12....       LCALL   ??osal_start_timerEx?relay
   \   00013C   E9           MOV     A,R1
   \   00013D   8011         SJMP    ??UserApp_ProcessEvent_13
    257                      } 
    258                    }
    259                    else
    260                    {
    261                     more_detect_low_power_flag=0;
   \                     ??UserApp_ProcessEvent_11:
   \   00013F   90....       MOV     DPTR,#more_detect_low_power_flag
   \   000142   7400         MOV     A,#0x0
   \   000144   F0           MOVX    @DPTR,A
    262                     forever_forbiten_flag=0;  
   \   000145   90....       MOV     DPTR,#forever_forbiten_flag
   \   000148   7400         MOV     A,#0x0
   \   00014A   F0           MOVX    @DPTR,A
    263                     osal_pwrmgr_device( PWRMGR_BATTERY );
   \   00014B                ; Setup parameters for call to function osal_pwrmgr_device
   \   00014B   7901         MOV     R1,#0x1
   \   00014D   12....       LCALL   ??osal_pwrmgr_device?relay
    264          
    265                    }
    266                   
    267             return ( events ^ SAMPLEAPP_SEND_NBJC_EVT);
   \                     ??UserApp_ProcessEvent_13:
   \   000150   EE           MOV     A,R6
   \   000151   6408         XRL     A,#0x8
   \   000153   FA           MOV     R2,A
   \   000154   EF           MOV     A,R7
   \   000155   6400         XRL     A,#0x0
   \   000157   FB           MOV     R3,A
   \   000158   02....       LJMP    ??UserApp_ProcessEvent_5 & 0xFFFF
    268            }
    269            
    270            
    271            
    272               if ( events & CR2_DATA_DETECT_EVT )
   \                     ??UserApp_ProcessEvent_10:
   \   00015B   EE           MOV     A,R6
   \   00015C   5402         ANL     A,#0x2
   \   00015E   6077         JZ      ??UserApp_ProcessEvent_14
    273            {
    274              
    275              if( (PUSH4_SBIT==0) && (forever_forbiten_flag==0))
   \   000160   A284         MOV     C,0x80.4
   \   000162   4058         JC      ??UserApp_ProcessEvent_15
   \   000164   90....       MOV     DPTR,#forever_forbiten_flag
   \   000167   E0           MOVX    A,@DPTR
   \   000168   7052         JNZ     ??UserApp_ProcessEvent_15
    276              // if(PUSH4_SBIT==0)
    277              { 
    278                if( (CASH_TIME_FLAG==1) ||(HIGH_BUTTERY_FLAG==1)) //消除警告后再过1S再打开，防止莫名的误报,如果电池大于2.9V则直接开启中断
   \   00016A   90....       MOV     DPTR,#CASH_TIME_FLAG
   \   00016D   E0           MOVX    A,@DPTR
   \   00016E   6401         XRL     A,#0x1
   \   000170   6008         JZ      ??UserApp_ProcessEvent_16
   \   000172   90....       MOV     DPTR,#HIGH_BUTTERY_FLAG
   \   000175   E0           MOVX    A,@DPTR
   \   000176   6401         XRL     A,#0x1
   \   000178   7029         JNZ     ??UserApp_ProcessEvent_17
    279                {
    280                  EA=0;
   \                     ??UserApp_ProcessEvent_16:
   \   00017A   C2AF         CLR     0xa8.7
    281                  P0IEN |=BV(4);
   \   00017C   43AB10       ORL     0xab,#0x10
    282                  P1IEN |=BV(5);
   \   00017F   438D20       ORL     0x8d,#0x20
    283                  P0IFG=0;
   \   000182   758900       MOV     0x89,#0x0
    284                  P1IFG=0;
   \   000185   758A00       MOV     0x8a,#0x0
    285                  EA=1;
   \   000188   D2AF         SETB    0xa8.7
    286                  
    287                  if(FRONT_ALARM_FLAG==1)//如果是因为报警导致的禁止中断
   \   00018A   90....       MOV     DPTR,#FRONT_ALARM_FLAG
   \   00018D   E0           MOVX    A,@DPTR
   \   00018E   6401         XRL     A,#0x1
   \   000190   7009         JNZ     ??UserApp_ProcessEvent_18
    288                  {
    289                    FRONT_ALARM_FLAG=0;
   \   000192   90....       MOV     DPTR,#FRONT_ALARM_FLAG
   \   000195   7400         MOV     A,#0x0
   \   000197   F0           MOVX    @DPTR,A
    290                    SampleApp_SendInMessage();//补发消警消息上去
   \   000198                ; Setup parameters for call to function SampleApp_SendInMessage
   \   000198   12....       LCALL   ??SampleApp_SendInMessage?relay
    291                  }
    292                  CASH_TIME_FLAG=0;
   \                     ??UserApp_ProcessEvent_18:
   \   00019B   90....       MOV     DPTR,#CASH_TIME_FLAG
   \   00019E   7400         MOV     A,#0x0
   \   0001A0   F0           MOVX    @DPTR,A
   \   0001A1   802A         SJMP    ??UserApp_ProcessEvent_19
    293                }
    294                else
    295                {
    296                  //刚刚消除警告，且电池有电，则再延迟1S，再打开中断
    297                  CASH_TIME_FLAG=1;
   \                     ??UserApp_ProcessEvent_17:
   \   0001A3   90....       MOV     DPTR,#CASH_TIME_FLAG
   \   0001A6   7401         MOV     A,#0x1
   \   0001A8   F0           MOVX    @DPTR,A
    298                  osal_start_timerEx( UserApp_TaskID, CR2_DATA_DETECT_EVT,1000);
   \   0001A9                ; Setup parameters for call to function osal_start_timerEx
   \   0001A9   7CE8         MOV     R4,#-0x18
   \   0001AB   7D03         MOV     R5,#0x3
   \   0001AD   7A02         MOV     R2,#0x2
   \   0001AF   7B00         MOV     R3,#0x0
   \   0001B1   90....       MOV     DPTR,#UserApp_TaskID
   \   0001B4   E0           MOVX    A,@DPTR
   \   0001B5   F9           MOV     R1,A
   \   0001B6   12....       LCALL   ??osal_start_timerEx?relay
   \   0001B9   E9           MOV     A,R1
   \   0001BA   8011         SJMP    ??UserApp_ProcessEvent_19
    299                }  
    300              }
    301              else
    302              {
    303               osal_start_timerEx( UserApp_TaskID, CR2_DATA_DETECT_EVT,500);
   \                     ??UserApp_ProcessEvent_15:
   \   0001BC                ; Setup parameters for call to function osal_start_timerEx
   \   0001BC   7CF4         MOV     R4,#-0xc
   \   0001BE   7D01         MOV     R5,#0x1
   \   0001C0   7A02         MOV     R2,#0x2
   \   0001C2   7B00         MOV     R3,#0x0
   \   0001C4   90....       MOV     DPTR,#UserApp_TaskID
   \   0001C7   E0           MOVX    A,@DPTR
   \   0001C8   F9           MOV     R1,A
   \   0001C9   12....       LCALL   ??osal_start_timerEx?relay
   \   0001CC   E9           MOV     A,R1
    304              }  
    305                return (events ^ CR2_DATA_DETECT_EVT );
   \                     ??UserApp_ProcessEvent_19:
   \   0001CD   EE           MOV     A,R6
   \   0001CE   6402         XRL     A,#0x2
   \   0001D0   FA           MOV     R2,A
   \   0001D1   EF           MOV     A,R7
   \   0001D2   6400         XRL     A,#0x0
   \   0001D4   FB           MOV     R3,A
   \   0001D5   807F         SJMP    ??UserApp_ProcessEvent_5
    306            }
    307            
    308            if ( events & RE_SET_POLL_EVT )
   \                     ??UserApp_ProcessEvent_14:
   \   0001D7   EE           MOV     A,R6
   \   0001D8   5410         ANL     A,#0x10
   \   0001DA   6042         JZ      ??UserApp_ProcessEvent_20
    309            {
    310              if(poll_count++>=5)
   \   0001DC   90....       MOV     DPTR,#poll_count
   \   0001DF   E0           MOVX    A,@DPTR
   \   0001E0   F8           MOV     R0,A
   \   0001E1   7401         MOV     A,#0x1
   \   0001E3   28           ADD     A,R0
   \   0001E4   90....       MOV     DPTR,#poll_count
   \   0001E7   F0           MOVX    @DPTR,A
   \   0001E8   E8           MOV     A,R0
   \   0001E9   C3           CLR     C
   \   0001EA   9405         SUBB    A,#0x5
   \   0001EC   4015         JC      ??UserApp_ProcessEvent_21
    311              { 
    312                poll_count=0;
   \   0001EE   90....       MOV     DPTR,#poll_count
   \   0001F1   7400         MOV     A,#0x0
   \   0001F3   F0           MOVX    @DPTR,A
    313                NLME_SetPollRate(0); //直接不POLL了，靠心跳的POLL来做
   \   0001F4                ; Setup parameters for call to function NLME_SetPollRate
   \   0001F4   7A00         MOV     R2,#0x0
   \   0001F6   7B00         MOV     R3,#0x0
   \   0001F8   12....       LCALL   ??NLME_SetPollRate?relay
    314                DEEP_POLL_FLAG =1;
   \   0001FB   90....       MOV     DPTR,#DEEP_POLL_FLAG
   \   0001FE   7401         MOV     A,#0x1
   \   000200   F0           MOVX    @DPTR,A
   \   000201   8011         SJMP    ??UserApp_ProcessEvent_22
    315              }  
    316              else
    317              {
    318                osal_start_timerEx( UserApp_TaskID, RE_SET_POLL_EVT,60000);//10分钟
   \                     ??UserApp_ProcessEvent_21:
   \   000203                ; Setup parameters for call to function osal_start_timerEx
   \   000203   7C60         MOV     R4,#0x60
   \   000205   7DEA         MOV     R5,#-0x16
   \   000207   7A10         MOV     R2,#0x10
   \   000209   7B00         MOV     R3,#0x0
   \   00020B   90....       MOV     DPTR,#UserApp_TaskID
   \   00020E   E0           MOVX    A,@DPTR
   \   00020F   F9           MOV     R1,A
   \   000210   12....       LCALL   ??osal_start_timerEx?relay
   \   000213   E9           MOV     A,R1
    319              }  
    320              return ( events ^ RE_SET_POLL_EVT);
   \                     ??UserApp_ProcessEvent_22:
   \   000214   EE           MOV     A,R6
   \   000215   6410         XRL     A,#0x10
   \   000217   FA           MOV     R2,A
   \   000218   EF           MOV     A,R7
   \   000219   6400         XRL     A,#0x0
   \   00021B   FB           MOV     R3,A
   \   00021C   8038         SJMP    ??UserApp_ProcessEvent_5
    321            }
    322            
    323            
    324            
    325              if( events & RESUME_POLL_RATE )
   \                     ??UserApp_ProcessEvent_20:
   \   00021E   EE           MOV     A,R6
   \   00021F   5420         ANL     A,#0x20
   \   000221   602F         JZ      ??UserApp_ProcessEvent_23
    326            {
    327          	  longPollRateFlag = 1;
   \   000223   90....       MOV     DPTR,#longPollRateFlag
   \   000226   7401         MOV     A,#0x1
   \   000228   F0           MOVX    @DPTR,A
    328          	  //setDC6688sleep();
    329          	  NLME_SetPollRate( POLLRATE_TIME_VALUE * 500 );//set the poll rate to quick ,and   
   \   000229                ; Setup parameters for call to function NLME_SetPollRate
   \   000229   90....       MOV     DPTR,#POLLRATE_TIME_VALUE
   \   00022C   E0           MOVX    A,@DPTR
   \   00022D   FA           MOV     R2,A
   \   00022E   7B00         MOV     R3,#0x0
   \   000230   EA           MOV     A,R2
   \   000231   75F0F4       MOV     B,#-0xc
   \   000234   A4           MUL     AB
   \   000235   CA           XCH     A,R2
   \   000236   A8F0         MOV     R0,B
   \   000238   75F001       MOV     B,#0x1
   \   00023B   A4           MUL     AB
   \   00023C   28           ADD     A,R0
   \   00023D   F8           MOV     R0,A
   \   00023E   75F0F4       MOV     B,#-0xc
   \   000241   EB           MOV     A,R3
   \   000242   A4           MUL     AB
   \   000243   28           ADD     A,R0
   \   000244   FB           MOV     R3,A
   \   000245   12....       LCALL   ??NLME_SetPollRate?relay
    330          	  //NLME_SetPollRate( 5000 );//set the poll rate to quick ,and   
    331          	  return ( events ^ RESUME_POLL_RATE);
   \   000248   EE           MOV     A,R6
   \   000249   6420         XRL     A,#0x20
   \   00024B   FA           MOV     R2,A
   \   00024C   EF           MOV     A,R7
   \   00024D   6400         XRL     A,#0x0
   \   00024F   FB           MOV     R3,A
   \   000250   8004         SJMP    ??UserApp_ProcessEvent_5
    332            }
    333          
    334          
    335            return 0;
   \                     ??UserApp_ProcessEvent_23:
   \   000252   7A00         MOV     R2,#0x0
   \   000254   7B00         MOV     R3,#0x0
   \                     ??UserApp_ProcessEvent_5:
   \   000256   7F06         MOV     R7,#0x6
   \   000258   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   00025B                REQUIRE _A_P1
   \   00025B                REQUIRE P0IEN
   \   00025B                REQUIRE P1IEN
   \   00025B                REQUIRE _A_P0
   \   00025B                REQUIRE _A_IEN0
   \   00025B                REQUIRE P0IFG
   \   00025B                REQUIRE P1IFG
    336          }
    337          
    338          // 按键命令传输到USER层，用户自行添加删除

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    339          void SampleApp_HandleKeys( uint8 shift, uint8 keys )
   \                     SampleApp_HandleKeys:
    340          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
   \   000006   FE           MOV     R6,A
   \   000007   EA           MOV     A,R2
   \   000008   FF           MOV     R7,A
    341            uint8 startOptions;
                         ^
Warning[Pe177]: variable "startOptions" was declared but never referenced
    342           // uint8 logicalType;
    343            zAddrType_t dstAddr;
                               ^
Warning[Pe177]: variable "dstAddr" was declared but never referenced
    344            
    345          
    346             if ( keys &  HAL_KEY_SW_8 )
   \   000009   EF           MOV     A,R7
   \   00000A   A2E7         MOV     C,0xE0 /* A   */.7
   \   00000C   505C         JNC     ??SampleApp_HandleKeys_0
    347            {   
    348              
    349                  
    350                if(key_double_flag==1)
   \   00000E   90....       MOV     DPTR,#key_double_flag
   \   000011   E0           MOVX    A,@DPTR
   \   000012   6401         XRL     A,#0x1
   \   000014   6029         JZ      ??SampleApp_HandleKeys_1
    351                {
    352                 //if(DEEP_POLL_FLAG==1)
    353                 //{
    354                  // HalLedBlink ( HAL_LED_1, 1, 50, 600 );
    355                   //NLME_SetPollRate( 15000 ); 
    356                   //DEEP_POLL_FLAG =0; 
    357                   //osal_start_timerEx( UserApp_TaskID, RE_SET_POLL_EVT,60000);//10分钟
    358                 //}
    359                }
    360              
    361                 else if(key_double_flag==4)
   \   000016   90....       MOV     DPTR,#key_double_flag
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   6404         XRL     A,#0x4
   \   00001C   7005         JNZ     ??SampleApp_HandleKeys_2
    362              {
    363                   APPLY_TO_JOIN_OF_KEY();
   \   00001E                ; Setup parameters for call to function APPLY_TO_JOIN_OF_KEY
   \   00001E   12....       LCALL   ??APPLY_TO_JOIN_OF_KEY?relay
   \   000021   801C         SJMP    ??SampleApp_HandleKeys_1
    364              }
    365              
    366             
    367             else if(key_double_flag==6)
   \                     ??SampleApp_HandleKeys_2:
   \   000023   90....       MOV     DPTR,#key_double_flag
   \   000026   E0           MOVX    A,@DPTR
   \   000027   6406         XRL     A,#0x6
   \   000029   7007         JNZ     ??SampleApp_HandleKeys_3
    368              {
    369                  SampleApp_PermitJoin(240);
   \   00002B                ; Setup parameters for call to function SampleApp_PermitJoin
   \   00002B   79F0         MOV     R1,#-0x10
   \   00002D   12....       LCALL   ??SampleApp_PermitJoin?relay
   \   000030   800D         SJMP    ??SampleApp_HandleKeys_1
    370              }
    371          
    372              else if(key_double_flag==8)
   \                     ??SampleApp_HandleKeys_3:
   \   000032   90....       MOV     DPTR,#key_double_flag
   \   000035   E0           MOVX    A,@DPTR
   \   000036   6408         XRL     A,#0x8
   \   000038   7005         JNZ     ??SampleApp_HandleKeys_1
    373              {
    374                  SampleApp_PermitJoin(0);
   \   00003A                ; Setup parameters for call to function SampleApp_PermitJoin
   \   00003A   7900         MOV     R1,#0x0
   \   00003C   12....       LCALL   ??SampleApp_PermitJoin?relay
    375              }
    376              
    377             
    378          
    379               if(key_hold_flag==1) 
   \                     ??SampleApp_HandleKeys_1:
   \   00003F   90....       MOV     DPTR,#key_hold_flag
   \   000042   E0           MOVX    A,@DPTR
   \   000043   6401         XRL     A,#0x1
   \   000045   703B         JNZ     ??SampleApp_HandleKeys_4
    380              {   
    381                HalLedBlink ( HAL_LED_1, 4, 50, 800 );
   \   000047                ; Setup parameters for call to function HalLedBlink
   \   000047   7C20         MOV     R4,#0x20
   \   000049   7D03         MOV     R5,#0x3
   \   00004B   7B32         MOV     R3,#0x32
   \   00004D   7A04         MOV     R2,#0x4
   \   00004F   7901         MOV     R1,#0x1
   \   000051   12....       LCALL   ??HalLedBlink?relay
    382                RESTORE_TO_FACTORY();
   \   000054                ; Setup parameters for call to function RESTORE_TO_FACTORY
   \   000054   12....       LCALL   ??RESTORE_TO_FACTORY?relay
    383               osal_start_timerEx( SampleApp_TaskID,SAMPLEAPP_RESTORE_EVT,7000 );
   \   000057                ; Setup parameters for call to function osal_start_timerEx
   \   000057   7C58         MOV     R4,#0x58
   \   000059   7D1B         MOV     R5,#0x1b
   \   00005B   7A10         MOV     R2,#0x10
   \   00005D   7B00         MOV     R3,#0x0
   \   00005F   90....       MOV     DPTR,#SampleApp_TaskID
   \   000062   E0           MOVX    A,@DPTR
   \   000063   F9           MOV     R1,A
   \   000064   12....       LCALL   ??osal_start_timerEx?relay
   \   000067   E9           MOV     A,R1
   \   000068   8018         SJMP    ??SampleApp_HandleKeys_4
    384               }
    385            
    386            }
    387            
    388             else if ( (keys &  HAL_KEY_SW_9) || (keys &  HAL_KEY_SW_6) )
   \                     ??SampleApp_HandleKeys_0:
   \   00006A   7460         MOV     A,#0x60
   \   00006C   5F           ANL     A,R7
   \   00006D   6013         JZ      ??SampleApp_HandleKeys_4
    389            { 
    390             if( (devState==DEV_END_DEVICE) || (devState==DEV_ROUTER) )
   \   00006F   90....       MOV     DPTR,#devState
   \   000072   E0           MOVX    A,@DPTR
   \   000073   6406         XRL     A,#0x6
   \   000075   6008         JZ      ??SampleApp_HandleKeys_5
   \   000077   90....       MOV     DPTR,#devState
   \   00007A   E0           MOVX    A,@DPTR
   \   00007B   6407         XRL     A,#0x7
   \   00007D   7003         JNZ     ??SampleApp_HandleKeys_4
    391             {
    392              SampleApp_SendInMessage();
   \                     ??SampleApp_HandleKeys_5:
   \   00007F                ; Setup parameters for call to function SampleApp_SendInMessage
   \   00007F   12....       LCALL   ??SampleApp_SendInMessage?relay
    393          
    394             }
    395            }
    396           
    397          }
   \                     ??SampleApp_HandleKeys_4:
   \   000082   7F01         MOV     R7,#0x1
   \   000084   02....       LJMP    ?BANKED_LEAVE_XDATA
    398          
    399          
    400          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    401          void SampleApp_ProcessBINDINGMessage(afIncomingMSGPacket_t *pkt)
   \                     SampleApp_ProcessBINDINGMessage:
    402          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    403          
    404            
    405          }
   \   000000   02....       LJMP    ?BRET
    406          
    407          
    408          // 入网后添加函数

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    409          void USER_APP_JOIN_MSG(void)
   \                     USER_APP_JOIN_MSG:
    410          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    411              HalLedBlink ( HAL_LED_1, 1, 99, 2500 );//用BLINK模拟灯亮两秒后熄灭
   \   000005                ; Setup parameters for call to function HalLedBlink
   \   000005   7CC4         MOV     R4,#-0x3c
   \   000007   7D09         MOV     R5,#0x9
   \   000009   7B63         MOV     R3,#0x63
   \   00000B   7A01         MOV     R2,#0x1
   \   00000D   7901         MOV     R1,#0x1
   \   00000F   12....       LCALL   ??HalLedBlink?relay
    412              //NLME_SetPollRate( 2000 );//set the poll rate to quick ,and   
    413              NLME_SetPollRate( POLLRATE_TIME_VALUE * 500 );//set the poll rate to quick ,and       
   \   000012                ; Setup parameters for call to function NLME_SetPollRate
   \   000012   90....       MOV     DPTR,#POLLRATE_TIME_VALUE
   \   000015   E0           MOVX    A,@DPTR
   \   000016   FA           MOV     R2,A
   \   000017   7B00         MOV     R3,#0x0
   \   000019   EA           MOV     A,R2
   \   00001A   75F0F4       MOV     B,#-0xc
   \   00001D   A4           MUL     AB
   \   00001E   CA           XCH     A,R2
   \   00001F   A8F0         MOV     R0,B
   \   000021   75F001       MOV     B,#0x1
   \   000024   A4           MUL     AB
   \   000025   28           ADD     A,R0
   \   000026   F8           MOV     R0,A
   \   000027   75F0F4       MOV     B,#-0xc
   \   00002A   EB           MOV     A,R3
   \   00002B   A4           MUL     AB
   \   00002C   28           ADD     A,R0
   \   00002D   FB           MOV     R3,A
   \   00002E   12....       LCALL   ??NLME_SetPollRate?relay
    414           
    415              DEEP_POLL_FLAG =0; 
   \   000031   90....       MOV     DPTR,#DEEP_POLL_FLAG
   \   000034   7400         MOV     A,#0x0
   \   000036   F0           MOVX    @DPTR,A
    416              HEART_NEED_ACK_FLAG =0;
   \   000037   90....       MOV     DPTR,#HEART_NEED_ACK_FLAG
   \   00003A   7400         MOV     A,#0x0
   \   00003C   F0           MOVX    @DPTR,A
    417              Heart_mesg_count=0;
   \   00003D   90....       MOV     DPTR,#Heart_mesg_count
   \   000040   7400         MOV     A,#0x0
   \   000042   F0           MOVX    @DPTR,A
   \   000043   A3           INC     DPTR
   \   000044   7400         MOV     A,#0x0
   \   000046   F0           MOVX    @DPTR,A
    418              
    419              
    420            
    421              
    422              uint8 *Sample_Cmd_shorAddr;
    423              Sample_Cmd_shorAddr=SampleApp_GetShortAddr();
   \   000047                ; Setup parameters for call to function SampleApp_GetShortAddr
   \   000047   12....       LCALL   ??SampleApp_GetShortAddr?relay
   \   00004A   8A..         MOV     ?V0 + 0,R2
   \   00004C   8B..         MOV     ?V0 + 1,R3
   \   00004E   AE..         MOV     R6,?V0 + 0
   \   000050   AF..         MOV     R7,?V0 + 1
    424              SHORT_ADRESS[0]=*Sample_Cmd_shorAddr++;
   \   000052   8E82         MOV     DPL,R6
   \   000054   8F83         MOV     DPH,R7
   \   000056   E0           MOVX    A,@DPTR
   \   000057   90....       MOV     DPTR,#SHORT_ADRESS
   \   00005A   F0           MOVX    @DPTR,A
   \   00005B   8E82         MOV     DPL,R6
   \   00005D   8F83         MOV     DPH,R7
   \   00005F   A3           INC     DPTR
   \   000060   AE82         MOV     R6,DPL
   \   000062   AF83         MOV     R7,DPH
    425              SHORT_ADRESS[1]=*Sample_Cmd_shorAddr++;
   \   000064   8E82         MOV     DPL,R6
   \   000066   8F83         MOV     DPH,R7
   \   000068   E0           MOVX    A,@DPTR
   \   000069   90....       MOV     DPTR,#SHORT_ADRESS + 1
   \   00006C   F0           MOVX    @DPTR,A
   \   00006D   8E82         MOV     DPL,R6
   \   00006F   8F83         MOV     DPH,R7
   \   000071   A3           INC     DPTR
   \   000072   AE82         MOV     R6,DPL
   \   000074   AF83         MOV     R7,DPH
    426              SHORT_ADRESS[2]=*Sample_Cmd_shorAddr++;
   \   000076   8E82         MOV     DPL,R6
   \   000078   8F83         MOV     DPH,R7
   \   00007A   E0           MOVX    A,@DPTR
   \   00007B   90....       MOV     DPTR,#SHORT_ADRESS + 2
   \   00007E   F0           MOVX    @DPTR,A
   \   00007F   8E82         MOV     DPL,R6
   \   000081   8F83         MOV     DPH,R7
   \   000083   A3           INC     DPTR
   \   000084   AE82         MOV     R6,DPL
   \   000086   AF83         MOV     R7,DPH
    427              SHORT_ADRESS[3]=*Sample_Cmd_shorAddr;
   \   000088   8E82         MOV     DPL,R6
   \   00008A   8F83         MOV     DPH,R7
   \   00008C   E0           MOVX    A,@DPTR
   \   00008D   90....       MOV     DPTR,#SHORT_ADRESS + 3
   \   000090   F0           MOVX    @DPTR,A
    428              osal_mem_free( shortddr_mem );
   \   000091                ; Setup parameters for call to function osal_mem_free
   \   000091   90....       MOV     DPTR,#shortddr_mem
   \   000094   E0           MOVX    A,@DPTR
   \   000095   FA           MOV     R2,A
   \   000096   A3           INC     DPTR
   \   000097   E0           MOVX    A,@DPTR
   \   000098   FB           MOV     R3,A
   \   000099   12....       LCALL   ??osal_mem_free?relay
    429              
    430          
    431            // USER自行添加入网后的操作代码
    432           
    433          }
   \   00009C   7F02         MOV     R7,#0x2
   \   00009E   02....       LJMP    ?BANKED_LEAVE_XDATA
    434          
    435          
    436          // 收到命令后添加函数
    437          // user_app_data 上位机发过来的有效数据 字母后面开始 13开始
    438          //user_rf_data 需要填入的返回数据数组

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    439          uint8 USER_APP_COMMAND(uint8 *user_app_data,uint8 *str)
   \                     USER_APP_COMMAND:
    440          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
   \   000009   8C..         MOV     ?V0 + 0,R4
   \   00000B   8D..         MOV     ?V0 + 1,R5
    441            uint8 active_len=0;
   \   00000D   75..00       MOV     ?V0 + 2,#0x0
    442            
    443              str[0] = '/';
   \   000010   85..82       MOV     DPL,?V0 + 0
   \   000013   85..83       MOV     DPH,?V0 + 1
   \   000016   742F         MOV     A,#0x2f
   \   000018   F0           MOVX    @DPTR,A
    444          
    445             CmdType = user_app_data[0];//窗帘设备命令类型 学习 使用
   \   000019   8E82         MOV     DPL,R6
   \   00001B   8F83         MOV     DPH,R7
   \   00001D   E0           MOVX    A,@DPTR
   \   00001E   90....       MOV     DPTR,#CmdType
   \   000021   F0           MOVX    @DPTR,A
    446             IRCodeIndex = (user_app_data[1]- '0')*100 +
    447                           (user_app_data[2]- '0')*10 +
    448                           (user_app_data[3]- '0');      //编码序号
   \   000022   8E82         MOV     DPL,R6
   \   000024   8F83         MOV     DPH,R7
   \   000026   A3           INC     DPTR
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F8           MOV     R0,A
   \   000029   7900         MOV     R1,#0x0
   \   00002B   E8           MOV     A,R0
   \   00002C   75F064       MOV     B,#0x64
   \   00002F   A4           MUL     AB
   \   000030   C8           XCH     A,R0
   \   000031   AAF0         MOV     R2,B
   \   000033   75F000       MOV     B,#0x0
   \   000036   A4           MUL     AB
   \   000037   2A           ADD     A,R2
   \   000038   FA           MOV     R2,A
   \   000039   75F064       MOV     B,#0x64
   \   00003C   E9           MOV     A,R1
   \   00003D   A4           MUL     AB
   \   00003E   2A           ADD     A,R2
   \   00003F   F9           MOV     R1,A
   \   000040   8E82         MOV     DPL,R6
   \   000042   8F83         MOV     DPH,R7
   \   000044   A3           INC     DPTR
   \   000045   A3           INC     DPTR
   \   000046   E0           MOVX    A,@DPTR
   \   000047   FA           MOV     R2,A
   \   000048   7B00         MOV     R3,#0x0
   \   00004A   EA           MOV     A,R2
   \   00004B   75F00A       MOV     B,#0xa
   \   00004E   A4           MUL     AB
   \   00004F   CA           XCH     A,R2
   \   000050   ACF0         MOV     R4,B
   \   000052   75F000       MOV     B,#0x0
   \   000055   A4           MUL     AB
   \   000056   2C           ADD     A,R4
   \   000057   FC           MOV     R4,A
   \   000058   75F00A       MOV     B,#0xa
   \   00005B   EB           MOV     A,R3
   \   00005C   A4           MUL     AB
   \   00005D   2C           ADD     A,R4
   \   00005E   FB           MOV     R3,A
   \   00005F   E8           MOV     A,R0
   \   000060   2A           ADD     A,R2
   \   000061   F8           MOV     R0,A
   \   000062   E9           MOV     A,R1
   \   000063   3B           ADDC    A,R3
   \   000064   F9           MOV     R1,A
   \   000065   8E82         MOV     DPL,R6
   \   000067   8F83         MOV     DPH,R7
   \   000069   A3           INC     DPTR
   \   00006A   A3           INC     DPTR
   \   00006B   A3           INC     DPTR
   \   00006C   E0           MOVX    A,@DPTR
   \   00006D   FA           MOV     R2,A
   \   00006E   7B00         MOV     R3,#0x0
   \   000070   E8           MOV     A,R0
   \   000071   2A           ADD     A,R2
   \   000072   F8           MOV     R0,A
   \   000073   E9           MOV     A,R1
   \   000074   3B           ADDC    A,R3
   \   000075   F9           MOV     R1,A
   \   000076   E8           MOV     A,R0
   \   000077   2430         ADD     A,#0x30
   \   000079   F8           MOV     R0,A
   \   00007A   E9           MOV     A,R1
   \   00007B   34EB         ADDC    A,#-0x15
   \   00007D   F9           MOV     R1,A
   \   00007E   90....       MOV     DPTR,#IRCodeIndex
   \   000081   E8           MOV     A,R0
   \   000082   F0           MOVX    @DPTR,A
   \   000083   A3           INC     DPTR
   \   000084   E9           MOV     A,R1
   \   000085   F0           MOVX    @DPTR,A
    449          
    450          
    451             if('1' == CmdType)		//'1' 表示学习
   \   000086   90....       MOV     DPTR,#CmdType
   \   000089   E0           MOVX    A,@DPTR
   \   00008A   6431         XRL     A,#0x31
   \   00008C   7010         JNZ     ??USER_APP_COMMAND_0
    452             {
    453               irCodeRx(IRCodeIndex);
   \   00008E                ; Setup parameters for call to function irCodeRx
   \   00008E   90....       MOV     DPTR,#IRCodeIndex
   \   000091   E0           MOVX    A,@DPTR
   \   000092   FA           MOV     R2,A
   \   000093   A3           INC     DPTR
   \   000094   E0           MOVX    A,@DPTR
   \   000095   FB           MOV     R3,A
   \   000096   12....       LCALL   ??irCodeRx?relay
    454               changePollRate();
   \   000099                ; Setup parameters for call to function changePollRate
   \   000099   12....       LCALL   ??changePollRate?relay
   \   00009C   8016         SJMP    ??USER_APP_COMMAND_1
    455          
    456             }
    457             else if('2' == CmdType)	//'2' 表示使用
   \                     ??USER_APP_COMMAND_0:
   \   00009E   90....       MOV     DPTR,#CmdType
   \   0000A1   E0           MOVX    A,@DPTR
   \   0000A2   6432         XRL     A,#0x32
   \   0000A4   700E         JNZ     ??USER_APP_COMMAND_1
    458             {   
    459               irCodeTx(IRCodeIndex);
   \   0000A6                ; Setup parameters for call to function irCodeTx
   \   0000A6   90....       MOV     DPTR,#IRCodeIndex
   \   0000A9   E0           MOVX    A,@DPTR
   \   0000AA   FA           MOV     R2,A
   \   0000AB   A3           INC     DPTR
   \   0000AC   E0           MOVX    A,@DPTR
   \   0000AD   FB           MOV     R3,A
   \   0000AE   12....       LCALL   ??irCodeTx?relay
    460               changePollRate();
   \   0000B1                ; Setup parameters for call to function changePollRate
   \   0000B1   12....       LCALL   ??changePollRate?relay
    461               //active_len=11;
    462               //return active_len;
    463             }
    464             str[1] = CmdType - '0';//数据回填
   \                     ??USER_APP_COMMAND_1:
   \   0000B4   90....       MOV     DPTR,#CmdType
   \   0000B7   E0           MOVX    A,@DPTR
   \   0000B8   24D0         ADD     A,#-0x30
   \   0000BA   85..82       MOV     DPL,?V0 + 0
   \   0000BD   85..83       MOV     DPH,?V0 + 1
   \   0000C0   A3           INC     DPTR
   \   0000C1   F0           MOVX    @DPTR,A
    465             str[3] = IRCodeIndex;//数据回填
   \   0000C2   90....       MOV     DPTR,#IRCodeIndex
   \   0000C5   E0           MOVX    A,@DPTR
   \   0000C6   F8           MOV     R0,A
   \   0000C7   A3           INC     DPTR
   \   0000C8   E0           MOVX    A,@DPTR
   \   0000C9   F9           MOV     R1,A
   \   0000CA   E8           MOV     A,R0
   \   0000CB   85..82       MOV     DPL,?V0 + 0
   \   0000CE   85..83       MOV     DPH,?V0 + 1
   \   0000D1   A3           INC     DPTR
   \   0000D2   A3           INC     DPTR
   \   0000D3   A3           INC     DPTR
   \   0000D4   F0           MOVX    @DPTR,A
    466             str[2] = IRCodeIndex >> 8;
   \   0000D5   90....       MOV     DPTR,#IRCodeIndex
   \   0000D8   E0           MOVX    A,@DPTR
   \   0000D9   F8           MOV     R0,A
   \   0000DA   A3           INC     DPTR
   \   0000DB   E0           MOVX    A,@DPTR
   \   0000DC   F9           MOV     R1,A
   \   0000DD   E4           CLR     A
   \   0000DE   E9           MOV     A,R1
   \   0000DF   F8           MOV     R0,A
   \   0000E0   85..82       MOV     DPL,?V0 + 0
   \   0000E3   85..83       MOV     DPH,?V0 + 1
   \   0000E6   A3           INC     DPTR
   \   0000E7   A3           INC     DPTR
   \   0000E8   F0           MOVX    @DPTR,A
    467             active_len=13;
   \   0000E9   75..0D       MOV     ?V0 + 2,#0xd
    468             return active_len;
   \   0000EC   A9..         MOV     R1,?V0 + 2
   \   0000EE   7F03         MOV     R7,#0x3
   \   0000F0   02....       LJMP    ?BANKED_LEAVE_XDATA
    469          }
    470          
    471          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    472          void USER_SET_RS_MSG(void)//用户自行设置RS数据
   \                     USER_SET_RS_MSG:
    473          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    474              DEVICE_ID=22;
   \   000004   90....       MOV     DPTR,#DEVICE_ID
   \   000007   7416         MOV     A,#0x16
   \   000009   F0           MOVX    @DPTR,A
    475              DEFINED_CONTROL_CHAR='T';
   \   00000A   90....       MOV     DPTR,#DEFINED_CONTROL_CHAR
   \   00000D   7454         MOV     A,#0x54
   \   00000F   F0           MOVX    @DPTR,A
    476              JOIN_ROLE=Send_Endvice;
   \   000010   90....       MOV     DPTR,#JOIN_ROLE
   \   000013   7401         MOV     A,#0x1
   \   000015   F0           MOVX    @DPTR,A
    477              RS_LEN = 1;
   \   000016   90....       MOV     DPTR,#RS_LEN
   \   000019   7401         MOV     A,#0x1
   \   00001B   F0           MOVX    @DPTR,A
    478              RS_STR[0]=0;// 确实是报警的;
   \   00001C   90....       MOV     DPTR,#RS_STR
   \   00001F   7400         MOV     A,#0x0
   \   000021   F0           MOVX    @DPTR,A
    479              
    480              // 对于电池设备每次RS后面可以跟一个电池有电的标记，如果是有电的话
    481              
    482              active_battery_voltage=myApp_ReadBattery();
   \   000022                ; Setup parameters for call to function myApp_ReadBattery
   \   000022   12....       LCALL   ??myApp_ReadBattery?relay
   \   000025   90....       MOV     DPTR,#active_battery_voltage
   \   000028   EA           MOV     A,R2
   \   000029   F0           MOVX    @DPTR,A
   \   00002A   A3           INC     DPTR
   \   00002B   EB           MOV     A,R3
   \   00002C   F0           MOVX    @DPTR,A
    483              
    484              if(active_battery_voltage>265)
   \   00002D   90....       MOV     DPTR,#active_battery_voltage
   \   000030   C3           CLR     C
   \   000031   E0           MOVX    A,@DPTR
   \   000032   940A         SUBB    A,#0xa
   \   000034   A3           INC     DPTR
   \   000035   E0           MOVX    A,@DPTR
   \   000036   9401         SUBB    A,#0x1
   \   000038   4017         JC      ??USER_SET_RS_MSG_0
    485              {
    486                BUTTERY_ALARM_BIT=0;
   \   00003A   90....       MOV     DPTR,#BUTTERY_ALARM_BIT
   \   00003D   7400         MOV     A,#0x0
   \   00003F   F0           MOVX    @DPTR,A
    487                osal_start_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_LOWBUTTERY_EVT,20000 );
   \   000040                ; Setup parameters for call to function osal_start_timerEx
   \   000040   7C20         MOV     R4,#0x20
   \   000042   7D4E         MOV     R5,#0x4e
   \   000044   7A04         MOV     R2,#0x4
   \   000046   7B00         MOV     R3,#0x0
   \   000048   90....       MOV     DPTR,#UserApp_TaskID
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   F9           MOV     R1,A
   \   00004D   12....       LCALL   ??osal_start_timerEx?relay
   \   000050   E9           MOV     A,R1
    488              }
    489          
    490            
    491          }
   \                     ??USER_SET_RS_MSG_0:
   \   000051   D083         POP     DPH
   \   000053   D082         POP     DPL
   \   000055   02....       LJMP    ?BRET
    492          
    493          
    494          /*
    495           用户自行规划主动上报数据的格式。
    496          */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    497          void SampleApp_SendInMessage(void)
   \                     SampleApp_SendInMessage:
    498          { 
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 0
    499            uint8 *send_str;
    500            uint8 send_count=0;
   \   000005   75..00       MOV     ?V0 + 2,#0x0
    501            send_count = 10+3;
   \   000008   75..0D       MOV     ?V0 + 2,#0xd
    502            send_str = osal_mem_alloc(send_count);
   \   00000B                ; Setup parameters for call to function osal_mem_alloc
   \   00000B   85....       MOV     ?V0 + 0,?V0 + 2
   \   00000E   75..00       MOV     ?V0 + 1,#0x0
   \   000011   AA..         MOV     R2,?V0 + 0
   \   000013   AB..         MOV     R3,?V0 + 1
   \   000015   12....       LCALL   ??osal_mem_alloc?relay
   \   000018   8A..         MOV     ?V0 + 0,R2
   \   00001A   8B..         MOV     ?V0 + 1,R3
   \   00001C   AE..         MOV     R6,?V0 + 0
   \   00001E   AF..         MOV     R7,?V0 + 1
    503            
    504            USER_SEND_ADD_STR(send_str);  //\添加固定帧头
   \   000020                ; Setup parameters for call to function USER_SEND_ADD_STR
   \   000020   EE           MOV     A,R6
   \   000021   FA           MOV     R2,A
   \   000022   EF           MOV     A,R7
   \   000023   FB           MOV     R3,A
   \   000024   12....       LCALL   ??USER_SEND_ADD_STR?relay
    505          
    506             if(BUTTERY_LOW_FLAG==1)
   \   000027   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   6401         XRL     A,#0x1
   \   00002D   7043         JNZ     ??SampleApp_SendInMessage_0
    507             {  
    508              send_str[9]=0xA1; 
   \   00002F   8E82         MOV     DPL,R6
   \   000031   8F83         MOV     DPH,R7
   \   000033   A3           INC     DPTR
   \   000034   A3           INC     DPTR
   \   000035   A3           INC     DPTR
   \   000036   A3           INC     DPTR
   \   000037   A3           INC     DPTR
   \   000038   A3           INC     DPTR
   \   000039   A3           INC     DPTR
   \   00003A   A3           INC     DPTR
   \   00003B   A3           INC     DPTR
   \   00003C   74A1         MOV     A,#-0x5f
   \   00003E   F0           MOVX    @DPTR,A
    509              send_str[10]=1;//1代表 电池告警标记位
   \   00003F   8E82         MOV     DPL,R6
   \   000041   8F83         MOV     DPH,R7
   \   000043   A3           INC     DPTR
   \   000044   A3           INC     DPTR
   \   000045   A3           INC     DPTR
   \   000046   A3           INC     DPTR
   \   000047   A3           INC     DPTR
   \   000048   A3           INC     DPTR
   \   000049   A3           INC     DPTR
   \   00004A   A3           INC     DPTR
   \   00004B   A3           INC     DPTR
   \   00004C   A3           INC     DPTR
   \   00004D   7401         MOV     A,#0x1
   \   00004F   F0           MOVX    @DPTR,A
    510              send_str[11]=BUTTERY_ALARM_BIT;//active_battery_voltage;//1; //代表 电池告警事件
   \   000050   90....       MOV     DPTR,#BUTTERY_ALARM_BIT
   \   000053   E0           MOVX    A,@DPTR
   \   000054   C0E0         PUSH    A
   \   000056   EE           MOV     A,R6
   \   000057   240B         ADD     A,#0xb
   \   000059   F582         MOV     DPL,A
   \   00005B   EF           MOV     A,R7
   \   00005C   3400         ADDC    A,#0x0
   \   00005E   F583         MOV     DPH,A
   \   000060   D0E0         POP     A
   \   000062   F0           MOVX    @DPTR,A
    511              BUTTERY_LOW_FLAG = 0;
   \   000063   90....       MOV     DPTR,#BUTTERY_LOW_FLAG
   \   000066   7400         MOV     A,#0x0
   \   000068   F0           MOVX    @DPTR,A
    512              USER_APP_SEND_IN(12,send_str);//发送出数据
   \   000069                ; Setup parameters for call to function USER_APP_SEND_IN
   \   000069   EE           MOV     A,R6
   \   00006A   FA           MOV     R2,A
   \   00006B   EF           MOV     A,R7
   \   00006C   FB           MOV     R3,A
   \   00006D   790C         MOV     R1,#0xc
   \   00006F   12....       LCALL   ??USER_APP_SEND_IN?relay
    513             }
    514             
    515           
    516            osal_mem_free( send_str );
   \                     ??SampleApp_SendInMessage_0:
   \   000072                ; Setup parameters for call to function osal_mem_free
   \   000072   EE           MOV     A,R6
   \   000073   FA           MOV     R2,A
   \   000074   EF           MOV     A,R7
   \   000075   FB           MOV     R3,A
   \   000076   12....       LCALL   ??osal_mem_free?relay
    517          }
   \   000079   7F03         MOV     R7,#0x3
   \   00007B   02....       LJMP    ?BANKED_LEAVE_XDATA
    518          
    519          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    520          void User_APP_Drive_init(void)
   \                     User_APP_Drive_init:
    521          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    522            HAL_IO_CONFIG_INIT();
   \   000005   43FE01       ORL     0xfe,#0x1
   \   000008   43FE02       ORL     0xfe,#0x2
   \   00000B   D290         SETB    0x90.0
   \   00000D   D291         SETB    0x90.1
    523            
    524            osal_nv_item_init( ZCD_NV_POLLRATE_TIME, 1, &POLLRATE_TIME_VALUE );  
   \   00000F                ; Setup parameters for call to function osal_nv_item_init
   \   00000F   75....       MOV     ?V0 + 0,#POLLRATE_TIME_VALUE & 0xff
   \   000012   75....       MOV     ?V0 + 1,#(POLLRATE_TIME_VALUE >> 8) & 0xff
   \   000015   78..         MOV     R0,#?V0 + 0
   \   000017   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001A   7C01         MOV     R4,#0x1
   \   00001C   7D00         MOV     R5,#0x0
   \   00001E   7A18         MOV     R2,#0x18
   \   000020   7B04         MOV     R3,#0x4
   \   000022   12....       LCALL   ??osal_nv_item_init?relay
   \   000025   7402         MOV     A,#0x2
   \   000027   12....       LCALL   ?DEALLOC_XSTACK8
   \   00002A   E9           MOV     A,R1
    525            osal_nv_read( ZCD_NV_POLLRATE_TIME, 0, 1, &POLLRATE_TIME_VALUE );
   \   00002B                ; Setup parameters for call to function osal_nv_read
   \   00002B   75....       MOV     ?V0 + 0,#POLLRATE_TIME_VALUE & 0xff
   \   00002E   75....       MOV     ?V0 + 1,#(POLLRATE_TIME_VALUE >> 8) & 0xff
   \   000031   78..         MOV     R0,#?V0 + 0
   \   000033   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000036   75..01       MOV     ?V0 + 0,#0x1
   \   000039   75..00       MOV     ?V0 + 1,#0x0
   \   00003C   78..         MOV     R0,#?V0 + 0
   \   00003E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000041   7C00         MOV     R4,#0x0
   \   000043   7D00         MOV     R5,#0x0
   \   000045   7A18         MOV     R2,#0x18
   \   000047   7B04         MOV     R3,#0x4
   \   000049   12....       LCALL   ??osal_nv_read?relay
   \   00004C   7404         MOV     A,#0x4
   \   00004E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000051   E9           MOV     A,R1
    526            
    527            if((POLLRATE_TIME_VALUE == 0xFF)||(POLLRATE_TIME_VALUE == 0))
   \   000052   90....       MOV     DPTR,#POLLRATE_TIME_VALUE
   \   000055   E0           MOVX    A,@DPTR
   \   000056   64FF         XRL     A,#0xff
   \   000058   6006         JZ      ??User_APP_Drive_init_0
   \   00005A   90....       MOV     DPTR,#POLLRATE_TIME_VALUE
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   7006         JNZ     ??User_APP_Drive_init_1
    528              POLLRATE_TIME_VALUE = 4;//4*500 ms   
   \                     ??User_APP_Drive_init_0:
   \   000060   90....       MOV     DPTR,#POLLRATE_TIME_VALUE
   \   000063   7404         MOV     A,#0x4
   \   000065   F0           MOVX    @DPTR,A
    529            
    530          #if defined (M_V332)  
    531          #else
    532            PERCFG |= 0x20;  
    533          #endif  
    534            irrInit();
   \                     ??User_APP_Drive_init_1:
   \   000066                ; Setup parameters for call to function irrInit
   \   000066   12....       LCALL   ??irrInit?relay
    535          }
   \   000069   7F02         MOV     R7,#0x2
   \   00006B   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   00006E                REQUIRE P1DIR
   \   00006E                REQUIRE _A_P1
    536          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    537          uint8 READ_NETKEY() //读取入网状态按键的状态传递到应用层
   \                     READ_NETKEY:
    538          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    539          
    540            return HAL_PUSH_BUTTON3();
   \   000000   A292         MOV     C,0x90.2
   \   000002   E4           CLR     A
   \   000003   33           RLC     A
   \   000004   F9           MOV     R1,A
   \   000005   02....       LJMP    ?BRET
   \   000008                REQUIRE _A_P1
    541          }
    542          
    543          
    544          
    545          /*
    546          mode 0 关
    547          1 开
    548          2 切换
    549          */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    550          void LED_CHANGE(uint8 Position,uint8 Mode)// 设置LED函数
   \                     LED_CHANGE:
    551          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    552           switch (Position )
   \   000000   E9           MOV     A,R1
   \   000001   14           DEC     A
   \   000002   6018         JZ      ??LED_CHANGE_0
   \   000004   14           DEC     A
   \   000005   603F         JZ      ??LED_CHANGE_1
   \   000007   24FE         ADD     A,#-0x2
   \   000009   6064         JZ      ??LED_CHANGE_2
   \   00000B   24FC         ADD     A,#-0x4
   \   00000D   7003         JNZ     $+5
   \   00000F   02....       LJMP    ??LED_CHANGE_3 & 0xFFFF
   \   000012   24F8         ADD     A,#-0x8
   \   000014   7003         JNZ     $+5
   \   000016   02....       LJMP    ??LED_CHANGE_4 & 0xFFFF
   \   000019   02....       LJMP    ??LED_CHANGE_5 & 0xFFFF
    553              {
    554                case HAL_LED_1:      
    555                  {
    556                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_0:
   \   00001C   EA           MOV     A,R2
   \   00001D   6005         JZ      ??LED_CHANGE_6
   \   00001F   7401         MOV     A,#0x1
   \   000021   6A           XRL     A,R2
   \   000022   7010         JNZ     ??LED_CHANGE_7
    557                   {
    558                    LED1_SBIT = LED1_POLARITY(Mode);
   \                     ??LED_CHANGE_6:
   \   000024   EA           MOV     A,R2
   \   000025   7004         JNZ     ??LED_CHANGE_8
   \   000027   7801         MOV     R0,#0x1
   \   000029   8002         SJMP    ??LED_CHANGE_9
   \                     ??LED_CHANGE_8:
   \   00002B   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_9:
   \   00002D   E8           MOV     A,R0
   \   00002E   A2E0         MOV     C,0xE0 /* A   */.0
   \   000030   9290         MOV     0x90.0,C
   \   000032   800F         SJMP    ??LED_CHANGE_10
    559                   }
    560                   else if(Mode==2)
   \                     ??LED_CHANGE_7:
   \   000034   7402         MOV     A,#0x2
   \   000036   6A           XRL     A,R2
   \   000037   700A         JNZ     ??LED_CHANGE_10
    561                   {
    562                    if (LED1_SBIT) 
   \   000039   A290         MOV     C,0x90.0
   \   00003B   5004         JNC     ??LED_CHANGE_11
    563                    { 
    564                      LED1_SBIT = 0; 
   \   00003D   C290         CLR     0x90.0
   \   00003F   8002         SJMP    ??LED_CHANGE_10
    565                    } 
    566                    else 
    567                    { 
    568                      LED1_SBIT = 1;
   \                     ??LED_CHANGE_11:
   \   000041   D290         SETB    0x90.0
    569                    } 
    570                   }
    571                  }   
    572                  break;     
   \                     ??LED_CHANGE_10:
   \   000043   02....       LJMP    ??LED_CHANGE_5 & 0xFFFF
    573                  
    574                  case HAL_LED_2:      
    575                  {
    576                   if(Mode==0||Mode==1)
   \                     ??LED_CHANGE_1:
   \   000046   EA           MOV     A,R2
   \   000047   6005         JZ      ??LED_CHANGE_12
   \   000049   7401         MOV     A,#0x1
   \   00004B   6A           XRL     A,R2
   \   00004C   7010         JNZ     ??LED_CHANGE_13
    577                   {
    578                    LED2_SBIT = LED2_POLARITY(Mode);
   \                     ??LED_CHANGE_12:
   \   00004E   EA           MOV     A,R2
   \   00004F   7004         JNZ     ??LED_CHANGE_14
   \   000051   7801         MOV     R0,#0x1
   \   000053   8002         SJMP    ??LED_CHANGE_15
   \                     ??LED_CHANGE_14:
   \   000055   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_15:
   \   000057   E8           MOV     A,R0
   \   000058   A2E0         MOV     C,0xE0 /* A   */.0
   \   00005A   9291         MOV     0x90.1,C
   \   00005C   800F         SJMP    ??LED_CHANGE_16
    579                   }
    580                   else if(Mode==2)
   \                     ??LED_CHANGE_13:
   \   00005E   7402         MOV     A,#0x2
   \   000060   6A           XRL     A,R2
   \   000061   700A         JNZ     ??LED_CHANGE_16
    581                   {
    582                    if (LED1_SBIT) 
   \   000063   A290         MOV     C,0x90.0
   \   000065   5004         JNC     ??LED_CHANGE_17
    583                    { 
    584                      LED2_SBIT = 0; 
   \   000067   C291         CLR     0x90.1
   \   000069   807D         SJMP    ??LED_CHANGE_5
    585                    } 
    586                    else 
    587                    { 
    588                      LED2_SBIT = 1;
   \                     ??LED_CHANGE_17:
   \   00006B   D291         SETB    0x90.1
    589                    } 
    590                   }
    591                  }   
    592                  break;     
   \                     ??LED_CHANGE_16:
   \   00006D   8079         SJMP    ??LED_CHANGE_5
    593                  
    594                  case HAL_LED_3:      
    595                  {
    596                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_2:
   \   00006F   EA           MOV     A,R2
   \   000070   6005         JZ      ??LED_CHANGE_18
   \   000072   7401         MOV     A,#0x1
   \   000074   6A           XRL     A,R2
   \   000075   7010         JNZ     ??LED_CHANGE_19
    597                   {
    598                    LED3_SBIT = LED3_POLARITY(Mode);
   \                     ??LED_CHANGE_18:
   \   000077   EA           MOV     A,R2
   \   000078   6004         JZ      ??LED_CHANGE_20
   \   00007A   7801         MOV     R0,#0x1
   \   00007C   8002         SJMP    ??LED_CHANGE_21
   \                     ??LED_CHANGE_20:
   \   00007E   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_21:
   \   000080   E8           MOV     A,R0
   \   000081   A2E0         MOV     C,0xE0 /* A   */.0
   \   000083   9297         MOV     0x90.7,C
   \   000085   8061         SJMP    ??LED_CHANGE_5
    599                   }
    600                   else if(Mode==2)
   \                     ??LED_CHANGE_19:
   \   000087   7402         MOV     A,#0x2
   \   000089   6A           XRL     A,R2
   \   00008A   705C         JNZ     ??LED_CHANGE_5
    601                   {
    602                    if (LED3_SBIT) 
   \   00008C   A297         MOV     C,0x90.7
   \   00008E   5004         JNC     ??LED_CHANGE_22
    603                    { 
    604                      LED3_SBIT = 0; 
   \   000090   C297         CLR     0x90.7
   \   000092   8054         SJMP    ??LED_CHANGE_5
    605                    } 
    606                    else 
    607                    { 
    608                      LED3_SBIT = 1;
   \                     ??LED_CHANGE_22:
   \   000094   D297         SETB    0x90.7
    609                    } 
    610                   }
    611                  }   
    612                  break;  
   \   000096   8050         SJMP    ??LED_CHANGE_5
    613                  
    614                    case HAL_LED_4:      
    615                  {
    616                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_3:
   \   000098   EA           MOV     A,R2
   \   000099   6005         JZ      ??LED_CHANGE_23
   \   00009B   7401         MOV     A,#0x1
   \   00009D   6A           XRL     A,R2
   \   00009E   7010         JNZ     ??LED_CHANGE_24
    617                   {
    618                    LED4_SBIT = LED4_POLARITY(Mode);
   \                     ??LED_CHANGE_23:
   \   0000A0   EA           MOV     A,R2
   \   0000A1   6004         JZ      ??LED_CHANGE_25
   \   0000A3   7801         MOV     R0,#0x1
   \   0000A5   8002         SJMP    ??LED_CHANGE_26
   \                     ??LED_CHANGE_25:
   \   0000A7   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_26:
   \   0000A9   E8           MOV     A,R0
   \   0000AA   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000AC   9297         MOV     0x90.7,C
   \   0000AE   8038         SJMP    ??LED_CHANGE_5
    619                   }
    620                   else if(Mode==2)
   \                     ??LED_CHANGE_24:
   \   0000B0   7402         MOV     A,#0x2
   \   0000B2   6A           XRL     A,R2
   \   0000B3   7033         JNZ     ??LED_CHANGE_5
    621                   {
    622                    if (LED4_SBIT) 
   \   0000B5   A297         MOV     C,0x90.7
   \   0000B7   5004         JNC     ??LED_CHANGE_27
    623                    { 
    624                      LED4_SBIT = 0; 
   \   0000B9   C297         CLR     0x90.7
   \   0000BB   802B         SJMP    ??LED_CHANGE_5
    625                    } 
    626                    else 
    627                    { 
    628                      LED4_SBIT = 1;
   \                     ??LED_CHANGE_27:
   \   0000BD   D297         SETB    0x90.7
    629                    } 
    630                   }
    631                  }   
    632                  break;
   \   0000BF   8027         SJMP    ??LED_CHANGE_5
    633                  
    634                    case HAL_LED_5:      
    635                  {
    636                   if(Mode==0 || Mode==1)
   \                     ??LED_CHANGE_4:
   \   0000C1   EA           MOV     A,R2
   \   0000C2   6005         JZ      ??LED_CHANGE_28
   \   0000C4   7401         MOV     A,#0x1
   \   0000C6   6A           XRL     A,R2
   \   0000C7   7010         JNZ     ??LED_CHANGE_29
    637                   {
    638                    LED5_SBIT = LED5_POLARITY(Mode);
   \                     ??LED_CHANGE_28:
   \   0000C9   EA           MOV     A,R2
   \   0000CA   6004         JZ      ??LED_CHANGE_30
   \   0000CC   7801         MOV     R0,#0x1
   \   0000CE   8002         SJMP    ??LED_CHANGE_31
   \                     ??LED_CHANGE_30:
   \   0000D0   7800         MOV     R0,#0x0
   \                     ??LED_CHANGE_31:
   \   0000D2   E8           MOV     A,R0
   \   0000D3   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000D5   9297         MOV     0x90.7,C
   \   0000D7   800F         SJMP    ??LED_CHANGE_5
    639                   }
    640                   else if(Mode==2)
   \                     ??LED_CHANGE_29:
   \   0000D9   7402         MOV     A,#0x2
   \   0000DB   6A           XRL     A,R2
   \   0000DC   700A         JNZ     ??LED_CHANGE_5
    641                   {
    642                    if (LED5_SBIT) 
   \   0000DE   A297         MOV     C,0x90.7
   \   0000E0   5004         JNC     ??LED_CHANGE_32
    643                    { 
    644                      LED5_SBIT = 0; 
   \   0000E2   C297         CLR     0x90.7
   \   0000E4   8002         SJMP    ??LED_CHANGE_5
    645                    } 
    646                    else 
    647                    { 
    648                      LED5_SBIT = 1;
   \                     ??LED_CHANGE_32:
   \   0000E6   D297         SETB    0x90.7
    649                    } 
    650                   }
    651                  }   
    652                  break;
    653          
    654              default:
    655                break;
    656              }
    657          }
   \                     ??LED_CHANGE_5:
   \   0000E8   02....       LJMP    ?BRET
   \   0000EB                REQUIRE _A_P1
    658          
    659          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    660          void USER_ZDO_JOINING_MSG(void)
   \                     USER_ZDO_JOINING_MSG:
    661          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    662           HalLedBlink ( HAL_LED_1, 1, 30, 500 );
   \   000004                ; Setup parameters for call to function HalLedBlink
   \   000004   7CF4         MOV     R4,#-0xc
   \   000006   7D01         MOV     R5,#0x1
   \   000008   7B1E         MOV     R3,#0x1e
   \   00000A   7A01         MOV     R2,#0x1
   \   00000C   7901         MOV     R1,#0x1
   \   00000E   12....       LCALL   ??HalLedBlink?relay
    663          }
   \   000011   D083         POP     DPH
   \   000013   D082         POP     DPL
   \   000015   02....       LJMP    ?BRET
    664          //RS后面是否要处理相关事件或者应用，在此进行处理

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    665          void USER_AFTER_RS_MSG(void)
   \                     USER_AFTER_RS_MSG:
    666          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    667          
    668          
    669          }
   \   000000   02....       LJMP    ?BRET
    670          
    671          
    672          //跟随心跳1分钟一次，可以用来做电池检测，如果需要的话

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    673          void USER_MAYBE_BUTTERY_MSG(void)
   \                     USER_MAYBE_BUTTERY_MSG:
    674          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    675                 if(Heart_mesg_count%60==0) //暂定半小时使用ACK一次，如果失败了则重新入网 gai 30
   \   000005   90....       MOV     DPTR,#Heart_mesg_count
   \   000008   E0           MOVX    A,@DPTR
   \   000009   F8           MOV     R0,A
   \   00000A   A3           INC     DPTR
   \   00000B   E0           MOVX    A,@DPTR
   \   00000C   F9           MOV     R1,A
   \   00000D   7A3C         MOV     R2,#0x3c
   \   00000F   7B00         MOV     R3,#0x0
   \   000011   12....       LCALL   ?US_DIV_MOD
   \   000014   8A..         MOV     ?V0 + 0,R2
   \   000016   8B..         MOV     ?V0 + 1,R3
   \   000018   E5..         MOV     A,?V0 + 0
   \   00001A   45..         ORL     A,?V0 + 1
   \   00001C   704D         JNZ     ??USER_MAYBE_BUTTERY_MSG_0
    676                {
    677                    HEART_NEED_ACK_FLAG =1;
   \   00001E   90....       MOV     DPTR,#HEART_NEED_ACK_FLAG
   \   000021   7401         MOV     A,#0x1
   \   000023   F0           MOVX    @DPTR,A
    678                    active_battery_voltage=myApp_ReadBattery();
   \   000024                ; Setup parameters for call to function myApp_ReadBattery
   \   000024   12....       LCALL   ??myApp_ReadBattery?relay
   \   000027   90....       MOV     DPTR,#active_battery_voltage
   \   00002A   EA           MOV     A,R2
   \   00002B   F0           MOVX    @DPTR,A
   \   00002C   A3           INC     DPTR
   \   00002D   EB           MOV     A,R3
   \   00002E   F0           MOVX    @DPTR,A
    679                    
    680                    if(active_battery_voltage<=265)
   \   00002F   90....       MOV     DPTR,#active_battery_voltage
   \   000032   C3           CLR     C
   \   000033   E0           MOVX    A,@DPTR
   \   000034   940A         SUBB    A,#0xa
   \   000036   A3           INC     DPTR
   \   000037   E0           MOVX    A,@DPTR
   \   000038   9401         SUBB    A,#0x1
   \   00003A   5029         JNC     ??USER_MAYBE_BUTTERY_MSG_1
    681                    {
    682                      if( (devState==DEV_END_DEVICE) || (devState==DEV_ROUTER) )
   \   00003C   90....       MOV     DPTR,#devState
   \   00003F   E0           MOVX    A,@DPTR
   \   000040   6406         XRL     A,#0x6
   \   000042   6008         JZ      ??USER_MAYBE_BUTTERY_MSG_2
   \   000044   90....       MOV     DPTR,#devState
   \   000047   E0           MOVX    A,@DPTR
   \   000048   6407         XRL     A,#0x7
   \   00004A   701F         JNZ     ??USER_MAYBE_BUTTERY_MSG_0
    683                      {
    684                      BUTTERY_ALARM_BIT=1;
   \                     ??USER_MAYBE_BUTTERY_MSG_2:
   \   00004C   90....       MOV     DPTR,#BUTTERY_ALARM_BIT
   \   00004F   7401         MOV     A,#0x1
   \   000051   F0           MOVX    @DPTR,A
    685                      osal_start_timerEx( UserApp_TaskID, SAMPLEAPP_SEND_LOWBUTTERY_EVT,
    686                                        20000 );
   \   000052                ; Setup parameters for call to function osal_start_timerEx
   \   000052   7C20         MOV     R4,#0x20
   \   000054   7D4E         MOV     R5,#0x4e
   \   000056   7A04         MOV     R2,#0x4
   \   000058   7B00         MOV     R3,#0x0
   \   00005A   90....       MOV     DPTR,#UserApp_TaskID
   \   00005D   E0           MOVX    A,@DPTR
   \   00005E   F9           MOV     R1,A
   \   00005F   12....       LCALL   ??osal_start_timerEx?relay
   \   000062   E9           MOV     A,R1
   \   000063   8006         SJMP    ??USER_MAYBE_BUTTERY_MSG_0
    687                      }
    688                      
    689                    }
    690                    else
    691                    {
    692                      BUTTERY_ALARM_BIT=0;
   \                     ??USER_MAYBE_BUTTERY_MSG_1:
   \   000065   90....       MOV     DPTR,#BUTTERY_ALARM_BIT
   \   000068   7400         MOV     A,#0x0
   \   00006A   F0           MOVX    @DPTR,A
    693                    }
    694                   
    695              }
    696                Heart_mesg_count++;
   \                     ??USER_MAYBE_BUTTERY_MSG_0:
   \   00006B   90....       MOV     DPTR,#Heart_mesg_count
   \   00006E   E0           MOVX    A,@DPTR
   \   00006F   2401         ADD     A,#0x1
   \   000071   F0           MOVX    @DPTR,A
   \   000072   A3           INC     DPTR
   \   000073   E0           MOVX    A,@DPTR
   \   000074   3400         ADDC    A,#0x0
   \   000076   F0           MOVX    @DPTR,A
    697           
    698          }
   \   000077   7F02         MOV     R7,#0x2
   \   000079   02....       LJMP    ?BANKED_LEAVE_XDATA
    699          
    700          
    701          // 入网成功后，进入正常模式后设置设备的POLL RATE时间,红外人体修改为10S，维持半分钟

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    702          void USER_SET_NOMAL_POLL_TIME(void)
   \                     USER_SET_NOMAL_POLL_TIME:
    703          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    704            NORMAL_POLL_TIME=18000;
   \   000004   90....       MOV     DPTR,#NORMAL_POLL_TIME
   \   000007   7450         MOV     A,#0x50
   \   000009   F0           MOVX    @DPTR,A
   \   00000A   A3           INC     DPTR
   \   00000B   7446         MOV     A,#0x46
   \   00000D   F0           MOVX    @DPTR,A
    705           
    706          
    707          }
   \   00000E   D083         POP     DPH
   \   000010   D082         POP     DPL
   \   000012   02....       LJMP    ?BRET
    708          
    709          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    710          void SampleAPP_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg )
   \                     SampleAPP_ProcessZDOMsgs:
    711          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    712            switch ( inMsg->clusterID )
   \   000009   EE           MOV     A,R6
   \   00000A   240C         ADD     A,#0xc
   \   00000C   F582         MOV     DPL,A
   \   00000E   EF           MOV     A,R7
   \   00000F   3400         ADDC    A,#0x0
   \   000011   F583         MOV     DPH,A
   \   000013   E0           MOVX    A,@DPTR
   \   000014   6420         XRL     A,#0x20
   \   000016   7004         JNZ     ??SampleAPP_ProcessZDOMsgs_0
   \   000018   A3           INC     DPTR
   \   000019   E0           MOVX    A,@DPTR
   \   00001A   6480         XRL     A,#0x80
   \                     ??SampleAPP_ProcessZDOMsgs_0:
   \   00001C   7031         JNZ     ??SampleAPP_ProcessZDOMsgs_1
    713            {
    714              case End_Device_Bind_rsp:
    715                if ( ZDO_ParseBindRsp( inMsg ) == ZSuccess )
   \   00001E   EE           MOV     A,R6
   \   00001F   2413         ADD     A,#0x13
   \   000021   F582         MOV     DPL,A
   \   000023   EF           MOV     A,R7
   \   000024   3400         ADDC    A,#0x0
   \   000026   F583         MOV     DPH,A
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F8           MOV     R0,A
   \   00002A   A3           INC     DPTR
   \   00002B   E0           MOVX    A,@DPTR
   \   00002C   F583         MOV     DPH,A
   \   00002E   8882         MOV     DPL,R0
   \   000030   E0           MOVX    A,@DPTR
   \   000031   700F         JNZ     ??SampleAPP_ProcessZDOMsgs_2
    716                {
    717                 HalLedBlink ( HAL_LED_1, 3, 50, 1000 );
   \   000033                ; Setup parameters for call to function HalLedBlink
   \   000033   7CE8         MOV     R4,#-0x18
   \   000035   7D03         MOV     R5,#0x3
   \   000037   7B32         MOV     R3,#0x32
   \   000039   7A03         MOV     R2,#0x3
   \   00003B   7901         MOV     R1,#0x1
   \   00003D   12....       LCALL   ??HalLedBlink?relay
   \   000040   800D         SJMP    ??SampleAPP_ProcessZDOMsgs_1
    718                }
    719          
    720                else
    721                {
    722                  HalLedBlink ( HAL_LED_1, 6, 50, 500 );
   \                     ??SampleAPP_ProcessZDOMsgs_2:
   \   000042                ; Setup parameters for call to function HalLedBlink
   \   000042   7CF4         MOV     R4,#-0xc
   \   000044   7D01         MOV     R5,#0x1
   \   000046   7B32         MOV     R3,#0x32
   \   000048   7A06         MOV     R2,#0x6
   \   00004A   7901         MOV     R1,#0x1
   \   00004C   12....       LCALL   ??HalLedBlink?relay
    723                }
    724                break;
    725            }
    726           
    727          }
   \                     ??SampleAPP_ProcessZDOMsgs_1:
   \   00004F   7F01         MOV     R7,#0x1
   \   000051   02....       LJMP    ?BANKED_LEAVE_XDATA
    728          
    729          
    730          
    731          
    732          
    733          /*******************************************************************************
    734          函数功能：改变poll的时间间隔，如果间隔为长间隔，则改成短间隔，并设置60s后进入间
    735          		  隔恢复事件
    736          */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    737          void changePollRate(void)
   \                     changePollRate:
    738          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    739          	//osal_stop_timerEx( SampleApp_TaskID, RESUME_POLL_RATE);
    740          	if(longPollRateFlag)
   \   000004   90....       MOV     DPTR,#longPollRateFlag
   \   000007   E0           MOVX    A,@DPTR
   \   000008   600D         JZ      ??changePollRate_0
    741          	{
    742          		//改变pollrate成100ms
    743          		longPollRateFlag = 0;
   \   00000A   90....       MOV     DPTR,#longPollRateFlag
   \   00000D   7400         MOV     A,#0x0
   \   00000F   F0           MOVX    @DPTR,A
    744          		NLME_SetPollRate( 300 );//set the poll rate to quick ,and   
   \   000010                ; Setup parameters for call to function NLME_SetPollRate
   \   000010   7A2C         MOV     R2,#0x2c
   \   000012   7B01         MOV     R3,#0x1
   \   000014   12....       LCALL   ??NLME_SetPollRate?relay
    745          	}
    746          	osal_start_timerEx( UserApp_TaskID, RESUME_POLL_RATE,20000);
   \                     ??changePollRate_0:
   \   000017                ; Setup parameters for call to function osal_start_timerEx
   \   000017   7C20         MOV     R4,#0x20
   \   000019   7D4E         MOV     R5,#0x4e
   \   00001B   7A20         MOV     R2,#0x20
   \   00001D   7B00         MOV     R3,#0x0
   \   00001F   90....       MOV     DPTR,#UserApp_TaskID
   \   000022   E0           MOVX    A,@DPTR
   \   000023   F9           MOV     R1,A
   \   000024   12....       LCALL   ??osal_start_timerEx?relay
   \   000027   E9           MOV     A,R1
    747          }
   \   000028   D083         POP     DPH
   \   00002A   D082         POP     DPL
   \   00002C   02....       LJMP    ?BRET

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for NORMAL_POLL_TIME>`:
   \   000000   581B         DW 7000

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for longPollRateFlag>`:
   \   000000   01           DB 1

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??UserApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    UserApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??UserApp_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    UserApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_HandleKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_HandleKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_ProcessBINDINGMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_ProcessBINDINGMessage

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_APP_JOIN_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_APP_JOIN_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_APP_COMMAND?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_APP_COMMAND

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_SET_RS_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_SET_RS_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleApp_SendInMessage?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleApp_SendInMessage

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??User_APP_Drive_init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    User_APP_Drive_init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??READ_NETKEY?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    READ_NETKEY

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??LED_CHANGE?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    LED_CHANGE

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_ZDO_JOINING_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_ZDO_JOINING_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_AFTER_RS_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_AFTER_RS_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_MAYBE_BUTTERY_MSG?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_MAYBE_BUTTERY_MSG

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??USER_SET_NOMAL_POLL_TIME?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    USER_SET_NOMAL_POLL_TIME

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??SampleAPP_ProcessZDOMsgs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    SampleAPP_ProcessZDOMsgs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??changePollRate?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    changePollRate
    748          
    749          

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     LED_CHANGE                         0      0      0
     READ_NETKEY                        0      0      0
     SampleAPP_ProcessZDOMsgs           0      0     23
       -> HalLedBlink                   0      0     18
       -> HalLedBlink                   0      0     18
     SampleApp_HandleKeys               0      0     23
       -> APPLY_TO_JOIN_OF_KEY          0      0     18
       -> SampleApp_PermitJoin          0      0     18
       -> SampleApp_PermitJoin          0      0     18
       -> HalLedBlink                   0      0     18
       -> RESTORE_TO_FACTORY            0      0     18
       -> osal_start_timerEx            0      0     18
       -> SampleApp_SendInMessage       0      0     18
     SampleApp_ProcessBINDINGMessage
                                        0      0      0
     SampleApp_SendInMessage            1      0     25
       -> osal_mem_alloc                0      0     22
       -> USER_SEND_ADD_STR             0      0     22
       -> USER_APP_SEND_IN              0      0     22
       -> osal_mem_free                 0      0     22
     USER_AFTER_RS_MSG                  0      0      0
     USER_APP_COMMAND                   1      0     11
       -> irCodeRx                      0      0     22
       -> changePollRate                0      0     22
       -> irCodeTx                      0      0     22
       -> changePollRate                0      0     22
     USER_APP_JOIN_MSG                  0      0     10
       -> HalLedBlink                   0      0     20
       -> NLME_SetPollRate              0      0     20
       -> SampleApp_GetShortAddr        0      0     20
       -> osal_mem_free                 0      0     20
     USER_MAYBE_BUTTERY_MSG             0      0     10
       -> myApp_ReadBattery             0      0     20
       -> osal_start_timerEx            0      0     20
     USER_SET_NOMAL_POLL_TIME           2      0      0
     USER_SET_RS_MSG                    2      0      0
       -> myApp_ReadBattery             4      0      0
       -> osal_start_timerEx            4      0      0
     USER_ZDO_JOINING_MSG               2      0      0
       -> HalLedBlink                   4      0      0
     UserApp_Init                       0      0      9
       -> RegisterForKeys               0      0     18
       -> User_APP_Drive_init           0      0     18
     UserApp_ProcessEvent               0      0     14
       -> osal_msg_receive              0      0     28
       -> SampleAPP_ProcessZDOMsgs      0      0     28
       -> SampleApp_HandleKeys          0      0     28
       -> osal_msg_deallocate           0      0     28
       -> osal_msg_receive              0      0     28
       -> osal_start_timerEx            0      0     28
       -> SampleApp_SendInMessage       0      0     28
       -> myApp_ReadBattery             0      0     28
       -> osal_start_timerEx            0      0     28
       -> osal_stop_timerEx             0      0     28
       -> osal_start_timerEx            0      0     28
       -> osal_pwrmgr_device            0      0     28
       -> SampleApp_SendInMessage       0      0     28
       -> osal_start_timerEx            0      0     28
       -> osal_start_timerEx            0      0     28
       -> NLME_SetPollRate              0      0     28
       -> osal_start_timerEx            0      0     28
       -> NLME_SetPollRate              0      0     28
     User_APP_Drive_init                0      0     23
       -> osal_nv_item_init             0      0     24
       -> osal_nv_read                  0      0     28
       -> irrInit                       0      0     20
     changePollRate                     2      0     11
       -> NLME_SetPollRate              4      0      0
       -> osal_start_timerEx            4      0      0


   Segment part sizes:

     Function/Label                          Bytes
     --------------                          -----
     _A_P0                                      1
     P0IFG                                      1
     P1IFG                                      1
     P1IEN                                      1
     _A_P1                                      1
     _A_IEN0                                    1
     P0IEN                                      1
     P1DIR                                      1
     UserApp_TaskID                             1
     RS_LEN                                     1
     RS_STR                                    10
     SHORT_ADRESS                               4
     USER_DATA_LEN                              1
     USER_DATA_TYPE                             1
     USER_DATA_STR                              2
     DEVICE_ID                                  1
     DEFINED_CONTROL_CHAR                       1
     JOIN_ROLE                                  1
     NORMAL_POLL_TIME                           2
     DEEP_POLL_FLAG                             1
     FRONT_ALARM_FLAG                           1
     active_battery_voltage                     2
     CASH_TIME_FLAG                             1
     HIGH_BUTTERY_FLAG                          1
     LOW_POWER_MODE                             1
     Heart_mesg_count                           2
     poll_count                                 1
     Hour_count                                 1
     more_detect_low_power_flag                 1
     BUTTERY_LOW_FLAG                           1
     BUTTERY_ALARM_BIT                          1
     POLLRATE_TIME_VALUE                        1
     CR2_DATA_NODETECT_FLAG                     1
     forever_forbiten_flag                      1
     bindingINClusters                          2
     CmdType                                    1
     IRCodeIndex                                2
     longPollRateFlag                           1
     UserApp_Init                              26
     UserApp_ProcessEvent                     603
     SampleApp_HandleKeys                     135
     SampleApp_ProcessBINDINGMessage
                                                3
     USER_APP_JOIN_MSG                        161
     USER_APP_COMMAND                         243
     USER_SET_RS_MSG                           88
     SampleApp_SendInMessage                  126
     User_APP_Drive_init                      110
     READ_NETKEY                                8
     LED_CHANGE                               235
     USER_ZDO_JOINING_MSG                      24
     USER_AFTER_RS_MSG                          3
     USER_MAYBE_BUTTERY_MSG                   124
     USER_SET_NOMAL_POLL_TIME                  21
     SampleAPP_ProcessZDOMsgs                  84
     changePollRate                            47
     ?<Initializer for NORMAL_POLL_TIME>        2
     ?<Initializer for longPollRateFlag>        1
     ??UserApp_Init?relay                       6
     ??UserApp_ProcessEvent?relay               6
     ??SampleApp_HandleKeys?relay               6
     ??SampleApp_ProcessBINDINGMessage?relay    6
     ??USER_APP_JOIN_MSG?relay                  6
     ??USER_APP_COMMAND?relay                   6
     ??USER_SET_RS_MSG?relay                    6
     ??SampleApp_SendInMessage?relay            6
     ??User_APP_Drive_init?relay                6
     ??READ_NETKEY?relay                        6
     ??LED_CHANGE?relay                         6
     ??USER_ZDO_JOINING_MSG?relay               6
     ??USER_AFTER_RS_MSG?relay                  6
     ??USER_MAYBE_BUTTERY_MSG?relay             6
     ??USER_SET_NOMAL_POLL_TIME?relay           6
     ??SampleAPP_ProcessZDOMsgs?relay           6
     ??changePollRate?relay                     6

 
 2 041 bytes in segment BANKED_CODE
   102 bytes in segment BANK_RELAYS
     8 bytes in segment SFR_AN
     3 bytes in segment XDATA_I
     3 bytes in segment XDATA_ID
    45 bytes in segment XDATA_Z
 
 2 146 bytes of CODE  memory
     0 bytes of DATA  memory (+ 8 bytes shared)
    48 bytes of XDATA memory

Errors: none
Warnings: 2
